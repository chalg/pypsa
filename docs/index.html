<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Grant Chalmers">
<meta name="dcterms.date" content="2025-07-26">

<title>A High-level Open Source Model for the Australian National Electricity Market (NEM)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="High-level_NEM_files/libs/clipboard/clipboard.min.js"></script>
<script src="High-level_NEM_files/libs/quarto-html/quarto.js"></script>
<script src="High-level_NEM_files/libs/quarto-html/popper.min.js"></script>
<script src="High-level_NEM_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="High-level_NEM_files/libs/quarto-html/anchor.min.js"></script>
<link href="High-level_NEM_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="High-level_NEM_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="High-level_NEM_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="High-level_NEM_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="High-level_NEM_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">A High-level Open Source Model for the Australian National Electricity Market (NEM)</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Grant Chalmers </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 26, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction"><strong>Introduction</strong></h2>
<p>The NEM power system is undergoing rapid transformation, driven by the need for increased renewable energy (RE) integration, grid modernization, and the pursuit of sustainable, reliable, and affordable electricity. To support these goals, advanced modelling tools are essential for analysing the current state of the grid, evaluating future scenarios, and informing policy and investment decisions.</p>
<p>This notebook presents the development of a high-level baseline model for the NEM power system using <a href="https://pypsa.readthedocs.io/en/latest/">PyPSA (Python for Power System Analysis)</a>, an open-source framework for simulating and optimizing modern energy systems. The model, referred to as High-level_NEM, is a 5-node model (one bus per region) based on actual 2024 generation and demand profiles at hourly resolution. A comparison of the 2024 baseline model with a future scenario is presented in the notebook. The future scenario has increased renewable energy and storage and associated reduction in thermal generation.</p>
<p>The workflow implemented in this notebook encompasses the following key steps:<br>
- <strong>Data Import and Preprocessing:</strong> Loading and preparing network topology, generator, storage, and time series data from actual NEM system records and relevant administrative datasets.<br>
- <strong>Network Construction:</strong> Building the PyPSA network by adding buses, loads, generators, storage units, and transmission lines.<br>
- <strong>Temporal Resolution and Snapshots:</strong> Setting up the model to operate at a chosen temporal granularity, allowing for the study of daily and seasonal variability in demand and renewable generation.<br>
- <strong>Optimisation and Scenario Analysis:</strong> Solving the baseline model using linear optimisation to determine the optimal dispatch of resources, and extending the analysis to a plausible future scenario with an aggressive increase in variable renewable energy and associated reduction in thermal generation.<br>
- <strong>Results Visualization and Verification:</strong> Generating plots and statistics to interpret model outputs, including network topology, dispatch profiles, generation mix, and importantly, curtailment.<br>
- <strong>Scenario Functions:</strong> Providing reusable functions for projecting various scaled-up generation scenarios.</p>
</section>
<section id="research-objectives" class="level2">
<h2 class="anchored" data-anchor-id="research-objectives"><strong>Research Objectives</strong></h2>
<p><em>Objective:</em></p>
<p>Develop a high-level 5-node baseline PyPSA model for the NEM and VRE/storage scale-up scenarios with:<br>
1. One bus per NEM region with transmission interconnectors<br>
2. Hourly time resolution to capture some RE intermittency<br>
3. Comparison of 2024 baseline model to a high penetration renewable energy scenario</p>
<p><em>Key Assumptions</em></p>
<p>Baseline 2024 model: - 2024 demand<br>
- 2024 generation profiles<br>
- 2024 renewable energy availability (capacity) factors (incl.&nbsp;hydro).<br>
- Generator registered capacities sourced from <a href="https://explore.openelectricity.org.au/facilities/nem/?status=operating,committed">Open Electricity facilities</a> Inclusive of operating and <strong>committed</strong>, therefore includes Snowy 2.0, Hunter Gas and a significant increase in battery storage over what is currently operating.<br>
- Time series data is at hourly resolution.<br>
- Rooftop solar sourced from AEMO via <a href="https://github.com/UNSW-CEEM/NEMOSIS">nemosis</a> python package (TYPE = <em>‘MEASUREMENT’</em>).<br>
- Efficiency of storage on the way in and out set at 0.917 (round trip 0.84) via <a href="https://aemo.com.au/-/media/files/major-publications/isp/2024/2024-isp-inputs-and-assumptions-workbook.xlsx?la=en">2024 ISP Inputs and Assumptions workbook</a>.<br>
- Starter battery (600MW Cellars Hill) added in TAS1 in order to be able to scale up (not currently operating, but has some level of state govt. support).<br>
- Project EnergyConnect and Marinus stage 1 implemented on top of existing interconnectors (constrained by nominal capacity)<br>
- One generator of each major source and one battery setup per region/bus</p>
<p>By following this workflow, the notebook provides a high-level example for those learning power system analysis with PyPSA.</p>
<p><strong>Important links/references:</strong></p>
<p><a href="https://fneum.github.io/data-science-for-esm/intro.html#jupyter.org/">TU Berlin: Data Science for Energy System Modelling</a><br>
<a href="https://pypsa.readthedocs.io/en/latest/user-guide/components.html">PyPSA Documentation and Components</a><br>
<a href="https://pypsa-earth.readthedocs.io/en/latest/">PyPSA Earth Documentation</a><br>
<a href="https://github.com/PyPSA">GitHub PyPSA Sources</a><br>
<a href="https://github.com/arizeosalac/PyPSA-PH/tree/main">PyPSA-PH: High-Resolution Open Source Power System Model for the Philippines</a><br>
<a href="https://aemo.com.au/energy-systems/major-publications/integrated-system-plan-isp/2024-integrated-system-plan-isp">2024 Integrated System Plan (ISP)</a><br>
<a href="https://openelectricity.org.au/">Open Electricity</a></p>
<section id="import" class="level3">
<h3 class="anchored" data-anchor-id="import">01 Import</h3>
<p>This section imports all necessary Python packages and libraries required for data processing, power system modelling, geospatial analysis, and visualization. These packages provide the foundational tools for building, analysing, and visualising the High-leve_NEM baseline model and high penetration renewable energy model.</p>
<div id="276301c3" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.dates <span class="im">import</span> AutoDateLocator, ConciseDateFormatter</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pypsa</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pypsa.plot.maps.static <span class="im">import</span> add_legend_patches</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> timedelta</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime  </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dateutil.parser <span class="im">import</span> parse</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cartopy.crs <span class="im">as</span> ccrs</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cartopy.feature <span class="im">as</span> cfeature</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> time <span class="im">import</span> perf_counter</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> great_tables <span class="im">import</span> GT, md, system_fonts, nanoplot_options</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display, HTML</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="create-network" class="level3">
<h3 class="anchored" data-anchor-id="create-network">02 Create Network</h3>
<p>This section covers the creation of the High-level_NEME network, including loading network data, initializing the PyPSA network object, and preparing the structure for adding buses, loads, generators, storage units, and transmission lines.</p>
<section id="load-network-data" class="level4">
<h4 class="anchored" data-anchor-id="load-network-data">02.01 Load Network Data</h4>
<div id="d268156a" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load components</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>generators <span class="op">=</span> pd.read_csv(<span class="st">"data/generators.csv"</span>).set_index(<span class="st">'name'</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>buses <span class="op">=</span> pd.read_csv(<span class="st">"data/buses.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>loads <span class="op">=</span> pd.read_csv(<span class="st">"data/loads.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>lines <span class="op">=</span> pd.read_csv(<span class="st">"data/lines.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>links <span class="op">=</span> pd.read_csv(<span class="st">"data/links.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>storage_units <span class="op">=</span> pd.read_csv(<span class="st">"data/storage_units.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="626c2bc9" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load time series data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>load_ts <span class="op">=</span> pd.read_csv(<span class="st">"data/loads_t.p_set.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>load_ts.index <span class="op">=</span> pd.to_datetime(load_ts.index, errors<span class="op">=</span><span class="st">"raise"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(load_ts.index.dtype) </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Below should be empty if all dates are valid</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>load_ts[<span class="op">~</span>load_ts.index.notnull()]</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>generators_ts <span class="op">=</span> pd.read_csv(<span class="st">"data/generators_t.p_max_pu.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>generators_ts.index <span class="op">=</span> pd.to_datetime(generators_ts.index, errors<span class="op">=</span><span class="st">"raise"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generators_ts.index.dtype)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> load_ts.index.equals(generators_ts.index):    </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Time series indices are not aligned"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>datetime64[ns]
datetime64[ns]</code></pre>
</div>
</div>
</section>
<section id="initialize-the-network" class="level4">
<h4 class="anchored" data-anchor-id="initialize-the-network">02.02 Initialize the network</h4>
<div id="6e769cd5" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> pypsa.Network()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="add-network-components" class="level3">
<h3 class="anchored" data-anchor-id="add-network-components">03 Add Network Components</h3>
<p>This section details the process of adding key components to the PyPSA-PH network, including buses, loads, generators, storage units, and transmission lines. Each component is integrated with relevant time series data and technical parameters to accurately represent the Philippine power system’s structure and operation.</p>
<div id="3da94e6e" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add components</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, row <span class="kw">in</span> buses.iterrows():</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    n.add(<span class="st">"Bus"</span>, name, <span class="op">**</span>row.to_dict())</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, row <span class="kw">in</span> loads.iterrows():</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    n.add(<span class="st">"Load"</span>, name, <span class="op">**</span>row.to_dict())</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, row <span class="kw">in</span> lines.iterrows():</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    n.add(<span class="st">"Line"</span>, name, <span class="op">**</span>row.to_dict())</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, row <span class="kw">in</span> generators.iterrows():</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    n.add(<span class="st">"Generator"</span>, name, <span class="op">**</span>row.to_dict())</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, row <span class="kw">in</span> links.iterrows():</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    n.add(<span class="st">"Link"</span>, name, <span class="op">**</span>row.to_dict())</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, row <span class="kw">in</span> storage_units.iterrows():</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    n.add(<span class="st">"StorageUnit"</span>, name, <span class="op">**</span>row.to_dict())    </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Set time series</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>n.set_snapshots(load_ts.index)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>n.loads_t.p_set <span class="op">=</span> load_ts</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>n.generators_t.p_max_pu <span class="op">=</span> generators_ts</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="bu">all</span>(n.generators_t.p_max_pu.index <span class="op">==</span> n.snapshots)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove negative values in p_max_pu (Hydro is the culprit)</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>n.generators_t.p_max_pu <span class="op">=</span> n.generators_t.p_max_pu.clip(lower<span class="op">=</span><span class="fl">0.0</span>, upper<span class="op">=</span><span class="fl">1.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Introduce a dummy ‘load shedding’ generator to help identify infeasible scenarios within the model. This approach is more informative than simply receiving a “not feasible” message from the solver, as it highlights which regions are affected. With this information, we can make targeted adjustments - such as increasing generation or storage in future iterations.</p>
<p>Set the marginal cost very high so it is only used as a last resort.</p>
<div id="1868c19f" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add one unserved energy generator per load bus</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Acts like a dummy "load shedding" generator</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> bus <span class="kw">in</span> n.loads.bus.unique():</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    gen_name <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>bus<span class="sc">}</span><span class="ss">-UNSERVED"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    n.add(<span class="st">"Generator"</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>          name<span class="op">=</span>gen_name,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>          bus<span class="op">=</span>bus,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>          carrier<span class="op">=</span><span class="st">"Unserved Energy"</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>          p_nom_extendable<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>          p_nom<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>          marginal_cost<span class="op">=</span><span class="dv">10000</span>,  <span class="co"># Very expensive fallback</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>          capital_cost<span class="op">=</span><span class="dv">0</span>,       <span class="co"># Optional: make it purely operational cost</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="dab90983" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostic output</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded </span><span class="sc">{</span><span class="bu">len</span>(n.buses)<span class="sc">}</span><span class="ss"> buses"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded </span><span class="sc">{</span><span class="bu">len</span>(n.loads)<span class="sc">}</span><span class="ss"> loads with time series of shape </span><span class="sc">{</span>n<span class="sc">.</span>loads_t<span class="sc">.</span>p_set<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded </span><span class="sc">{</span><span class="bu">len</span>(n.generators)<span class="sc">}</span><span class="ss"> generators with time series of shape </span><span class="sc">{</span>n<span class="sc">.</span>generators_t<span class="sc">.</span>p_max_pu<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded </span><span class="sc">{</span><span class="bu">len</span>(n.lines)<span class="sc">}</span><span class="ss"> lines"</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded </span><span class="sc">{</span><span class="bu">len</span>(n.links)<span class="sc">}</span><span class="ss"> links"</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded </span><span class="sc">{</span><span class="bu">len</span>(n.generators)<span class="sc">}</span><span class="ss"> generators"</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded </span><span class="sc">{</span><span class="bu">len</span>(n.storage_units)<span class="sc">}</span><span class="ss"> storage units"</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Check total demand makes sense</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total demand:  </span><span class="sc">{</span>n<span class="sc">.</span>loads_t<span class="sc">.</span>p_set<span class="sc">.</span><span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)<span class="sc">.</span><span class="bu">max</span>()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Loaded 5 buses
Loaded 5 loads with time series of shape (8784, 5)
Loaded 37 generators with time series of shape (8784, 18)
Loaded 9 lines
Loaded 8 links
Loaded 37 generators
Loaded 5 storage units
Total demand:  33459.57</code></pre>
</div>
</div>
<p>Add carrier colours for plotting consistency.</p>
<div id="5358bddf" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add carrier colours for plotting consistency.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Userved Energy bright red!</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>carrier_list <span class="op">=</span> n.generators.carrier.unique()</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>carrier_colors <span class="op">=</span> {</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Biomass"</span>: <span class="st">'#127E2A'</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hydro"</span>: <span class="st">'#1E81D4'</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Black Coal"</span>: <span class="st">"#39322D"</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Solar"</span>: <span class="st">'#FDB324'</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rooftop Solar"</span>: <span class="st">'#FFE066'</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Wind"</span>: <span class="st">'#3BBFE5'</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Diesel"</span>: <span class="st">"#D486BA"</span>,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Brown Coal"</span>: <span class="st">"#715E50"</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gas"</span>: <span class="st">'#E6622D'</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ROR"</span>: <span class="st">'#8ab2d4'</span>,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Battery"</span>: <span class="st">'#814ad4'</span>,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pump Hydro"</span>: <span class="st">'#104775'</span>,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"AC"</span>: <span class="st">'#999999'</span>,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"DC"</span>: <span class="st">"#3277AF"</span>,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Unserved Energy"</span>: <span class="st">"#F40B16"</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> carrier, color <span class="kw">in</span> carrier_colors.items():</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    n.carriers.loc[carrier, <span class="st">'color'</span>] <span class="op">=</span> color</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plot high-level NEM network (buses, lines &amp; links).<br>
Note: the lines/links below are not geographically accurate - just for representation.</p>
<div id="674b6a66" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot high-level NEM network (buses, lines &amp; links)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use PlateCarree projection for lat/lon</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>crs <span class="op">=</span> ccrs.PlateCarree()</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create figure and map</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">6</span>), subplot_kw<span class="op">=</span>{<span class="st">'projection'</span>: crs})</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add base map features</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>ax.add_feature(cfeature.COASTLINE)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>ax.add_feature(cfeature.BORDERS, linestyle<span class="op">=</span><span class="st">":"</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>ax.add_feature(cfeature.STATES, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>ax.set_extent([<span class="dv">110</span>, <span class="dv">155</span>, <span class="op">-</span><span class="dv">45</span>, <span class="op">-</span><span class="dv">10</span>])  <span class="co"># Australia-wide view</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.patch.set_facecolor('#F0FFFF') </span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.set_facecolor('#F0FFFF')</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot buses</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>ax.scatter(</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    n.buses[<span class="st">"x"</span>], n.buses[<span class="st">"y"</span>],</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">'red'</span>, s<span class="op">=</span><span class="dv">50</span>, transform<span class="op">=</span>crs, zorder<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">"Buses"</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Label each bus</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, row <span class="kw">in</span> n.buses.iterrows():</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    ax.text(</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>        row[<span class="st">"x"</span>], row[<span class="st">"y"</span>], name,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>        transform<span class="op">=</span>crs, fontsize<span class="op">=</span><span class="dv">9</span>, ha<span class="op">=</span><span class="st">'left'</span>, va<span class="op">=</span><span class="st">'bottom'</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot lines (AC)</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>first_line <span class="op">=</span> <span class="va">True</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, line <span class="kw">in</span> n.lines.iterrows():</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    x0, y0 <span class="op">=</span> n.buses.loc[line.bus0, [<span class="st">"x"</span>, <span class="st">"y"</span>]]</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    x1, y1 <span class="op">=</span> n.buses.loc[line.bus1, [<span class="st">"x"</span>, <span class="st">"y"</span>]]</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> carrier_colors.get(line.carrier, <span class="st">"gray"</span>)  <span class="co"># fallback if undefined</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    ax.plot([x0, x1], [y0, y1], color<span class="op">=</span>color, transform<span class="op">=</span>crs, zorder<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">"Lines (AC)"</span> <span class="cf">if</span> first_line <span class="cf">else</span> <span class="va">None</span>)</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    first_line <span class="op">=</span> <span class="va">False</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot links (DC)</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>first_link <span class="op">=</span> <span class="va">True</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, link <span class="kw">in</span> n.links.iterrows():</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>    x0, y0 <span class="op">=</span> n.buses.loc[link.bus0, [<span class="st">"x"</span>, <span class="st">"y"</span>]]</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>    x1, y1 <span class="op">=</span> n.buses.loc[link.bus1, [<span class="st">"x"</span>, <span class="st">"y"</span>]]</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> carrier_colors.get(link.carrier, <span class="st">"blue"</span>)</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>    ax.plot([x0, x1], [y0, y1], color<span class="op">=</span>color, linestyle<span class="op">=</span><span class="st">"--"</span>, transform<span class="op">=</span>crs, zorder<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">"Links (DC)"</span> <span class="cf">if</span> first_link <span class="cf">else</span> <span class="va">None</span>)</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>    first_link <span class="op">=</span> <span class="va">False</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"PyPSA High-level NEM Network (Buses, Lines, Links)"</span>)</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="High-level_NEM_files/figure-html/cell-10-output-1.png" width="656" height="566" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="solve-the-network" class="level3">
<h3 class="anchored" data-anchor-id="solve-the-network">03 Solve the network</h3>
<div id="fb6e399e" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve the nework</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Change to open source solver if required, default is HiGHS:</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># n.optimize()</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># n.optimize(solver_name = "gurobi")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="8154d39d" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Export the baseline network to NetCDF format so it is accessible for other tools.</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This is useful for sharing the network with others or for further analysis.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># n.export_to_netcdf("results/high-level_nem.nc")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="22106b87" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the network back from NetCDF format (if needed)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> pypsa.Network(<span class="st">"results/high-level_nem.nc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>INFO:pypsa.io:Imported network high-level_nem.nc has buses, carriers, generators, lines, links, loads, storage_units</code></pre>
</div>
</div>
<p><code>.p_nom_opt</code> is the optimised nominal capacity of a generator, after running n.optimize() in PyPSA. In the baseline model, it is expected that there will be zero unserved energy.</p>
<div id="4607f8d8" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by bus and carrier to sum the optimised nominal power in MW.</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>n.generators.groupby([<span class="st">"bus"</span>, <span class="st">"carrier"</span>]).p_nom_opt.<span class="bu">sum</span>().reset_index() <span class="op">\</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    .pivot(index<span class="op">=</span><span class="st">'bus'</span>, columns<span class="op">=</span><span class="st">'carrier'</span>, values<span class="op">=</span><span class="st">'p_nom_opt'</span>) <span class="op">\</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    .fillna(<span class="dv">0</span>).astype(<span class="bu">int</span>).sort_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">Black Coal</th>
<th data-quarto-table-cell-role="th">Brown Coal</th>
<th data-quarto-table-cell-role="th">Diesel</th>
<th data-quarto-table-cell-role="th">Gas</th>
<th data-quarto-table-cell-role="th">Hydro</th>
<th data-quarto-table-cell-role="th">Rooftop Solar</th>
<th data-quarto-table-cell-role="th">Solar</th>
<th data-quarto-table-cell-role="th">Unserved Energy</th>
<th data-quarto-table-cell-role="th">Wind</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">bus</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">NSW1</td>
<td>8270</td>
<td>0</td>
<td>155</td>
<td>3278</td>
<td>7122</td>
<td>5477</td>
<td>7329</td>
<td>0</td>
<td>3212</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">QLD1</td>
<td>8119</td>
<td>0</td>
<td>453</td>
<td>3202</td>
<td>976</td>
<td>4604</td>
<td>5379</td>
<td>0</td>
<td>3402</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SA1</td>
<td>0</td>
<td>0</td>
<td>454</td>
<td>3408</td>
<td>2</td>
<td>1876</td>
<td>735</td>
<td>0</td>
<td>2763</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">TAS1</td>
<td>0</td>
<td>0</td>
<td>48</td>
<td>372</td>
<td>2356</td>
<td>250</td>
<td>0</td>
<td>0</td>
<td>587</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">VIC1</td>
<td>0</td>
<td>4690</td>
<td>0</td>
<td>2491</td>
<td>2352</td>
<td>3654</td>
<td>2034</td>
<td>0</td>
<td>6044</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
<section id="visualisations" class="level3">
<h3 class="anchored" data-anchor-id="visualisations">04 Visualisations</h3>
<div id="452e1ef0" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting function for generation dispatch</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Interactive version (optional)</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_dispatch(n, time<span class="op">=</span><span class="st">"2024"</span>, days<span class="op">=</span><span class="va">None</span>, regions<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                   show_imports<span class="op">=</span><span class="va">True</span>, show_curtailment<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                   scenario_name<span class="op">=</span><span class="va">None</span>, scenario_objective<span class="op">=</span><span class="va">None</span>, interactive<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>     <span class="co">"""</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">     Plot a generation dispatch stack by carrier for a PyPSA network, with optional</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">     net imports/exports and a region‑filtered curtailment overlay.</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">     Parameters</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">     ----------</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">     n : pypsa.Network</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co">         The PyPSA network to plot.</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co">     time : str, default "2024"</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co">         Start of the time window (e.g. "2024", "2024-07", or "2024-07-15").</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co">     days : int, optional</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co">         Number of days from `time` to include in the plot.</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co">     regions : list of str, optional</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="co">         Region bus names to filter by. If None, the entire network is included.</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="co">     show_imports : bool, default True</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="co">         Whether to include net imports/exports in the dispatch stack.</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="co">     show_curtailment : bool, default True</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="co">         Whether to calculate and plot VRE curtailment (Solar, Wind, Rooftop Solar).</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="co">     scenario_name : str, optional</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="co">         Scenario label to display below the title.</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="co">     scenario_objective : str, optional</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="co">         Objective description to display next to the legend.</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="co">     interactive : bool, default False</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="co">         Whether to create an interactive plot using Plotly instead of matplotlib.</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="co">     Notes</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="co">     -----</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="co">     - All power values are converted to GW.</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="co">     - Curtailment is plotted as a dashed black line if enabled.</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a><span class="co">     - Demand (load) is plotted as a solid green line.</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a><span class="co">     - Storage charging and net exports (negative values) are shown below zero.</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a><span class="co">     """</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> interactive:</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>         <span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>         <span class="im">from</span> plotly.subplots <span class="im">import</span> make_subplots</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>         <span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>     <span class="cf">else</span>:</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>         <span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>     <span class="co"># 1) REGION MASKS</span></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> regions <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>         gen_mask   <span class="op">=</span> n.generators.bus.isin(regions)</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>         sto_mask   <span class="op">=</span> n.storage_units.bus.isin(regions) <span class="cf">if</span> <span class="kw">not</span> n.storage_units.empty <span class="cf">else</span> []</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>         store_mask <span class="op">=</span> n.stores.bus.isin(regions) <span class="cf">if</span> <span class="kw">not</span> n.stores.empty <span class="cf">else</span> []</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>         region_buses <span class="op">=</span> <span class="bu">set</span>(regions)</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>     <span class="cf">else</span>:</span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>        gen_mask <span class="op">=</span> pd.Series(<span class="va">True</span>, index<span class="op">=</span>n.generators.index)</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>        sto_mask <span class="op">=</span> pd.Series(<span class="va">True</span>, index<span class="op">=</span>n.storage_units.index) <span class="cf">if</span> <span class="kw">not</span> n.storage_units.empty <span class="cf">else</span> pd.Series(dtype<span class="op">=</span><span class="bu">bool</span>)</span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>        store_mask <span class="op">=</span> pd.Series(<span class="va">True</span>, index<span class="op">=</span>n.stores.index) <span class="cf">if</span> <span class="kw">not</span> n.stores.empty <span class="cf">else</span> pd.Series(dtype<span class="op">=</span><span class="bu">bool</span>)</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>        region_buses <span class="op">=</span> <span class="bu">set</span>(n.buses.index)</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>     <span class="co"># 2) AGGREGATE BY CARRIER (GW)</span></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>     <span class="kw">def</span> _agg(df_t, df_stat, mask):</span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>         <span class="cf">return</span> (</span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>             df_t.loc[:, mask]</span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>                 .T</span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>                 .groupby(df_stat.loc[mask, <span class="st">'carrier'</span>])</span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>                 .<span class="bu">sum</span>()</span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>                 .T</span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>                 .div(<span class="fl">1e3</span>)</span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>     p_by_carrier <span class="op">=</span> _agg(n.generators_t.p, n.generators, gen_mask)</span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> <span class="kw">not</span> n.storage_units.empty:</span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>         p_by_carrier <span class="op">=</span> pd.concat([p_by_carrier,</span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>                                   _agg(n.storage_units_t.p, n.storage_units, sto_mask)],</span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>                                  axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> <span class="kw">not</span> n.stores.empty:</span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a>         p_by_carrier <span class="op">=</span> pd.concat([p_by_carrier,</span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>                                   _agg(n.stores_t.p, n.stores, store_mask)],</span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>                                  axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>     <span class="co"># 3) TIME WINDOW</span></span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>     parts <span class="op">=</span> time.split(<span class="st">"-"</span>)</span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> <span class="bu">len</span>(parts) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>         start <span class="op">=</span> pd.to_datetime(<span class="ss">f"</span><span class="sc">{</span>parts[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">-01-01"</span>)</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>     <span class="cf">elif</span> <span class="bu">len</span>(parts) <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>         start <span class="op">=</span> pd.to_datetime(<span class="ss">f"</span><span class="sc">{</span>parts[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>parts[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">-01"</span>)</span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a>     <span class="cf">else</span>:</span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>         start <span class="op">=</span> pd.to_datetime(time)</span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> days <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a>         end <span class="op">=</span> start <span class="op">+</span> pd.Timedelta(days<span class="op">=</span>days) <span class="op">-</span> pd.Timedelta(hours<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a>     <span class="cf">elif</span> <span class="bu">len</span>(parts) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>         end <span class="op">=</span> pd.to_datetime(<span class="ss">f"</span><span class="sc">{</span>parts[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">-12-31 23:00"</span>)</span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a>     <span class="cf">elif</span> <span class="bu">len</span>(parts) <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a>         end <span class="op">=</span> start <span class="op">+</span> pd.offsets.MonthEnd(<span class="dv">0</span>) <span class="op">+</span> pd.Timedelta(hours<span class="op">=</span><span class="dv">23</span>)</span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a>     <span class="cf">else</span>:</span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a>         end <span class="op">=</span> start <span class="op">+</span> pd.Timedelta(hours<span class="op">=</span><span class="dv">23</span>)</span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a>     p_slice <span class="op">=</span> p_by_carrier.loc[start:end].copy()</span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a>     <span class="co"># drop carriers with zero activity</span></span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a>     zero <span class="op">=</span> p_slice.columns[p_slice.<span class="bu">abs</span>().<span class="bu">sum</span>() <span class="op">==</span> <span class="dv">0</span>]</span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a>     p_slice.drop(columns<span class="op">=</span>zero, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a>     <span class="co"># 4) IMPORTS/EXPORTS</span></span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> show_imports:</span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a>         ac <span class="op">=</span> ( n.lines_t.p0.loc[start:end, n.lines.bus1.isin(region_buses) <span class="op">&amp;</span> <span class="op">~</span>n.lines.bus0.isin(region_buses)].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a>              <span class="op">+</span> n.lines_t.p1.loc[start:end, n.lines.bus0.isin(region_buses) <span class="op">&amp;</span> <span class="op">~</span>n.lines.bus1.isin(region_buses)].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>) )</span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a>         dc <span class="op">=</span> ( n.links_t.p0.loc[start:end, n.links.bus1.isin(region_buses) <span class="op">&amp;</span> <span class="op">~</span>n.links.bus0.isin(region_buses)].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a>              <span class="op">+</span> n.links_t.p1.loc[start:end, n.links.bus0.isin(region_buses) <span class="op">&amp;</span> <span class="op">~</span>n.links.bus1.isin(region_buses)].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>) )</span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a>         p_slice[<span class="st">'Imports/Exports'</span>] <span class="op">=</span> (ac <span class="op">+</span> dc).div(<span class="fl">1e3</span>)</span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> <span class="st">'Imports/Exports'</span> <span class="kw">not</span> <span class="kw">in</span> n.carriers.index:</span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a>             n.carriers.loc[<span class="st">'Imports/Exports'</span>,<span class="st">'color'</span>]<span class="op">=</span><span class="st">'#7f7f7f'</span></span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a>     <span class="co"># 5) LOAD SERIES</span></span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> regions:</span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a>         load_cols <span class="op">=</span> [c <span class="cf">for</span> c <span class="kw">in</span> n.loads[n.loads.bus.isin(regions)].index <span class="cf">if</span> c <span class="kw">in</span> n.loads_t.p_set]</span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a>         load_series <span class="op">=</span> n.loads_t.p_set[load_cols].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a>     <span class="cf">else</span>:</span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a>         load_series <span class="op">=</span> n.loads_t.p_set.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a>     load_series <span class="op">=</span> load_series.loc[start:end].div(<span class="fl">1e3</span>)</span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a>     <span class="co"># 6) VRE CURTAILMENT (GW) if requested</span></span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> show_curtailment:</span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a>         vre <span class="op">=</span> [<span class="st">'Solar'</span>,<span class="st">'Wind'</span>, <span class="st">'Rooftop Solar'</span>]</span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a>         mask_vre <span class="op">=</span> gen_mask <span class="op">&amp;</span> n.generators.carrier.isin(vre)</span>
<span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a>         avail <span class="op">=</span> (n.generators_t.p_max_pu.loc[start:end, mask_vre]</span>
<span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a>                  .multiply(n.generators.loc[mask_vre,<span class="st">'p_nom'</span>], axis<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a>         disp  <span class="op">=</span> n.generators_t.p.loc[start:end, mask_vre]</span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a>         curtail <span class="op">=</span> (avail.sub(disp, fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a>                        .clip(lower<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a>                        .<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a>                        .div(<span class="fl">1e3</span>))</span>
<span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a>     <span class="cf">else</span>:</span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a>         curtail <span class="op">=</span> <span class="va">None</span></span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a>     <span class="co"># 7) PLOT</span></span>
<span id="cb17-139"><a href="#cb17-139" aria-hidden="true" tabindex="-1"></a>     title_tail <span class="op">=</span> <span class="ss">f" for </span><span class="sc">{</span><span class="st">', '</span><span class="sc">.</span>join(regions)<span class="sc">}</span><span class="ss">"</span> <span class="cf">if</span> regions <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a>     plot_title <span class="op">=</span> <span class="ss">f"Dispatch by Carrier: </span><span class="sc">{</span>start<span class="sc">.</span>date()<span class="sc">}</span><span class="ss"> to </span><span class="sc">{</span>end<span class="sc">.</span>date()<span class="sc">}{</span>title_tail<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb17-141"><a href="#cb17-141" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb17-142"><a href="#cb17-142" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> interactive:</span>
<span id="cb17-143"><a href="#cb17-143" aria-hidden="true" tabindex="-1"></a>         <span class="co"># PLOTLY INTERACTIVE PLOT</span></span>
<span id="cb17-144"><a href="#cb17-144" aria-hidden="true" tabindex="-1"></a>         fig <span class="op">=</span> go.Figure()</span>
<span id="cb17-145"><a href="#cb17-145" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb17-146"><a href="#cb17-146" aria-hidden="true" tabindex="-1"></a>         fig.update_layout(</span>
<span id="cb17-147"><a href="#cb17-147" aria-hidden="true" tabindex="-1"></a>            plot_bgcolor<span class="op">=</span><span class="st">'#F0FFFF'</span>,</span>
<span id="cb17-148"><a href="#cb17-148" aria-hidden="true" tabindex="-1"></a>            xaxis<span class="op">=</span><span class="bu">dict</span>(gridcolor<span class="op">=</span><span class="st">'#DDDDDD'</span>),</span>
<span id="cb17-149"><a href="#cb17-149" aria-hidden="true" tabindex="-1"></a>            yaxis<span class="op">=</span><span class="bu">dict</span>(gridcolor<span class="op">=</span><span class="st">'#DDDDDD'</span>)        <span class="co"># Plot area background</span></span>
<span id="cb17-150"><a href="#cb17-150" aria-hidden="true" tabindex="-1"></a>         ) </span>
<span id="cb17-151"><a href="#cb17-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-152"><a href="#cb17-152" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Prepare data for stacked area plot</span></span>
<span id="cb17-153"><a href="#cb17-153" aria-hidden="true" tabindex="-1"></a>         positive_data <span class="op">=</span> p_slice.where(p_slice <span class="op">&gt;</span> <span class="dv">0</span>).fillna(<span class="dv">0</span>)</span>
<span id="cb17-154"><a href="#cb17-154" aria-hidden="true" tabindex="-1"></a>         negative_data <span class="op">=</span> p_slice.where(p_slice <span class="op">&lt;</span> <span class="dv">0</span>).fillna(<span class="dv">0</span>)</span>
<span id="cb17-155"><a href="#cb17-155" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb17-156"><a href="#cb17-156" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Add positive generation as stacked area</span></span>
<span id="cb17-157"><a href="#cb17-157" aria-hidden="true" tabindex="-1"></a>         <span class="cf">for</span> i, col <span class="kw">in</span> <span class="bu">enumerate</span>(positive_data.columns):</span>
<span id="cb17-158"><a href="#cb17-158" aria-hidden="true" tabindex="-1"></a>             <span class="cf">if</span> positive_data[col].<span class="bu">sum</span>() <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb17-159"><a href="#cb17-159" aria-hidden="true" tabindex="-1"></a>                 color <span class="op">=</span> n.carriers.loc[col, <span class="st">'color'</span>]</span>
<span id="cb17-160"><a href="#cb17-160" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># Only add points where value &gt; 0.001</span></span>
<span id="cb17-161"><a href="#cb17-161" aria-hidden="true" tabindex="-1"></a>                 mask <span class="op">=</span> positive_data[col].<span class="bu">abs</span>() <span class="op">&gt;</span> <span class="fl">0.001</span></span>
<span id="cb17-162"><a href="#cb17-162" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">if</span> mask.<span class="bu">any</span>():</span>
<span id="cb17-163"><a href="#cb17-163" aria-hidden="true" tabindex="-1"></a>                     fig.add_trace(go.Scatter(</span>
<span id="cb17-164"><a href="#cb17-164" aria-hidden="true" tabindex="-1"></a>                         x<span class="op">=</span>positive_data.index[mask],</span>
<span id="cb17-165"><a href="#cb17-165" aria-hidden="true" tabindex="-1"></a>                         y<span class="op">=</span>positive_data[col][mask],</span>
<span id="cb17-166"><a href="#cb17-166" aria-hidden="true" tabindex="-1"></a>                         mode<span class="op">=</span><span class="st">'lines'</span>,</span>
<span id="cb17-167"><a href="#cb17-167" aria-hidden="true" tabindex="-1"></a>                         fill<span class="op">=</span><span class="st">'tonexty'</span> <span class="cf">if</span> i <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">'tozeroy'</span>,</span>
<span id="cb17-168"><a href="#cb17-168" aria-hidden="true" tabindex="-1"></a>                         line<span class="op">=</span><span class="bu">dict</span>(width<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span>color),</span>
<span id="cb17-169"><a href="#cb17-169" aria-hidden="true" tabindex="-1"></a>                         fillcolor<span class="op">=</span>color,</span>
<span id="cb17-170"><a href="#cb17-170" aria-hidden="true" tabindex="-1"></a>                         name<span class="op">=</span>col,</span>
<span id="cb17-171"><a href="#cb17-171" aria-hidden="true" tabindex="-1"></a>                         stackgroup<span class="op">=</span><span class="st">'positive'</span>,</span>
<span id="cb17-172"><a href="#cb17-172" aria-hidden="true" tabindex="-1"></a>                         hovertemplate<span class="op">=</span><span class="st">'&lt;b&gt;%</span><span class="sc">{fullData.name}</span><span class="st">&lt;/b&gt;&lt;br&gt;Power: %</span><span class="sc">{y:.3f}</span><span class="st"> GW&lt;extra&gt;&lt;/extra&gt;'</span>,</span>
<span id="cb17-173"><a href="#cb17-173" aria-hidden="true" tabindex="-1"></a>                         showlegend<span class="op">=</span><span class="va">True</span></span>
<span id="cb17-174"><a href="#cb17-174" aria-hidden="true" tabindex="-1"></a>                     ))</span>
<span id="cb17-175"><a href="#cb17-175" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb17-176"><a href="#cb17-176" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Add negative generation (storage charging, exports)</span></span>
<span id="cb17-177"><a href="#cb17-177" aria-hidden="true" tabindex="-1"></a>         <span class="cf">for</span> col <span class="kw">in</span> negative_data.columns:</span>
<span id="cb17-178"><a href="#cb17-178" aria-hidden="true" tabindex="-1"></a>             <span class="cf">if</span> negative_data[col].<span class="bu">sum</span>() <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb17-179"><a href="#cb17-179" aria-hidden="true" tabindex="-1"></a>                 color <span class="op">=</span> n.carriers.loc[col, <span class="st">'color'</span>]</span>
<span id="cb17-180"><a href="#cb17-180" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># Only add points where value &lt; -0.001</span></span>
<span id="cb17-181"><a href="#cb17-181" aria-hidden="true" tabindex="-1"></a>                 mask <span class="op">=</span> negative_data[col].<span class="bu">abs</span>() <span class="op">&gt;</span> <span class="fl">0.001</span></span>
<span id="cb17-182"><a href="#cb17-182" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">if</span> mask.<span class="bu">any</span>():</span>
<span id="cb17-183"><a href="#cb17-183" aria-hidden="true" tabindex="-1"></a>                     fig.add_trace(go.Scatter(</span>
<span id="cb17-184"><a href="#cb17-184" aria-hidden="true" tabindex="-1"></a>                         x<span class="op">=</span>negative_data.index[mask],</span>
<span id="cb17-185"><a href="#cb17-185" aria-hidden="true" tabindex="-1"></a>                         y<span class="op">=</span>negative_data[col][mask],</span>
<span id="cb17-186"><a href="#cb17-186" aria-hidden="true" tabindex="-1"></a>                         mode<span class="op">=</span><span class="st">'lines'</span>,</span>
<span id="cb17-187"><a href="#cb17-187" aria-hidden="true" tabindex="-1"></a>                         fill<span class="op">=</span><span class="st">'tonexty'</span>,</span>
<span id="cb17-188"><a href="#cb17-188" aria-hidden="true" tabindex="-1"></a>                         line<span class="op">=</span><span class="bu">dict</span>(width<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span>color),</span>
<span id="cb17-189"><a href="#cb17-189" aria-hidden="true" tabindex="-1"></a>                         fillcolor<span class="op">=</span>color,</span>
<span id="cb17-190"><a href="#cb17-190" aria-hidden="true" tabindex="-1"></a>                         name<span class="op">=</span>col,</span>
<span id="cb17-191"><a href="#cb17-191" aria-hidden="true" tabindex="-1"></a>                         stackgroup<span class="op">=</span><span class="st">'negative'</span>,</span>
<span id="cb17-192"><a href="#cb17-192" aria-hidden="true" tabindex="-1"></a>                         hovertemplate<span class="op">=</span><span class="st">'&lt;b&gt;%</span><span class="sc">{fullData.name}</span><span class="st">&lt;/b&gt;&lt;br&gt;Power: %</span><span class="sc">{y:.2f}</span><span class="st"> GW&lt;extra&gt;&lt;/extra&gt;'</span>,</span>
<span id="cb17-193"><a href="#cb17-193" aria-hidden="true" tabindex="-1"></a>                         showlegend<span class="op">=</span><span class="va">True</span></span>
<span id="cb17-194"><a href="#cb17-194" aria-hidden="true" tabindex="-1"></a>                     ))</span>
<span id="cb17-195"><a href="#cb17-195" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb17-196"><a href="#cb17-196" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Add demand line (always show)</span></span>
<span id="cb17-197"><a href="#cb17-197" aria-hidden="true" tabindex="-1"></a>         fig.add_trace(go.Scatter(</span>
<span id="cb17-198"><a href="#cb17-198" aria-hidden="true" tabindex="-1"></a>             x<span class="op">=</span>load_series.index,</span>
<span id="cb17-199"><a href="#cb17-199" aria-hidden="true" tabindex="-1"></a>             y<span class="op">=</span>load_series,</span>
<span id="cb17-200"><a href="#cb17-200" aria-hidden="true" tabindex="-1"></a>             mode<span class="op">=</span><span class="st">'lines'</span>,</span>
<span id="cb17-201"><a href="#cb17-201" aria-hidden="true" tabindex="-1"></a>             line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'green'</span>, width<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb17-202"><a href="#cb17-202" aria-hidden="true" tabindex="-1"></a>             name<span class="op">=</span><span class="st">'Demand'</span>,</span>
<span id="cb17-203"><a href="#cb17-203" aria-hidden="true" tabindex="-1"></a>             hovertemplate<span class="op">=</span><span class="st">'&lt;b&gt;Demand&lt;/b&gt;&lt;br&gt;Power: %</span><span class="sc">{y:.2f}</span><span class="st"> GW&lt;extra&gt;&lt;/extra&gt;'</span>,</span>
<span id="cb17-204"><a href="#cb17-204" aria-hidden="true" tabindex="-1"></a>             showlegend<span class="op">=</span><span class="va">True</span></span>
<span id="cb17-205"><a href="#cb17-205" aria-hidden="true" tabindex="-1"></a>         ))</span>
<span id="cb17-206"><a href="#cb17-206" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb17-207"><a href="#cb17-207" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Add curtailment line if requested</span></span>
<span id="cb17-208"><a href="#cb17-208" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> show_curtailment <span class="kw">and</span> curtail <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb17-209"><a href="#cb17-209" aria-hidden="true" tabindex="-1"></a>             fig.add_trace(go.Scatter(</span>
<span id="cb17-210"><a href="#cb17-210" aria-hidden="true" tabindex="-1"></a>                 x<span class="op">=</span>curtail.index,</span>
<span id="cb17-211"><a href="#cb17-211" aria-hidden="true" tabindex="-1"></a>                 y<span class="op">=</span>curtail,</span>
<span id="cb17-212"><a href="#cb17-212" aria-hidden="true" tabindex="-1"></a>                 mode<span class="op">=</span><span class="st">'lines'</span>,</span>
<span id="cb17-213"><a href="#cb17-213" aria-hidden="true" tabindex="-1"></a>                 line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>, width<span class="op">=</span><span class="dv">2</span>, dash<span class="op">=</span><span class="st">'dash'</span>),</span>
<span id="cb17-214"><a href="#cb17-214" aria-hidden="true" tabindex="-1"></a>                 name<span class="op">=</span><span class="st">'Curtailment'</span>,</span>
<span id="cb17-215"><a href="#cb17-215" aria-hidden="true" tabindex="-1"></a>                 hovertemplate<span class="op">=</span><span class="st">'&lt;b&gt;Curtailment&lt;/b&gt;&lt;br&gt;Power: %</span><span class="sc">{y:.2f}</span><span class="st"> GW&lt;extra&gt;&lt;/extra&gt;'</span>,</span>
<span id="cb17-216"><a href="#cb17-216" aria-hidden="true" tabindex="-1"></a>                 showlegend<span class="op">=</span><span class="va">True</span></span>
<span id="cb17-217"><a href="#cb17-217" aria-hidden="true" tabindex="-1"></a>                 ))</span>
<span id="cb17-218"><a href="#cb17-218" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb17-219"><a href="#cb17-219" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Update layout</span></span>
<span id="cb17-220"><a href="#cb17-220" aria-hidden="true" tabindex="-1"></a>         fig.update_layout(</span>
<span id="cb17-221"><a href="#cb17-221" aria-hidden="true" tabindex="-1"></a>             title<span class="op">=</span>plot_title,</span>
<span id="cb17-222"><a href="#cb17-222" aria-hidden="true" tabindex="-1"></a>             xaxis_title<span class="op">=</span><span class="st">'Time'</span>,</span>
<span id="cb17-223"><a href="#cb17-223" aria-hidden="true" tabindex="-1"></a>             yaxis_title<span class="op">=</span><span class="st">'Power (GW)'</span>,</span>
<span id="cb17-224"><a href="#cb17-224" aria-hidden="true" tabindex="-1"></a>             hovermode<span class="op">=</span><span class="st">'x unified'</span>,</span>
<span id="cb17-225"><a href="#cb17-225" aria-hidden="true" tabindex="-1"></a>             hoverlabel<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb17-226"><a href="#cb17-226" aria-hidden="true" tabindex="-1"></a>                 bgcolor<span class="op">=</span><span class="st">"white"</span>,</span>
<span id="cb17-227"><a href="#cb17-227" aria-hidden="true" tabindex="-1"></a>                 bordercolor<span class="op">=</span><span class="st">"black"</span>,</span>
<span id="cb17-228"><a href="#cb17-228" aria-hidden="true" tabindex="-1"></a>                 font_size<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb17-229"><a href="#cb17-229" aria-hidden="true" tabindex="-1"></a>             ),</span>
<span id="cb17-230"><a href="#cb17-230" aria-hidden="true" tabindex="-1"></a>             legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb17-231"><a href="#cb17-231" aria-hidden="true" tabindex="-1"></a>                 x<span class="op">=</span><span class="fl">1.02</span>,</span>
<span id="cb17-232"><a href="#cb17-232" aria-hidden="true" tabindex="-1"></a>                 y<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb17-233"><a href="#cb17-233" aria-hidden="true" tabindex="-1"></a>                 bgcolor<span class="op">=</span><span class="st">'rgba(255,255,255,0.8)'</span>,</span>
<span id="cb17-234"><a href="#cb17-234" aria-hidden="true" tabindex="-1"></a>                 bordercolor<span class="op">=</span><span class="st">'rgba(0,0,0,0.2)'</span>,</span>
<span id="cb17-235"><a href="#cb17-235" aria-hidden="true" tabindex="-1"></a>                 borderwidth<span class="op">=</span><span class="dv">1</span></span>
<span id="cb17-236"><a href="#cb17-236" aria-hidden="true" tabindex="-1"></a>             ),</span>
<span id="cb17-237"><a href="#cb17-237" aria-hidden="true" tabindex="-1"></a>             width<span class="op">=</span><span class="dv">800</span>,</span>
<span id="cb17-238"><a href="#cb17-238" aria-hidden="true" tabindex="-1"></a>             height<span class="op">=</span><span class="dv">500</span></span>
<span id="cb17-239"><a href="#cb17-239" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb17-240"><a href="#cb17-240" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb17-241"><a href="#cb17-241" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Add scenario annotations</span></span>
<span id="cb17-242"><a href="#cb17-242" aria-hidden="true" tabindex="-1"></a>         annotations <span class="op">=</span> []</span>
<span id="cb17-243"><a href="#cb17-243" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> scenario_name:</span>
<span id="cb17-244"><a href="#cb17-244" aria-hidden="true" tabindex="-1"></a>             annotations.append(</span>
<span id="cb17-245"><a href="#cb17-245" aria-hidden="true" tabindex="-1"></a>                 <span class="bu">dict</span>(</span>
<span id="cb17-246"><a href="#cb17-246" aria-hidden="true" tabindex="-1"></a>                     x<span class="op">=</span><span class="fl">1.02</span>, y<span class="op">=-</span><span class="fl">0.05</span>,</span>
<span id="cb17-247"><a href="#cb17-247" aria-hidden="true" tabindex="-1"></a>                     xref<span class="op">=</span><span class="st">'paper'</span>, yref<span class="op">=</span><span class="st">'paper'</span>,</span>
<span id="cb17-248"><a href="#cb17-248" aria-hidden="true" tabindex="-1"></a>                     text<span class="op">=</span><span class="ss">f"Scenario: </span><span class="sc">{</span>scenario_name<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb17-249"><a href="#cb17-249" aria-hidden="true" tabindex="-1"></a>                     showarrow<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb17-250"><a href="#cb17-250" aria-hidden="true" tabindex="-1"></a>                     font<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">'gray'</span>),</span>
<span id="cb17-251"><a href="#cb17-251" aria-hidden="true" tabindex="-1"></a>                     xanchor<span class="op">=</span><span class="st">'center'</span>,</span>
<span id="cb17-252"><a href="#cb17-252" aria-hidden="true" tabindex="-1"></a>                     yanchor<span class="op">=</span><span class="st">'top'</span></span>
<span id="cb17-253"><a href="#cb17-253" aria-hidden="true" tabindex="-1"></a>                 )</span>
<span id="cb17-254"><a href="#cb17-254" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb17-255"><a href="#cb17-255" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb17-256"><a href="#cb17-256" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> annotations:</span>
<span id="cb17-257"><a href="#cb17-257" aria-hidden="true" tabindex="-1"></a>             fig.update_layout(annotations<span class="op">=</span>annotations)</span>
<span id="cb17-258"><a href="#cb17-258" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb17-259"><a href="#cb17-259" aria-hidden="true" tabindex="-1"></a>         fig.show()</span>
<span id="cb17-260"><a href="#cb17-260" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb17-261"><a href="#cb17-261" aria-hidden="true" tabindex="-1"></a>     <span class="cf">else</span>:</span>
<span id="cb17-262"><a href="#cb17-262" aria-hidden="true" tabindex="-1"></a>         <span class="co"># MATPLOTLIB STATIC PLOT </span></span>
<span id="cb17-263"><a href="#cb17-263" aria-hidden="true" tabindex="-1"></a>         fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="fl">8.4</span>, <span class="fl">6.5</span>)) <span class="co">#12,6.5</span></span>
<span id="cb17-264"><a href="#cb17-264" aria-hidden="true" tabindex="-1"></a>         cols <span class="op">=</span> p_slice.columns.<span class="bu">map</span>(<span class="kw">lambda</span> c: n.carriers.loc[c,<span class="st">'color'</span>])</span>
<span id="cb17-265"><a href="#cb17-265" aria-hidden="true" tabindex="-1"></a>         p_slice.where(p_slice<span class="op">&gt;</span><span class="dv">0</span>).plot.area(ax<span class="op">=</span>ax,linewidth<span class="op">=</span><span class="dv">0</span>,color<span class="op">=</span>cols)</span>
<span id="cb17-266"><a href="#cb17-266" aria-hidden="true" tabindex="-1"></a>         neg <span class="op">=</span> p_slice.where(p_slice<span class="op">&lt;</span><span class="dv">0</span>).dropna(how<span class="op">=</span><span class="st">'all'</span>,axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb17-267"><a href="#cb17-267" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> <span class="kw">not</span> neg.empty:</span>
<span id="cb17-268"><a href="#cb17-268" aria-hidden="true" tabindex="-1"></a>             neg_cols<span class="op">=</span>[n.carriers.loc[c,<span class="st">'color'</span>] <span class="cf">for</span> c <span class="kw">in</span> neg.columns]</span>
<span id="cb17-269"><a href="#cb17-269" aria-hidden="true" tabindex="-1"></a>             neg.plot.area(ax<span class="op">=</span>ax,linewidth<span class="op">=</span><span class="dv">0</span>,color<span class="op">=</span>neg_cols)</span>
<span id="cb17-270"><a href="#cb17-270" aria-hidden="true" tabindex="-1"></a>         load_series.plot(ax<span class="op">=</span>ax,color<span class="op">=</span><span class="st">'g'</span>,linewidth<span class="op">=</span><span class="fl">1.5</span>,label<span class="op">=</span><span class="st">'Demand'</span>)</span>
<span id="cb17-271"><a href="#cb17-271" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> show_curtailment <span class="kw">and</span> curtail <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb17-272"><a href="#cb17-272" aria-hidden="true" tabindex="-1"></a>             curtail.plot(ax<span class="op">=</span>ax,color<span class="op">=</span><span class="st">'k'</span>,linestyle<span class="op">=</span><span class="st">'--'</span>,linewidth<span class="op">=</span><span class="fl">1.2</span>,label<span class="op">=</span><span class="st">'Curtailment'</span>)</span>
<span id="cb17-273"><a href="#cb17-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-274"><a href="#cb17-274" aria-hidden="true" tabindex="-1"></a>         <span class="co"># limits &amp; legend</span></span>
<span id="cb17-275"><a href="#cb17-275" aria-hidden="true" tabindex="-1"></a>         up <span class="op">=</span> <span class="bu">max</span>(p_slice.where(p_slice<span class="op">&gt;</span><span class="dv">0</span>).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>).<span class="bu">max</span>(),</span>
<span id="cb17-276"><a href="#cb17-276" aria-hidden="true" tabindex="-1"></a>                  load_series.<span class="bu">max</span>(),</span>
<span id="cb17-277"><a href="#cb17-277" aria-hidden="true" tabindex="-1"></a>                  curtail.<span class="bu">max</span>() <span class="cf">if</span> curtail <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span> <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb17-278"><a href="#cb17-278" aria-hidden="true" tabindex="-1"></a>         dn <span class="op">=</span> <span class="bu">min</span>(p_slice.where(p_slice<span class="op">&lt;</span><span class="dv">0</span>).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>).<span class="bu">min</span>(), load_series.<span class="bu">min</span>())</span>
<span id="cb17-279"><a href="#cb17-279" aria-hidden="true" tabindex="-1"></a>         ax.set_ylim(dn <span class="cf">if</span> <span class="kw">not</span> np.isclose(up,dn) <span class="cf">else</span> dn<span class="op">-</span><span class="fl">0.1</span>, up)</span>
<span id="cb17-280"><a href="#cb17-280" aria-hidden="true" tabindex="-1"></a>        <span class="co">#  fig.patch.set_facecolor('#F0FFFF') </span></span>
<span id="cb17-281"><a href="#cb17-281" aria-hidden="true" tabindex="-1"></a>         ax.set_facecolor(<span class="st">'#F0FFFF'</span>)</span>
<span id="cb17-282"><a href="#cb17-282" aria-hidden="true" tabindex="-1"></a>         h,l <span class="op">=</span> ax.get_legend_handles_labels()</span>
<span id="cb17-283"><a href="#cb17-283" aria-hidden="true" tabindex="-1"></a>         seen<span class="op">=</span>{} <span class="op">;</span> fh,fl<span class="op">=</span>[],[]</span>
<span id="cb17-284"><a href="#cb17-284" aria-hidden="true" tabindex="-1"></a>         <span class="cf">for</span> hh,ll <span class="kw">in</span> <span class="bu">zip</span>(h,l):</span>
<span id="cb17-285"><a href="#cb17-285" aria-hidden="true" tabindex="-1"></a>             <span class="cf">if</span> ll <span class="kw">not</span> <span class="kw">in</span> seen: fh.append(hh)<span class="op">;</span>fl.append(ll)<span class="op">;</span>seen[ll]<span class="op">=</span><span class="va">True</span></span>
<span id="cb17-286"><a href="#cb17-286" aria-hidden="true" tabindex="-1"></a>         ax.legend(fh,fl,loc<span class="op">=</span>(<span class="fl">1.02</span>,<span class="fl">0.67</span>), fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb17-287"><a href="#cb17-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-288"><a href="#cb17-288" aria-hidden="true" tabindex="-1"></a>         <span class="co"># scenario text</span></span>
<span id="cb17-289"><a href="#cb17-289" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> scenario_objective:</span>
<span id="cb17-290"><a href="#cb17-290" aria-hidden="true" tabindex="-1"></a>             ax.text(<span class="fl">1.02</span>,<span class="fl">0.01</span>,<span class="ss">f"Objective:</span><span class="ch">\n</span><span class="sc">{</span>scenario_objective<span class="sc">}</span><span class="ss">"</span>,transform<span class="op">=</span>ax.transAxes,</span>
<span id="cb17-291"><a href="#cb17-291" aria-hidden="true" tabindex="-1"></a>                     fontsize<span class="op">=</span><span class="dv">8</span>,va<span class="op">=</span><span class="st">'bottom'</span>,ha<span class="op">=</span><span class="st">'left'</span>,bbox<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">'white'</span>,alpha<span class="op">=</span><span class="fl">0.7</span>,edgecolor<span class="op">=</span><span class="st">'none'</span>))</span>
<span id="cb17-292"><a href="#cb17-292" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> scenario_name:</span>
<span id="cb17-293"><a href="#cb17-293" aria-hidden="true" tabindex="-1"></a>             ax.text(<span class="fl">1.02</span>,<span class="op">-</span><span class="fl">0.05</span>,<span class="ss">f"Scenario: </span><span class="sc">{</span>scenario_name<span class="sc">}</span><span class="ss">"</span>,transform<span class="op">=</span>ax.transAxes,</span>
<span id="cb17-294"><a href="#cb17-294" aria-hidden="true" tabindex="-1"></a>                     fontsize<span class="op">=</span><span class="dv">9</span>,color<span class="op">=</span><span class="st">'gray'</span>,ha<span class="op">=</span><span class="st">'center'</span>,va<span class="op">=</span><span class="st">'top'</span>)</span>
<span id="cb17-295"><a href="#cb17-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-296"><a href="#cb17-296" aria-hidden="true" tabindex="-1"></a>         ax.set_ylabel(<span class="st">'GW'</span>)</span>
<span id="cb17-297"><a href="#cb17-297" aria-hidden="true" tabindex="-1"></a>         ax.set_title(plot_title)</span>
<span id="cb17-298"><a href="#cb17-298" aria-hidden="true" tabindex="-1"></a>         plt.tight_layout()</span>
<span id="cb17-299"><a href="#cb17-299" aria-hidden="true" tabindex="-1"></a>         plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Review dispatch for a 5-day period in NSW.</p>
<p>Note here that very little gas is dispatched due to having a higher marginal price than black coal. In reality the ramping up and down of coal plants is smoother than this. The hourly resolution does not constrain the ramping much compared to actual five-minute dispatching in the NEM. For example, Eraring black coal units maximum ramp-up of 4MW/min, is 240MW per model snapshot (hourly).</p>
<div id="11dba569" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_dispatch function example - static plot of NSW1 region for 3 days starting from 2024-07-01</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>plot_dispatch(n, time<span class="op">=</span><span class="st">"2024-07-01"</span>, days<span class="op">=</span><span class="dv">5</span>, regions<span class="op">=</span>[<span class="st">"NSW1"</span>], show_imports<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="High-level_NEM_files/figure-html/cell-16-output-1.png" width="796" height="601" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The interactive version is good for exploratory data analysis.</p>
<div id="c915b70f" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_dispatch function example - interactive plot of VIC1 region for 10 days starting from 2024-01-19</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>plot_dispatch(n, time<span class="op">=</span><span class="st">"2024-01-10"</span>, days<span class="op">=</span><span class="dv">5</span>, regions<span class="op">=</span>[<span class="st">"VIC1"</span>], show_imports<span class="op">=</span><span class="va">True</span>, interactive<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
        <script type="text/javascript">
        window.PlotlyConfig = {MathJaxConfig: 'local'};
        if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
        </script>
        <script type="module">import "https://cdn.plot.ly/plotly-3.0.1.min"</script>
        
</div>
<div class="cell-output cell-output-display">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.0.1.min.js"></script>                <div id="457d2ab2-b247-4f7c-9e00-43b836240311" class="plotly-graph-div" style="height:500px; width:800px;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("457d2ab2-b247-4f7c-9e00-43b836240311")) {                    Plotly.newPlot(                        "457d2ab2-b247-4f7c-9e00-43b836240311",                        [{"fill":"tozeroy","fillcolor":"#715E50","hovertemplate":"\u003cb\u003e%{fullData.name}\u003c\u002fb\u003e\u003cbr\u003ePower: %{y:.3f} GW\u003cextra\u003e\u003c\u002fextra\u003e","line":{"color":"#715E50","width":0},"mode":"lines","name":"Brown Coal","showlegend":true,"stackgroup":"positive","x":["2024-01-10T00:00:00.000000000","2024-01-10T01:00:00.000000000","2024-01-10T02:00:00.000000000","2024-01-10T03:00:00.000000000","2024-01-10T04:00:00.000000000","2024-01-10T05:00:00.000000000","2024-01-10T06:00:00.000000000","2024-01-10T07:00:00.000000000","2024-01-10T08:00:00.000000000","2024-01-10T09:00:00.000000000","2024-01-10T10:00:00.000000000","2024-01-10T11:00:00.000000000","2024-01-10T12:00:00.000000000","2024-01-10T13:00:00.000000000","2024-01-10T14:00:00.000000000","2024-01-10T15:00:00.000000000","2024-01-10T16:00:00.000000000","2024-01-10T17:00:00.000000000","2024-01-10T18:00:00.000000000","2024-01-10T19:00:00.000000000","2024-01-10T20:00:00.000000000","2024-01-10T21:00:00.000000000","2024-01-10T22:00:00.000000000","2024-01-10T23:00:00.000000000","2024-01-11T00:00:00.000000000","2024-01-11T01:00:00.000000000","2024-01-11T02:00:00.000000000","2024-01-11T03:00:00.000000000","2024-01-11T04:00:00.000000000","2024-01-11T05:00:00.000000000","2024-01-11T06:00:00.000000000","2024-01-11T07:00:00.000000000","2024-01-11T08:00:00.000000000","2024-01-11T09:00:00.000000000","2024-01-11T10:00:00.000000000","2024-01-11T11:00:00.000000000","2024-01-11T12:00:00.000000000","2024-01-11T13:00:00.000000000","2024-01-11T14:00:00.000000000","2024-01-11T15:00:00.000000000","2024-01-11T16:00:00.000000000","2024-01-11T17:00:00.000000000","2024-01-11T18:00:00.000000000","2024-01-11T19:00:00.000000000","2024-01-11T20:00:00.000000000","2024-01-11T21:00:00.000000000","2024-01-11T22:00:00.000000000","2024-01-11T23:00:00.000000000","2024-01-12T00:00:00.000000000","2024-01-12T01:00:00.000000000","2024-01-12T02:00:00.000000000","2024-01-12T03:00:00.000000000","2024-01-12T04:00:00.000000000","2024-01-12T05:00:00.000000000","2024-01-12T06:00:00.000000000","2024-01-12T07:00:00.000000000","2024-01-12T08:00:00.000000000","2024-01-12T09:00:00.000000000","2024-01-12T10:00:00.000000000","2024-01-12T11:00:00.000000000","2024-01-12T12:00:00.000000000","2024-01-12T13:00:00.000000000","2024-01-12T14:00:00.000000000","2024-01-12T15:00:00.000000000","2024-01-12T16:00:00.000000000","2024-01-12T17:00:00.000000000","2024-01-12T18:00:00.000000000","2024-01-12T19:00:00.000000000","2024-01-12T20:00:00.000000000","2024-01-12T21:00:00.000000000","2024-01-12T22:00:00.000000000","2024-01-12T23:00:00.000000000","2024-01-13T00:00:00.000000000","2024-01-13T01:00:00.000000000","2024-01-13T02:00:00.000000000","2024-01-13T03:00:00.000000000","2024-01-13T04:00:00.000000000","2024-01-13T05:00:00.000000000","2024-01-13T06:00:00.000000000","2024-01-13T07:00:00.000000000","2024-01-13T08:00:00.000000000","2024-01-13T09:00:00.000000000","2024-01-13T10:00:00.000000000","2024-01-13T11:00:00.000000000","2024-01-13T12:00:00.000000000","2024-01-13T13:00:00.000000000","2024-01-13T14:00:00.000000000","2024-01-13T15:00:00.000000000","2024-01-13T16:00:00.000000000","2024-01-13T17:00:00.000000000","2024-01-13T18:00:00.000000000","2024-01-13T19:00:00.000000000","2024-01-13T20:00:00.000000000","2024-01-13T21:00:00.000000000","2024-01-13T22:00:00.000000000","2024-01-13T23:00:00.000000000","2024-01-14T00:00:00.000000000","2024-01-14T01:00:00.000000000","2024-01-14T02:00:00.000000000","2024-01-14T03:00:00.000000000","2024-01-14T04:00:00.000000000","2024-01-14T05:00:00.000000000","2024-01-14T06:00:00.000000000","2024-01-14T07:00:00.000000000","2024-01-14T08:00:00.000000000","2024-01-14T09:00:00.000000000","2024-01-14T10:00:00.000000000","2024-01-14T11:00:00.000000000","2024-01-14T12:00:00.000000000","2024-01-14T13:00:00.000000000","2024-01-14T14:00:00.000000000","2024-01-14T15:00:00.000000000","2024-01-14T16:00:00.000000000","2024-01-14T17:00:00.000000000","2024-01-14T18:00:00.000000000","2024-01-14T19:00:00.000000000","2024-01-14T20:00:00.000000000","2024-01-14T21:00:00.000000000","2024-01-14T22:00:00.000000000","2024-01-14T23:00:00.000000000"],"y":{"dtype":"f8","bdata":"w\u002fUoXI\u002fCEkDD9Shcj8ISQMP1KFyPwhJAw\u002fUoXI\u002fCEkDD9Shcj8ISQMP1KFyPwhJAw\u002fUoXI\u002fCEkDD9Shcj8ISQJ2VIxXuWwJAo9zwxvUozD+j3PDG9SjMP6Pc8Mb1KMw\u002fo9zwxvUozD+j3PDG9SjMP6Pc8Mb1KMw\u002fKWBgUs3B+z9EpvAOqt4OQMP1KFyPwhJAw\u002fUoXI\u002fCEkDD9Shcj8ISQMP1KFyPwhJAw\u002fUoXI\u002fCEkDD9Shcj8ISQMP1KFyPwhJAw\u002fUoXI\u002fCEkDD9Shcj8ISQMP1KFyPwhJAw\u002fUoXI\u002fCEkDD9Shcj8ISQMP1KFyPwhJAw\u002fUoXI\u002fCEkDD9Shcj8ISQKCHKaoiyQpAo9zwxvUozD+j3PDG9SjMP6Pc8Mb1KMw\u002fo9zwxvUozD+j3PDG9SjMP6Pc8Mb1KMw\u002fo9zwxvUozD9o33MAoYABQMP1KFyPwhJAw\u002fUoXI\u002fCEkDD9Shcj8ISQMP1KFyPwhJAw\u002fUoXI\u002fCEkDD9Shcj8ISQMP1KFyPwhJAw\u002fUoXI\u002fCEkDD9Shcj8ISQMP1KFyPwhJAw\u002fUoXI\u002fCEkDD9Shcj8ISQMP1KFyPwhJAw\u002fUoXI\u002fCEkDyqTmKaYcPQExziZ\u002fbZd0\u002fo9zwxvUozD+j3PDG9SjMP6Pc8Mb1KMw\u002fo9zwxvUozD+j3PDG9SjMP6Pc8Mb1KMw\u002f2wm1vsFJ8D89G4Tc5MYRQMP1KFyPwhJAw\u002fUoXI\u002fCEkDD9Shcj8ISQMP1KFyPwhJAw\u002fUoXI\u002fCEkDD9Shcj8ISQMP1KFyPwhJAw\u002fUoXI\u002fCEkDD9Shcj8ISQMP1KFyPwhJAw\u002fUoXI\u002fCEkDD9Shcj8ISQMP1KFyPwhJAw\u002fUoXI\u002fCEkCEQher7In7P6Pc8Mb1KMw\u002fo9zwxvUozD+j3PDG9SjMP6Pc8Mb1KMw\u002fo9zwxvUozD+j3PDG9SjMP6Pc8Mb1KMw\u002fo9zwxvUozD9hYw9aLSL1P9z7iXQ47QxA4gHeHlU0EkCqK8Q0DKQSQMP1KFyPwhJAw\u002fUoXI\u002fCEkDD9Shcj8ISQMP1KFyPwhJAw\u002fUoXI\u002fCEkDD9Shcj8ISQMP1KFyPwhJAw\u002fUoXI\u002fCEkDD9Shcj8ISQMP1KFyPwhJAxZHA1\u002fEPEUCrXJQyfF3XP6Pc8Mb1KMw\u002fo9zwxvUozD+j3PDG9SjMP6Pc8Mb1KMw\u002fo9zwxvUozD+j3PDG9SjMP6Pc8Mb1KMw\u002fo9zwxvUozD+j3PDG9SjMP\u002fUb5XWU9\u002fU\u002fGftHpyHYBEDD9Shcj8ISQMP1KFyPwhJAw\u002fUoXI\u002fCEkDD9Shcj8ISQMP1KFyPwhJA"},"type":"scatter"},{"fill":"tonexty","fillcolor":"#1E81D4","hovertemplate":"\u003cb\u003e%{fullData.name}\u003c\u002fb\u003e\u003cbr\u003ePower: %{y:.3f} GW\u003cextra\u003e\u003c\u002fextra\u003e","line":{"color":"#1E81D4","width":0},"mode":"lines","name":"Hydro","showlegend":true,"stackgroup":"positive","x":["2024-01-10T00:00:00.000000000","2024-01-10T01:00:00.000000000","2024-01-10T02:00:00.000000000","2024-01-10T03:00:00.000000000","2024-01-10T04:00:00.000000000","2024-01-10T05:00:00.000000000","2024-01-10T06:00:00.000000000","2024-01-10T07:00:00.000000000","2024-01-10T08:00:00.000000000","2024-01-10T17:00:00.000000000","2024-01-10T18:00:00.000000000","2024-01-10T19:00:00.000000000","2024-01-10T20:00:00.000000000","2024-01-10T21:00:00.000000000","2024-01-10T22:00:00.000000000","2024-01-10T23:00:00.000000000","2024-01-11T00:00:00.000000000","2024-01-11T01:00:00.000000000","2024-01-11T02:00:00.000000000","2024-01-11T03:00:00.000000000","2024-01-11T04:00:00.000000000","2024-01-11T05:00:00.000000000","2024-01-11T06:00:00.000000000","2024-01-11T07:00:00.000000000","2024-01-11T16:00:00.000000000","2024-01-11T17:00:00.000000000","2024-01-11T18:00:00.000000000","2024-01-11T19:00:00.000000000","2024-01-11T20:00:00.000000000","2024-01-11T21:00:00.000000000","2024-01-11T22:00:00.000000000","2024-01-11T23:00:00.000000000","2024-01-12T00:00:00.000000000","2024-01-12T01:00:00.000000000","2024-01-12T02:00:00.000000000","2024-01-12T03:00:00.000000000","2024-01-12T04:00:00.000000000","2024-01-12T05:00:00.000000000","2024-01-12T06:00:00.000000000","2024-01-12T13:00:00.000000000","2024-01-12T15:00:00.000000000","2024-01-12T16:00:00.000000000","2024-01-12T17:00:00.000000000","2024-01-12T18:00:00.000000000","2024-01-12T19:00:00.000000000","2024-01-12T20:00:00.000000000","2024-01-12T21:00:00.000000000","2024-01-12T22:00:00.000000000","2024-01-12T23:00:00.000000000","2024-01-13T00:00:00.000000000","2024-01-13T01:00:00.000000000","2024-01-13T02:00:00.000000000","2024-01-13T03:00:00.000000000","2024-01-13T04:00:00.000000000","2024-01-13T05:00:00.000000000","2024-01-13T06:00:00.000000000","2024-01-13T07:00:00.000000000","2024-01-13T16:00:00.000000000","2024-01-13T17:00:00.000000000","2024-01-13T18:00:00.000000000","2024-01-13T19:00:00.000000000","2024-01-13T20:00:00.000000000","2024-01-13T21:00:00.000000000","2024-01-13T22:00:00.000000000","2024-01-13T23:00:00.000000000","2024-01-14T00:00:00.000000000","2024-01-14T01:00:00.000000000","2024-01-14T02:00:00.000000000","2024-01-14T03:00:00.000000000","2024-01-14T04:00:00.000000000","2024-01-14T17:00:00.000000000","2024-01-14T18:00:00.000000000","2024-01-14T19:00:00.000000000","2024-01-14T20:00:00.000000000","2024-01-14T21:00:00.000000000","2024-01-14T22:00:00.000000000","2024-01-14T23:00:00.000000000"],"y":{"dtype":"f8","bdata":"OGbZk8DmnD84ZtmTwOacPxKEK6BQT58\u002f0O6QYoBEkz+YGwx1WOG2P0z8UdSZe+A\u002ffsfw2M9i4T8ldQKaCBu+P9DukGKARIM\u002fEoQroFBPrz8Rp5NsdTnlP3C3JAfsavo\u002fXkiHhzB++j\u002fyC68kea7zP79cixagbe0\u002fJhqk4Cnk4j9eSIeHMH66P4QqNXugFag\u002fOGbZk8DmjD+EKjV7oBWIP5z8Fp0stb4\u002fesN95Nak4z+gpSvYRjzhP9DukGKARJM\u002f9tA+VvDbkD9LV7CNeLKrPxctQNtq1vE\u002fG00uxsA6+j9OmgZF8wD6P1AcQL\u002fv3\u002fg\u002fO2pMiLmk6j8\u002fbr98smLYP3I5XoHoSbk\u002fJXUCmggbrj\u002f20D5W8NugP6oM424QraU\u002f88zLYfcd0z\u002f3rdaJy\u002fHaP87HtaFinM8\u002fEgvankgBtT+bH39pUZ\u002fkP1dAoZ4+Au8\u002fokPgSKDB+j+wbycR4V\u002f8PwabOo+K\u002f\u002fs\u002fkdRCyeTU+j83iUFg5dDyP3xFt17Tg+I\u002fWmd8X1yq4j+NtFTejnDiP420VN6OcOI\u002fZVBtcCL61T83iUFg5dDSP1ZjCWtj7NQ\u002fM4XOa+wS1T\u002fQ7pBigETTP21YU1kUdsE\u002fhCo1e6AVuD\u002fvyFht\u002fl\u002fVP0X0a+un\u002f+Q\u002fSfje36C98j8onN1aJsPxPxaInpRJDe0\u002foACKkSVz7D+JsOHplbLkPyYapOAp5OI\u002ff0kqU8xB4D83iUFg5dDSPzeJQWDl0NI\u002fbVhTWRR2sT9HdqVlpN7TP03Z6Qd1keo\u002fSfje36C98j8De0ykNJvzPzbIJCNnYfM\u002fJXUCmggb7j8peXWOAdnrPw=="},"type":"scatter"},{"fill":"tonexty","fillcolor":"#FFE066","hovertemplate":"\u003cb\u003e%{fullData.name}\u003c\u002fb\u003e\u003cbr\u003ePower: %{y:.3f} GW\u003cextra\u003e\u003c\u002fextra\u003e","line":{"color":"#FFE066","width":0},"mode":"lines","name":"Rooftop Solar","showlegend":true,"stackgroup":"positive","x":["2024-01-10T05:00:00.000000000","2024-01-10T06:00:00.000000000","2024-01-10T07:00:00.000000000","2024-01-10T08:00:00.000000000","2024-01-10T09:00:00.000000000","2024-01-10T10:00:00.000000000","2024-01-10T11:00:00.000000000","2024-01-10T12:00:00.000000000","2024-01-10T13:00:00.000000000","2024-01-10T14:00:00.000000000","2024-01-10T15:00:00.000000000","2024-01-10T16:00:00.000000000","2024-01-10T17:00:00.000000000","2024-01-10T18:00:00.000000000","2024-01-10T19:00:00.000000000","2024-01-10T20:00:00.000000000","2024-01-11T05:00:00.000000000","2024-01-11T06:00:00.000000000","2024-01-11T07:00:00.000000000","2024-01-11T08:00:00.000000000","2024-01-11T09:00:00.000000000","2024-01-11T10:00:00.000000000","2024-01-11T11:00:00.000000000","2024-01-11T12:00:00.000000000","2024-01-11T13:00:00.000000000","2024-01-11T14:00:00.000000000","2024-01-11T15:00:00.000000000","2024-01-11T16:00:00.000000000","2024-01-11T17:00:00.000000000","2024-01-11T18:00:00.000000000","2024-01-11T19:00:00.000000000","2024-01-11T20:00:00.000000000","2024-01-12T05:00:00.000000000","2024-01-12T06:00:00.000000000","2024-01-12T07:00:00.000000000","2024-01-12T08:00:00.000000000","2024-01-12T09:00:00.000000000","2024-01-12T10:00:00.000000000","2024-01-12T11:00:00.000000000","2024-01-12T12:00:00.000000000","2024-01-12T13:00:00.000000000","2024-01-12T14:00:00.000000000","2024-01-12T15:00:00.000000000","2024-01-12T16:00:00.000000000","2024-01-12T17:00:00.000000000","2024-01-12T18:00:00.000000000","2024-01-12T19:00:00.000000000","2024-01-12T20:00:00.000000000","2024-01-13T05:00:00.000000000","2024-01-13T06:00:00.000000000","2024-01-13T07:00:00.000000000","2024-01-13T08:00:00.000000000","2024-01-13T09:00:00.000000000","2024-01-13T10:00:00.000000000","2024-01-13T11:00:00.000000000","2024-01-13T12:00:00.000000000","2024-01-13T13:00:00.000000000","2024-01-13T14:00:00.000000000","2024-01-13T15:00:00.000000000","2024-01-13T16:00:00.000000000","2024-01-13T17:00:00.000000000","2024-01-13T18:00:00.000000000","2024-01-13T19:00:00.000000000","2024-01-13T20:00:00.000000000","2024-01-14T05:00:00.000000000","2024-01-14T06:00:00.000000000","2024-01-14T07:00:00.000000000","2024-01-14T08:00:00.000000000","2024-01-14T09:00:00.000000000","2024-01-14T10:00:00.000000000","2024-01-14T11:00:00.000000000","2024-01-14T12:00:00.000000000","2024-01-14T13:00:00.000000000","2024-01-14T14:00:00.000000000","2024-01-14T15:00:00.000000000","2024-01-14T16:00:00.000000000","2024-01-14T17:00:00.000000000","2024-01-14T18:00:00.000000000","2024-01-14T19:00:00.000000000","2024-01-14T20:00:00.000000000"],"y":{"dtype":"f8","bdata":"y5+dBa4fez8yv18KDL7JP1oXqVxheuc\u002fpGHD3+d49z88XL9N7cgAQN1w3y\u002fNZARAB0F5GC6OBkD2jatndy8HQLQf6CoWvgVAee5cwWSTBEDRAbJVi5sDQG8jrKlPfABA\u002fGY\u002fq\u002fzH9j9l9t6bqazmP2fDDMSvLMU\u002fhZ2Qxgh7Yz\u002fCMl9EEL9rPwF0gQvETMM\u002fVt4vLMbo4j8sb8qNUzjyP6EwP\u002fqk9P4\u002fBPTc8Q\u002fdBEDV\u002fuXxCmQHQKS8piKqhghAKkCUsk9dCEATw+6lKJAHQFZVA+43gAVAZK\u002fAnpJaAUBkY5WZw6f3P1cb8ZL9Aec\u002f7Re2xNsexT+o00ejiphiP6LsQWkNCWg\u002fNwQ1ecKrwT8\u002fApIZOXvkP+RuCdYrwfY\u002fyx4ORR4WAUDGQIUJPRYFQBeO7AlfJgdAPGbzOIH0B0CiMIlqutMGQCXZQSpnIwVATmVfU4cdA0AIlksA1Cf\u002fPyulvWS1FPU\u002fkUnqgJPP5D9YeyiAcWDEP7S4i0yFEGA\u002f\u002fkH1OvcxXz83JP\u002faexnDP1j7coZVsdw\u002fjRnSklO65T9\u002fJRxWg5DxPxftmEhLAPU\u002frz+ADRbA9z+D8\u002fN7drL3PzAibraT8PI\u002fNox\u002f5rss8D9f7djBBLHwPyOOekBiVfM\u002fMrjG5+HP7T\u002flkZYRPOzcP5t041DNaLw\u002fuLNyNJluUj+g6Ma599J0P7K3N6QYSsY\u002fiHPMzO+U4T\u002fmlRVUMa7xPxQm5oV5of0\u002fK76Ci+cqBEBw\u002fx5DqUcGQPQIFN2MlgZAOzeJpl9MBkAlDLOH9c8BQHfw+45UogBA+d8urAOZ9z+O1DcWHb7sP5NMKDZVD+A\u002f3w8TV+tewz\u002f4NppeUEBjPw=="},"type":"scatter"},{"fill":"tonexty","fillcolor":"#FDB324","hovertemplate":"\u003cb\u003e%{fullData.name}\u003c\u002fb\u003e\u003cbr\u003ePower: %{y:.3f} GW\u003cextra\u003e\u003c\u002fextra\u003e","line":{"color":"#FDB324","width":0},"mode":"lines","name":"Solar","showlegend":true,"stackgroup":"positive","x":["2024-01-10T05:00:00.000000000","2024-01-10T06:00:00.000000000","2024-01-10T07:00:00.000000000","2024-01-10T08:00:00.000000000","2024-01-10T09:00:00.000000000","2024-01-10T10:00:00.000000000","2024-01-10T11:00:00.000000000","2024-01-10T12:00:00.000000000","2024-01-10T13:00:00.000000000","2024-01-10T14:00:00.000000000","2024-01-10T15:00:00.000000000","2024-01-10T16:00:00.000000000","2024-01-10T17:00:00.000000000","2024-01-10T18:00:00.000000000","2024-01-10T19:00:00.000000000","2024-01-11T05:00:00.000000000","2024-01-11T06:00:00.000000000","2024-01-11T07:00:00.000000000","2024-01-11T08:00:00.000000000","2024-01-11T09:00:00.000000000","2024-01-11T10:00:00.000000000","2024-01-11T11:00:00.000000000","2024-01-11T12:00:00.000000000","2024-01-11T13:00:00.000000000","2024-01-11T14:00:00.000000000","2024-01-11T15:00:00.000000000","2024-01-11T16:00:00.000000000","2024-01-11T17:00:00.000000000","2024-01-11T18:00:00.000000000","2024-01-11T19:00:00.000000000","2024-01-12T05:00:00.000000000","2024-01-12T06:00:00.000000000","2024-01-12T07:00:00.000000000","2024-01-12T08:00:00.000000000","2024-01-12T09:00:00.000000000","2024-01-12T10:00:00.000000000","2024-01-12T11:00:00.000000000","2024-01-12T12:00:00.000000000","2024-01-12T13:00:00.000000000","2024-01-12T14:00:00.000000000","2024-01-12T15:00:00.000000000","2024-01-12T16:00:00.000000000","2024-01-12T17:00:00.000000000","2024-01-12T18:00:00.000000000","2024-01-12T19:00:00.000000000","2024-01-13T05:00:00.000000000","2024-01-13T06:00:00.000000000","2024-01-13T07:00:00.000000000","2024-01-13T08:00:00.000000000","2024-01-13T09:00:00.000000000","2024-01-13T10:00:00.000000000","2024-01-13T11:00:00.000000000","2024-01-13T12:00:00.000000000","2024-01-13T13:00:00.000000000","2024-01-13T14:00:00.000000000","2024-01-13T15:00:00.000000000","2024-01-13T16:00:00.000000000","2024-01-13T17:00:00.000000000","2024-01-13T18:00:00.000000000","2024-01-13T19:00:00.000000000","2024-01-14T05:00:00.000000000","2024-01-14T06:00:00.000000000","2024-01-14T07:00:00.000000000","2024-01-14T08:00:00.000000000","2024-01-14T09:00:00.000000000","2024-01-14T10:00:00.000000000","2024-01-14T11:00:00.000000000","2024-01-14T12:00:00.000000000","2024-01-14T13:00:00.000000000","2024-01-14T15:00:00.000000000","2024-01-14T16:00:00.000000000","2024-01-14T17:00:00.000000000","2024-01-14T18:00:00.000000000","2024-01-14T19:00:00.000000000"],"y":{"dtype":"f8","bdata":"xQYLJ2n+mD9WEANd+wLgPzV8C+vGO\u002fM\u002fB9LFppVC9j8A5lq0AO30P6g3o+ar5PQ\u002feAlOfSD58j\u002fDobd4eM\u002fyP4wqw7gbRPM\u002feAlOfSD58j81fAvrxjvzP38UdeYeEvM\u002fZMkcy7vq8z8WqpuLv+3oP8UGCydp\u002frg\u002f3nAfuTXplj\u002fdC8wKRbrgP\u002f9Cjxg9N\u002fE\u002fu5aQD3q28j\u002fxLEFGQAXxP1naqbncYOw\u002ftvC8VGzM6D\u002fT3uALk6nrP2MmUS\u002f4NPA\u002fahK8IY2K8T\u002fq46HvbmXzP3\u002f1uG+1TvQ\u002feeqRBrc19D\u002ffMqfLYmLpP7fRAN4CCbo\u002fLa9cb5upkD8IVtXL7zTbP138bU+QWPE\u002fSp2AJsKG8z9KfsSvWMP0P3PAriZPWfU\u002fBvGBHf8F9T+oN6Pmq+T0Pzxodt1bkfQ\u002f7KUpApze9T9kqmBUUif1PwbxgR3\u002fBfU\u002f0LcFS3UB8z8TJoxmZfvjP4wqw7gbRLM\u002fLa9cb5upgD897IUCtoPZPwxZ3eo5afE\u002fp3Ub1H5r8j\u002fCwHPv4ZLxP0nb+BOVDfE\u002f+Ddorz4e8T8helImNbTxP38UdeYeEvM\u002fvHfUmBDz8z\u002fXwiy0cxrzP4IclDDT9uw\u002fp3Ub1H5r4j\u002f52jNLAtTEPxNFSN3OvpI\u002fLa9cb5upgD9NpZ9wdmvNP6qc9pScE9s\u002fWpwxzAna3j\u002fFBgsnaf7YP+ohGt1B7NA\u002fPGh23VuRxD+0yeGTTiTQP8LAc+\u002fhktE\u002fct9qnbgc5D8HlE25wrvoP54pdF5jl+4\u002fLnHkgcgi4z8helImNbSxPw=="},"type":"scatter"},{"fill":"tonexty","fillcolor":"#3BBFE5","hovertemplate":"\u003cb\u003e%{fullData.name}\u003c\u002fb\u003e\u003cbr\u003ePower: %{y:.3f} GW\u003cextra\u003e\u003c\u002fextra\u003e","line":{"color":"#3BBFE5","width":0},"mode":"lines","name":"Wind","showlegend":true,"stackgroup":"positive","x":["2024-01-10T00:00:00.000000000","2024-01-10T01:00:00.000000000","2024-01-10T02:00:00.000000000","2024-01-10T03:00:00.000000000","2024-01-10T04:00:00.000000000","2024-01-10T05:00:00.000000000","2024-01-10T06:00:00.000000000","2024-01-10T07:00:00.000000000","2024-01-10T08:00:00.000000000","2024-01-10T09:00:00.000000000","2024-01-10T10:00:00.000000000","2024-01-10T11:00:00.000000000","2024-01-10T12:00:00.000000000","2024-01-10T13:00:00.000000000","2024-01-10T14:00:00.000000000","2024-01-10T15:00:00.000000000","2024-01-10T16:00:00.000000000","2024-01-10T17:00:00.000000000","2024-01-10T18:00:00.000000000","2024-01-10T19:00:00.000000000","2024-01-10T20:00:00.000000000","2024-01-10T21:00:00.000000000","2024-01-10T22:00:00.000000000","2024-01-10T23:00:00.000000000","2024-01-11T00:00:00.000000000","2024-01-11T01:00:00.000000000","2024-01-11T02:00:00.000000000","2024-01-11T03:00:00.000000000","2024-01-11T04:00:00.000000000","2024-01-11T05:00:00.000000000","2024-01-11T06:00:00.000000000","2024-01-11T07:00:00.000000000","2024-01-11T08:00:00.000000000","2024-01-11T09:00:00.000000000","2024-01-11T10:00:00.000000000","2024-01-11T11:00:00.000000000","2024-01-11T12:00:00.000000000","2024-01-11T13:00:00.000000000","2024-01-11T14:00:00.000000000","2024-01-11T15:00:00.000000000","2024-01-11T16:00:00.000000000","2024-01-11T17:00:00.000000000","2024-01-11T18:00:00.000000000","2024-01-11T19:00:00.000000000","2024-01-11T20:00:00.000000000","2024-01-11T21:00:00.000000000","2024-01-11T22:00:00.000000000","2024-01-11T23:00:00.000000000","2024-01-12T00:00:00.000000000","2024-01-12T01:00:00.000000000","2024-01-12T02:00:00.000000000","2024-01-12T03:00:00.000000000","2024-01-12T04:00:00.000000000","2024-01-12T05:00:00.000000000","2024-01-12T06:00:00.000000000","2024-01-12T07:00:00.000000000","2024-01-12T08:00:00.000000000","2024-01-12T09:00:00.000000000","2024-01-12T10:00:00.000000000","2024-01-12T11:00:00.000000000","2024-01-12T12:00:00.000000000","2024-01-12T13:00:00.000000000","2024-01-12T14:00:00.000000000","2024-01-12T15:00:00.000000000","2024-01-12T16:00:00.000000000","2024-01-12T17:00:00.000000000","2024-01-12T18:00:00.000000000","2024-01-12T19:00:00.000000000","2024-01-12T20:00:00.000000000","2024-01-12T21:00:00.000000000","2024-01-12T22:00:00.000000000","2024-01-12T23:00:00.000000000","2024-01-13T00:00:00.000000000","2024-01-13T01:00:00.000000000","2024-01-13T02:00:00.000000000","2024-01-13T03:00:00.000000000","2024-01-13T04:00:00.000000000","2024-01-13T05:00:00.000000000","2024-01-13T06:00:00.000000000","2024-01-13T07:00:00.000000000","2024-01-13T08:00:00.000000000","2024-01-13T09:00:00.000000000","2024-01-13T10:00:00.000000000","2024-01-13T11:00:00.000000000","2024-01-13T12:00:00.000000000","2024-01-13T13:00:00.000000000","2024-01-13T14:00:00.000000000","2024-01-13T15:00:00.000000000","2024-01-13T16:00:00.000000000","2024-01-13T17:00:00.000000000","2024-01-13T18:00:00.000000000","2024-01-13T19:00:00.000000000","2024-01-13T20:00:00.000000000","2024-01-13T21:00:00.000000000","2024-01-13T22:00:00.000000000","2024-01-13T23:00:00.000000000","2024-01-14T00:00:00.000000000","2024-01-14T01:00:00.000000000","2024-01-14T02:00:00.000000000","2024-01-14T03:00:00.000000000","2024-01-14T04:00:00.000000000","2024-01-14T05:00:00.000000000","2024-01-14T06:00:00.000000000","2024-01-14T07:00:00.000000000","2024-01-14T08:00:00.000000000","2024-01-14T09:00:00.000000000","2024-01-14T10:00:00.000000000","2024-01-14T11:00:00.000000000","2024-01-14T12:00:00.000000000","2024-01-14T13:00:00.000000000","2024-01-14T14:00:00.000000000","2024-01-14T15:00:00.000000000","2024-01-14T16:00:00.000000000","2024-01-14T17:00:00.000000000","2024-01-14T18:00:00.000000000","2024-01-14T19:00:00.000000000","2024-01-14T20:00:00.000000000","2024-01-14T21:00:00.000000000","2024-01-14T22:00:00.000000000","2024-01-14T23:00:00.000000000"],"y":{"dtype":"f8","bdata":"5EhnYORl3T9\u002fbJIf8SvOPxbe5SK+E8s\u002fD3o2qz5X4z98urpjsU3aP0TBjClY48Q\u002f4ZaPpKSHyT\u002fhlo+kpIfZP5BmLJrOTuQ\u002feQjjp3Fv5j9aRuo9ldPgP0z+J3\u002f3jt4\u002fQQ+1bRgF4T+wARHiytnrPxmQvd798e4\u002fxa2CGOja5T8SLA5nfjXnPzHuBtFa0ew\u002fwvuqXKj88T\u002f59NiWAWf3P24yqgzjbvk\u002f7kW0HVN3+D+D3htDAHDzP5p8s82N6e8\u002fjbRU3o5w8D\u002fOqs\u002fVVuzwP6fria4LP\u002fA\u002f5+EEptO68D\u002fOqs\u002fVVuzwP6fria4LP\u002fA\u002fp+uJrgs\u002f8D9gqpm1FJDoP8TUljrI6+M\u002fSiU8odef3D9KJTyh15\u002fMP0EPtW0YBdE\u002fR3Nk5ZfB2D+qnWFqSx3kP+RIZ2DkZe0\u002fHClbJO1G8j+QZiyazk70P4aQ8\u002f4\u002fTvc\u002fSiU8odef\u002fD9aRuo9ldMAQFXbTfBNUwJAO6QYINGEAkCtLxLacq4AQJbx7zMuHPo\u002fjo1AvK5f8j+afLPNjenvP8sRMpBnl+0\u002f\u002f1iIDoEj7z+QZiyazk70Pw96Nqs+V\u002fM\u002fp+uJrgs\u002f8D8SLA5nfjXnP0aaeAd40tY\u002fdlYL7DGR0j9EwYwpWOPUP3kI46dxb9Y\u002f3uS36GSp1T9Hc2Tll8HYP3rhzoWRXtg\u002fkGYsms5O5D\u002fPg7uzdtvyP5E\u002fGHjuPfY\u002fR3Nk5ZfB+D\u002fHhm72B8r3P32TpkHRPPw\u002fWYY41sVt\u002fz+9iSE5mbj8P2CqmbUUkPg\u002f0VynkZbK9D9QcLGiBtPzP24yqgzjbvk\u002fvYkhOZm4\u002fD99k6ZB0Tz8P0olPKHXn\u002fw\u002fSiU8odef\u002fD+9iSE5mbj8P1X7dDxmoPk\u002feuHOhZFe+D8Hfentz0X4P5bx7zMuHPo\u002fUyKJXkax9z8LCK2HLxP+P\u002fVpFf2hmQFAbxKDwMohAkC3JXLBGfwEQJmjx+9t+g1AHvtZLEVyDUD3OxQF+sQMQF0Y6UXt\u002fgtA2lIHeT0YCUAacJaS5aQHQPOwUGua9wZAuf5dnznrBkCM1Hsqp70HQOGWj6SkhwlAADlhwmjWB0ASLA5nfjUHQDOny2JicwdAaafmcoOhA0DFrYIY6Nr1Pxi30QDeAu0\u002ff2ySH\u002fEr3j95COOncW\u002fWP7Oz6J0KuM8\u002fEiwOZ3411z8ZkL3e\u002ffHeP5fK2xFOC+w\u002fc71tpkI8\u002fz+8kA4PYXwDQL2JITmZuAxAMe4G0VrRDEC8sDVbeckKQDSAt0CCYglAeuHOhZFeCEDUDn9N1qgIQNXnaiv2lwpA"},"type":"scatter"},{"fill":"tonexty","fillcolor":"#814ad4","hovertemplate":"\u003cb\u003e%{fullData.name}\u003c\u002fb\u003e\u003cbr\u003ePower: %{y:.3f} GW\u003cextra\u003e\u003c\u002fextra\u003e","line":{"color":"#814ad4","width":0},"mode":"lines","name":"Battery","showlegend":true,"stackgroup":"positive","x":["2024-01-10T05:00:00.000000000","2024-01-10T06:00:00.000000000","2024-01-11T04:00:00.000000000","2024-01-11T05:00:00.000000000","2024-01-11T06:00:00.000000000","2024-01-11T07:00:00.000000000","2024-01-12T04:00:00.000000000","2024-01-12T05:00:00.000000000","2024-01-13T03:00:00.000000000","2024-01-13T04:00:00.000000000","2024-01-13T05:00:00.000000000","2024-01-13T06:00:00.000000000","2024-01-13T21:00:00.000000000","2024-01-13T22:00:00.000000000","2024-01-13T23:00:00.000000000","2024-01-14T00:00:00.000000000","2024-01-14T01:00:00.000000000","2024-01-14T02:00:00.000000000","2024-01-14T03:00:00.000000000","2024-01-14T04:00:00.000000000","2024-01-14T05:00:00.000000000","2024-01-14T21:00:00.000000000","2024-01-14T22:00:00.000000000","2024-01-14T23:00:00.000000000"],"y":{"dtype":"f8","bdata":"4XoUrkfhB0B66RtfGeb6Px+tLE4KE8o\u002fYuZzBZig8D9Cb6emtqUFQGYJeT2E9OY\u002feukbXxnm+j\u002fhehSuR+EHQN6dfEUOROM\u002fkcVeJfvHAUBqks1niXLlP\u002fc74plmvfI\u002f2frLKQKVzD+JQf74mZbOP+VkLWvStOU\u002fK\u002f8p6J2Y3j8vOv\u002fqsLvcP1x8JBUY\u002f9Q\u002fTFwWQ6FC4D9K9EkHhKXrPwifIkS\u002fv+w\u002f31+\u002fhi7ExD+WMwzK3z2uP3EVqGO6jLc\u002f"},"type":"scatter"},{"fill":"tonexty","fillcolor":"#7f7f7f","hovertemplate":"\u003cb\u003e%{fullData.name}\u003c\u002fb\u003e\u003cbr\u003ePower: %{y:.3f} GW\u003cextra\u003e\u003c\u002fextra\u003e","line":{"color":"#7f7f7f","width":0},"mode":"lines","name":"Imports\u002fExports","showlegend":true,"stackgroup":"positive","x":["2024-01-10T09:00:00.000000000","2024-01-10T11:00:00.000000000","2024-01-10T12:00:00.000000000","2024-01-11T11:00:00.000000000","2024-01-11T12:00:00.000000000","2024-01-12T08:00:00.000000000","2024-01-12T09:00:00.000000000","2024-01-12T10:00:00.000000000","2024-01-12T13:00:00.000000000","2024-01-12T14:00:00.000000000","2024-01-12T15:00:00.000000000","2024-01-13T08:00:00.000000000","2024-01-13T09:00:00.000000000","2024-01-13T10:00:00.000000000","2024-01-13T12:00:00.000000000","2024-01-13T13:00:00.000000000","2024-01-14T07:00:00.000000000","2024-01-14T08:00:00.000000000","2024-01-14T09:00:00.000000000","2024-01-14T10:00:00.000000000","2024-01-14T13:00:00.000000000"],"y":{"dtype":"f8","bdata":"3XOAJHxa6D+9wDocc4vGP6A2MCHu9co\u002fNzSNJON\u002f\u002fj+Ye\u002fwLlhS4P0iLPH1O9eY\u002fMsIS9fvr4j9K7Tplp+QCQHsJxxDn8QJAHJTx9H\u002fE8j9O3mxwj5DRPzVeVCt6b+o\u002fH19K7NxAAUCypbv9d\u002fD4P0ym7yEZU\u002fY\u002fFxnkqMU7kz83guXJ4nDbP21KUjb2\u002ffM\u002fmi8smMmV2j+9Oa4B\u002f437P9fKurH+IuQ\u002f"},"type":"scatter"},{"fill":"tonexty","fillcolor":"#814ad4","hovertemplate":"\u003cb\u003e%{fullData.name}\u003c\u002fb\u003e\u003cbr\u003ePower: %{y:.2f} GW\u003cextra\u003e\u003c\u002fextra\u003e","line":{"color":"#814ad4","width":0},"mode":"lines","name":"Battery","showlegend":true,"stackgroup":"negative","x":["2024-01-10T09:00:00.000000000","2024-01-10T10:00:00.000000000","2024-01-10T11:00:00.000000000","2024-01-10T12:00:00.000000000","2024-01-10T13:00:00.000000000","2024-01-11T10:00:00.000000000","2024-01-11T11:00:00.000000000","2024-01-11T12:00:00.000000000","2024-01-11T14:00:00.000000000","2024-01-12T09:00:00.000000000","2024-01-12T10:00:00.000000000","2024-01-12T13:00:00.000000000","2024-01-13T08:00:00.000000000","2024-01-13T09:00:00.000000000","2024-01-13T10:00:00.000000000","2024-01-13T12:00:00.000000000","2024-01-13T13:00:00.000000000","2024-01-13T14:00:00.000000000","2024-01-13T15:00:00.000000000","2024-01-14T08:00:00.000000000","2024-01-14T09:00:00.000000000","2024-01-14T10:00:00.000000000","2024-01-14T11:00:00.000000000","2024-01-14T13:00:00.000000000","2024-01-14T14:00:00.000000000","2024-01-14T15:00:00.000000000"],"y":{"dtype":"f8","bdata":"voFhjjTq87\u002fpKyuR17jkv\u002fQrKzsIvfS\u002fB1\u002fvQz139r+4GOAdiczuvwnVz8sts8e\u002f4XoUrkfhB8DaCNoY1XD4v5drCW3Abuu\u002fuLM3ggMi5b\u002fhehSuR+EHwGnfvEeZjf6\u002fgwKWdRBb37\u002fVqdCXjWMCwA\u002fJ0pvJkv6\u002fCSEXZz+I\u002fb8OhReX\u002f5Devw6FF5f\u002fkN6\u002fDoUXl\u002f+Q3r\u002fV8eWYxLjxv1gzQk2Sb+2\u002f4XoUrkfhB8DRcmXdslq+v15HS\u002fmAzQDADoUXl\u002f+Q3r8OhReX\u002f5Devw=="},"type":"scatter"},{"fill":"tonexty","fillcolor":"#7f7f7f","hovertemplate":"\u003cb\u003e%{fullData.name}\u003c\u002fb\u003e\u003cbr\u003ePower: %{y:.2f} GW\u003cextra\u003e\u003c\u002fextra\u003e","line":{"color":"#7f7f7f","width":0},"mode":"lines","name":"Imports\u002fExports","showlegend":true,"stackgroup":"negative","x":["2024-01-10T00:00:00.000000000","2024-01-10T01:00:00.000000000","2024-01-10T02:00:00.000000000","2024-01-10T03:00:00.000000000","2024-01-10T04:00:00.000000000","2024-01-10T05:00:00.000000000","2024-01-10T06:00:00.000000000","2024-01-10T07:00:00.000000000","2024-01-10T08:00:00.000000000","2024-01-10T10:00:00.000000000","2024-01-10T13:00:00.000000000","2024-01-10T14:00:00.000000000","2024-01-10T15:00:00.000000000","2024-01-10T16:00:00.000000000","2024-01-10T17:00:00.000000000","2024-01-10T18:00:00.000000000","2024-01-10T19:00:00.000000000","2024-01-10T20:00:00.000000000","2024-01-10T21:00:00.000000000","2024-01-10T22:00:00.000000000","2024-01-10T23:00:00.000000000","2024-01-11T00:00:00.000000000","2024-01-11T01:00:00.000000000","2024-01-11T02:00:00.000000000","2024-01-11T03:00:00.000000000","2024-01-11T04:00:00.000000000","2024-01-11T05:00:00.000000000","2024-01-11T06:00:00.000000000","2024-01-11T07:00:00.000000000","2024-01-11T08:00:00.000000000","2024-01-11T09:00:00.000000000","2024-01-11T10:00:00.000000000","2024-01-11T13:00:00.000000000","2024-01-11T14:00:00.000000000","2024-01-11T15:00:00.000000000","2024-01-11T16:00:00.000000000","2024-01-11T17:00:00.000000000","2024-01-11T18:00:00.000000000","2024-01-11T19:00:00.000000000","2024-01-11T20:00:00.000000000","2024-01-11T21:00:00.000000000","2024-01-11T22:00:00.000000000","2024-01-11T23:00:00.000000000","2024-01-12T00:00:00.000000000","2024-01-12T01:00:00.000000000","2024-01-12T02:00:00.000000000","2024-01-12T03:00:00.000000000","2024-01-12T04:00:00.000000000","2024-01-12T05:00:00.000000000","2024-01-12T06:00:00.000000000","2024-01-12T07:00:00.000000000","2024-01-12T11:00:00.000000000","2024-01-12T12:00:00.000000000","2024-01-12T16:00:00.000000000","2024-01-12T17:00:00.000000000","2024-01-12T18:00:00.000000000","2024-01-12T19:00:00.000000000","2024-01-12T20:00:00.000000000","2024-01-12T21:00:00.000000000","2024-01-12T22:00:00.000000000","2024-01-12T23:00:00.000000000","2024-01-13T00:00:00.000000000","2024-01-13T01:00:00.000000000","2024-01-13T02:00:00.000000000","2024-01-13T03:00:00.000000000","2024-01-13T04:00:00.000000000","2024-01-13T05:00:00.000000000","2024-01-13T06:00:00.000000000","2024-01-13T07:00:00.000000000","2024-01-13T11:00:00.000000000","2024-01-13T14:00:00.000000000","2024-01-13T15:00:00.000000000","2024-01-13T16:00:00.000000000","2024-01-13T17:00:00.000000000","2024-01-13T18:00:00.000000000","2024-01-13T19:00:00.000000000","2024-01-13T20:00:00.000000000","2024-01-13T21:00:00.000000000","2024-01-13T22:00:00.000000000","2024-01-13T23:00:00.000000000","2024-01-14T00:00:00.000000000","2024-01-14T01:00:00.000000000","2024-01-14T02:00:00.000000000","2024-01-14T03:00:00.000000000","2024-01-14T04:00:00.000000000","2024-01-14T05:00:00.000000000","2024-01-14T06:00:00.000000000","2024-01-14T11:00:00.000000000","2024-01-14T12:00:00.000000000","2024-01-14T14:00:00.000000000","2024-01-14T15:00:00.000000000","2024-01-14T16:00:00.000000000","2024-01-14T17:00:00.000000000","2024-01-14T18:00:00.000000000","2024-01-14T19:00:00.000000000","2024-01-14T20:00:00.000000000","2024-01-14T21:00:00.000000000","2024-01-14T22:00:00.000000000","2024-01-14T23:00:00.000000000"],"y":{"dtype":"f8","bdata":"LrxSRcQB6r+hgmrPi8npv2gYOC469u2\u002fvDWUvqsy9b+xb+prIYrwv\u002fBym3SqaQ\u002fAZedUnPd+CcBZRK6Af3oFwN9IpW7lLPu\u002fisKAZNvG0b\u002fhGBpPzrrMv7yne0Dmy+y\u002fU2Jyia\u002fQ\u002fr+hahohKGQJwJjQDd\u002fAcQjANfBAbnBNA8CbvMOnSfgEwBCrPPEV6QXAXdKz4Gn7BMAcU5bRgbgCwF7MqcV6xfy\u002fgUcA+m1T+b+pIamkQaL7v\u002fQkkh5IhPy\u002fkCOHahsL\u002fb+SKq873SsAwO2z\u002fOchKgjA1c+vyB0mFMCtjAC84KwLwD8G\u002fybg4wHA92ppexVhwb\u002fRisX5WMPgv4Z7uoEu7fu\u002f\u002fnZFqr+u7L96deE8yf71v25CO1aSaQPAPJnwUmtkDsAQaQWHe78MwGmqu62XiAnACGPeau2\u002fCsAd59tVL4wNwNTUiF4+GwjAr9g47U9pAMDJmJKAPaP3vxSDpX1jE\u002fi\u002faEhlSk4D+b\u002fcoN7yJDv6v1jPp1XDBw7AjdIqXB92E8Ansr6eZrr8v9MeJ6uLQ\u002f2\u002fX5euKdyw47\u002fIALfImjrIvwtDjJxa9QfAcKaAFzKvCMDebMx+u8YAwAz2u2fKufS\u002fxzWAxKL4\u002fL8APvLJ9aoAwKzKOUnSRP2\u002ftjSr+52V+79B9DPP0Bj+v\u002fXD27vQYAHAl8gFZ\u002fA3BMAUwb\u002fJ2kELwNXPr8gdJhTARPvKqJtfC8D\u002fCjrdMeMRwDFR8bMZ6\u002fK\u002fSgvpqP3Y6b9zJI6L8g6zv1ve6t6lRNi\u002ft3esDPuJAsD2UdbZ7y4UwMl4j35eVhTANoGiLGhVFMB\u002f\u002fF9K9bUTwKSe3WJGPhPACAPj+1BZE8AIA+P7UFkTwAgD4\u002ftQWRPARSUIxMUlFMCGgT86imMUwL4fD7sEZxTAUQLzzrZaFMDcai6yUVYUwCV9Ydmk9Q3AcQR+m\u002f7R9L8I620ynwf6vyFEldgUXq+\u002f8kkf7RI78r\u002fT+eCgjFbxv\u002fM3kb2RIAbAbxE9WAOWDMAUs\u002ffiVF8TwAb3NV6fWRLACAPj+1BZE8Atpuj\u002fzAgTwE5eiQiujRPA"},"type":"scatter"},{"hovertemplate":"\u003cb\u003eDemand\u003c\u002fb\u003e\u003cbr\u003ePower: %{y:.2f} GW\u003cextra\u003e\u003c\u002fextra\u003e","line":{"color":"green","width":2},"mode":"lines","name":"Demand","showlegend":true,"x":["2024-01-10T00:00:00.000000000","2024-01-10T01:00:00.000000000","2024-01-10T02:00:00.000000000","2024-01-10T03:00:00.000000000","2024-01-10T04:00:00.000000000","2024-01-10T05:00:00.000000000","2024-01-10T06:00:00.000000000","2024-01-10T07:00:00.000000000","2024-01-10T08:00:00.000000000","2024-01-10T09:00:00.000000000","2024-01-10T10:00:00.000000000","2024-01-10T11:00:00.000000000","2024-01-10T12:00:00.000000000","2024-01-10T13:00:00.000000000","2024-01-10T14:00:00.000000000","2024-01-10T15:00:00.000000000","2024-01-10T16:00:00.000000000","2024-01-10T17:00:00.000000000","2024-01-10T18:00:00.000000000","2024-01-10T19:00:00.000000000","2024-01-10T20:00:00.000000000","2024-01-10T21:00:00.000000000","2024-01-10T22:00:00.000000000","2024-01-10T23:00:00.000000000","2024-01-11T00:00:00.000000000","2024-01-11T01:00:00.000000000","2024-01-11T02:00:00.000000000","2024-01-11T03:00:00.000000000","2024-01-11T04:00:00.000000000","2024-01-11T05:00:00.000000000","2024-01-11T06:00:00.000000000","2024-01-11T07:00:00.000000000","2024-01-11T08:00:00.000000000","2024-01-11T09:00:00.000000000","2024-01-11T10:00:00.000000000","2024-01-11T11:00:00.000000000","2024-01-11T12:00:00.000000000","2024-01-11T13:00:00.000000000","2024-01-11T14:00:00.000000000","2024-01-11T15:00:00.000000000","2024-01-11T16:00:00.000000000","2024-01-11T17:00:00.000000000","2024-01-11T18:00:00.000000000","2024-01-11T19:00:00.000000000","2024-01-11T20:00:00.000000000","2024-01-11T21:00:00.000000000","2024-01-11T22:00:00.000000000","2024-01-11T23:00:00.000000000","2024-01-12T00:00:00.000000000","2024-01-12T01:00:00.000000000","2024-01-12T02:00:00.000000000","2024-01-12T03:00:00.000000000","2024-01-12T04:00:00.000000000","2024-01-12T05:00:00.000000000","2024-01-12T06:00:00.000000000","2024-01-12T07:00:00.000000000","2024-01-12T08:00:00.000000000","2024-01-12T09:00:00.000000000","2024-01-12T10:00:00.000000000","2024-01-12T11:00:00.000000000","2024-01-12T12:00:00.000000000","2024-01-12T13:00:00.000000000","2024-01-12T14:00:00.000000000","2024-01-12T15:00:00.000000000","2024-01-12T16:00:00.000000000","2024-01-12T17:00:00.000000000","2024-01-12T18:00:00.000000000","2024-01-12T19:00:00.000000000","2024-01-12T20:00:00.000000000","2024-01-12T21:00:00.000000000","2024-01-12T22:00:00.000000000","2024-01-12T23:00:00.000000000","2024-01-13T00:00:00.000000000","2024-01-13T01:00:00.000000000","2024-01-13T02:00:00.000000000","2024-01-13T03:00:00.000000000","2024-01-13T04:00:00.000000000","2024-01-13T05:00:00.000000000","2024-01-13T06:00:00.000000000","2024-01-13T07:00:00.000000000","2024-01-13T08:00:00.000000000","2024-01-13T09:00:00.000000000","2024-01-13T10:00:00.000000000","2024-01-13T11:00:00.000000000","2024-01-13T12:00:00.000000000","2024-01-13T13:00:00.000000000","2024-01-13T14:00:00.000000000","2024-01-13T15:00:00.000000000","2024-01-13T16:00:00.000000000","2024-01-13T17:00:00.000000000","2024-01-13T18:00:00.000000000","2024-01-13T19:00:00.000000000","2024-01-13T20:00:00.000000000","2024-01-13T21:00:00.000000000","2024-01-13T22:00:00.000000000","2024-01-13T23:00:00.000000000","2024-01-14T00:00:00.000000000","2024-01-14T01:00:00.000000000","2024-01-14T02:00:00.000000000","2024-01-14T03:00:00.000000000","2024-01-14T04:00:00.000000000","2024-01-14T05:00:00.000000000","2024-01-14T06:00:00.000000000","2024-01-14T07:00:00.000000000","2024-01-14T08:00:00.000000000","2024-01-14T09:00:00.000000000","2024-01-14T10:00:00.000000000","2024-01-14T11:00:00.000000000","2024-01-14T12:00:00.000000000","2024-01-14T13:00:00.000000000","2024-01-14T14:00:00.000000000","2024-01-14T15:00:00.000000000","2024-01-14T16:00:00.000000000","2024-01-14T17:00:00.000000000","2024-01-14T18:00:00.000000000","2024-01-14T19:00:00.000000000","2024-01-14T20:00:00.000000000","2024-01-14T21:00:00.000000000","2024-01-14T22:00:00.000000000","2024-01-14T23:00:00.000000000"],"y":{"dtype":"f8","bdata":"tmeWBKhpEUCi0R3EzpQQQC7\u002fIf329Q9A9u6P96rVD0DayeAoeZUQQKs+V1uxvxFAzXoxlBNtEkApBd1e0rgRQEAwR4\u002ffWxBAOPOrOUCwDkDeGtgqwWINQL6fGi\u002fdpAxAVwT\u002fW8kODUDh7qzddmEOQK2jqgmi7g9A73coCvSJEEArNXugFZgSQHjWbrvQ\u002fBRAE2HD0yslFkDoDmJnCp0VQHjzVIfcrBRATWcng6NEE0Ad5ssLsO8RQLddaK7T6BFAelORCmPrEEDAPjp15TMQQNHLKJZbWg9AXaeRlspbD0CJDKt4IzMQQBR0e0ljdBFAR1oqb0dYEkBeY5eo3poRQHE486s5IBBAs3vysFArDEAcR6zFp8AJQEn5SbVPxwhAg6Pk1TnGCEA9CtejcD0JQHRGlPYGHwtAzO7Jw0KtDkBU46WbxOARQIQNT6+UhRRAMqzijcwDFkAPlxx3SgcWQKbydoTTAhVAoMiTpGtmE0DGUE60q1ASQEUvo1huiRJAJa\u002fOMSC7EUDQ7SWN0doQQJiL+E7MOhBA5\u002fup8dItEEDn3sMlx70QQPbuj\u002feq1RFA8+ocA7LXEkCsi9toAC8SQNwMN+DzoxBA2v6VlSblDkBcOBCSBQwPQCRFZFjFmxBAw0fElEiiEkCvzjEge\u002f0UQEK3lzRG6xZAMNP2r6wUGUBSD9HoDmIbQPOTap+OpxxA220Xmuu0HEAXZTbIJGMbQMlZ2NMOPxlAtyizQSb5FkBjKCfaVegUQG7\u002fykqTUhRA6J\u002fgYkWtEkBNLVvri0QRQBlz1xLyYRBA7UeKyLDKD0CTh4Va07wPQPDce7jkOBBAJCh+jLkLEECmD11Q3\u002fIPQNzXgXNGlA9Afa62Yn8ZDkBT6LzGLtENQME5I0p7gwxAzemymNg8DkCWlSaloJsPQNrJ4Ch59Q9ASzygbMqVDkC9wRcmU4UOQCb8Uj9vihBAxLZFmQ2SEUDRXKeRlsoRQLvtQnOdZhFAW1oNiXuMEEC3C811GmkPQNZW7C+7JxBAhXzQs1k1DkCNtFTejnAMQPCnxks3CQtAqFKzB1rBCkBNFYxK6kQLQMTTK2UZYgtA4GdcOBDSCkBeY5eo3toIQJ3X2CWqdwZA5IOezaoPA0BeukkMAmsAQD6RJ0nXTP8\u002frJDyk2qf\u002fz\u002fUK2UZ4pgBQNrhr8kaNQVAhVrTvOMUCUCgyJOkayYOQJD3qpUJXxFAP8HFihosEkCQuMfSh04SQNPZyeAo+RFAeLmI78QMEUCLcf4mFAIQQCtNSkG3NxBA"},"type":"scatter"},{"hovertemplate":"\u003cb\u003eCurtailment\u003c\u002fb\u003e\u003cbr\u003ePower: %{y:.2f} GW\u003cextra\u003e\u003c\u002fextra\u003e","line":{"color":"black","dash":"dash","width":2},"mode":"lines","name":"Curtailment","showlegend":true,"x":["2024-01-10T00:00:00.000000000","2024-01-10T01:00:00.000000000","2024-01-10T02:00:00.000000000","2024-01-10T03:00:00.000000000","2024-01-10T04:00:00.000000000","2024-01-10T05:00:00.000000000","2024-01-10T06:00:00.000000000","2024-01-10T07:00:00.000000000","2024-01-10T08:00:00.000000000","2024-01-10T09:00:00.000000000","2024-01-10T10:00:00.000000000","2024-01-10T11:00:00.000000000","2024-01-10T12:00:00.000000000","2024-01-10T13:00:00.000000000","2024-01-10T14:00:00.000000000","2024-01-10T15:00:00.000000000","2024-01-10T16:00:00.000000000","2024-01-10T17:00:00.000000000","2024-01-10T18:00:00.000000000","2024-01-10T19:00:00.000000000","2024-01-10T20:00:00.000000000","2024-01-10T21:00:00.000000000","2024-01-10T22:00:00.000000000","2024-01-10T23:00:00.000000000","2024-01-11T00:00:00.000000000","2024-01-11T01:00:00.000000000","2024-01-11T02:00:00.000000000","2024-01-11T03:00:00.000000000","2024-01-11T04:00:00.000000000","2024-01-11T05:00:00.000000000","2024-01-11T06:00:00.000000000","2024-01-11T07:00:00.000000000","2024-01-11T08:00:00.000000000","2024-01-11T09:00:00.000000000","2024-01-11T10:00:00.000000000","2024-01-11T11:00:00.000000000","2024-01-11T12:00:00.000000000","2024-01-11T13:00:00.000000000","2024-01-11T14:00:00.000000000","2024-01-11T15:00:00.000000000","2024-01-11T16:00:00.000000000","2024-01-11T17:00:00.000000000","2024-01-11T18:00:00.000000000","2024-01-11T19:00:00.000000000","2024-01-11T20:00:00.000000000","2024-01-11T21:00:00.000000000","2024-01-11T22:00:00.000000000","2024-01-11T23:00:00.000000000","2024-01-12T00:00:00.000000000","2024-01-12T01:00:00.000000000","2024-01-12T02:00:00.000000000","2024-01-12T03:00:00.000000000","2024-01-12T04:00:00.000000000","2024-01-12T05:00:00.000000000","2024-01-12T06:00:00.000000000","2024-01-12T07:00:00.000000000","2024-01-12T08:00:00.000000000","2024-01-12T09:00:00.000000000","2024-01-12T10:00:00.000000000","2024-01-12T11:00:00.000000000","2024-01-12T12:00:00.000000000","2024-01-12T13:00:00.000000000","2024-01-12T14:00:00.000000000","2024-01-12T15:00:00.000000000","2024-01-12T16:00:00.000000000","2024-01-12T17:00:00.000000000","2024-01-12T18:00:00.000000000","2024-01-12T19:00:00.000000000","2024-01-12T20:00:00.000000000","2024-01-12T21:00:00.000000000","2024-01-12T22:00:00.000000000","2024-01-12T23:00:00.000000000","2024-01-13T00:00:00.000000000","2024-01-13T01:00:00.000000000","2024-01-13T02:00:00.000000000","2024-01-13T03:00:00.000000000","2024-01-13T04:00:00.000000000","2024-01-13T05:00:00.000000000","2024-01-13T06:00:00.000000000","2024-01-13T07:00:00.000000000","2024-01-13T08:00:00.000000000","2024-01-13T09:00:00.000000000","2024-01-13T10:00:00.000000000","2024-01-13T11:00:00.000000000","2024-01-13T12:00:00.000000000","2024-01-13T13:00:00.000000000","2024-01-13T14:00:00.000000000","2024-01-13T15:00:00.000000000","2024-01-13T16:00:00.000000000","2024-01-13T17:00:00.000000000","2024-01-13T18:00:00.000000000","2024-01-13T19:00:00.000000000","2024-01-13T20:00:00.000000000","2024-01-13T21:00:00.000000000","2024-01-13T22:00:00.000000000","2024-01-13T23:00:00.000000000","2024-01-14T00:00:00.000000000","2024-01-14T01:00:00.000000000","2024-01-14T02:00:00.000000000","2024-01-14T03:00:00.000000000","2024-01-14T04:00:00.000000000","2024-01-14T05:00:00.000000000","2024-01-14T06:00:00.000000000","2024-01-14T07:00:00.000000000","2024-01-14T08:00:00.000000000","2024-01-14T09:00:00.000000000","2024-01-14T10:00:00.000000000","2024-01-14T11:00:00.000000000","2024-01-14T12:00:00.000000000","2024-01-14T13:00:00.000000000","2024-01-14T14:00:00.000000000","2024-01-14T15:00:00.000000000","2024-01-14T16:00:00.000000000","2024-01-14T17:00:00.000000000","2024-01-14T18:00:00.000000000","2024-01-14T19:00:00.000000000","2024-01-14T20:00:00.000000000","2024-01-14T21:00:00.000000000","2024-01-14T22:00:00.000000000","2024-01-14T23:00:00.000000000"],"y":{"dtype":"f8","bdata":"AAAAAAAAAAAAAAAAAAAAAPyp8dJNYoA8AAAAAAAAAAAAAAAAAAAAAP7UeOkmMeI8iUFg5dAiXD0AAAAAAAAAAAaBlUOLrI09AAAAAAAAAAB56SYxCGyQPTVeukkMAls9eekmMQisDD0AAAAAAAAAALx0kxgEVos9AAAAAAAAAADTTWIQWDkkPY2XbhKDwHc9AAAAAAAAAAAEVg4tsh1bPUa28\u002f3UuPU8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMUgsHJokfA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAtvP91Hjpbj24HoXrUTiLPfyp8dJNYqA8\u002fKnx0k1ikDzn+6nx0k1gPVg5tMh2voc9VOOlm8SggT0AAAAAAAAAAAAAAAAAAAAAZmZmZmZmOj0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\u002fKnx0k1ioDwAAAAAAAAAAE5iEFg5tOc8AAAAAAAAAAAAAAAAAAAAAFyPwvUonJM9MQisHFpkhj2mm8QgsHKRPWZmZmZm5ow9AAAAAAAAAAD8qfHSTWKQPPyp8dJNYrA8Rrbz\u002fdRYkj0AAAAAAAAAAEoMAiuHFnA9wcqhRbbzRz0AAAAAAAAAAJqZmZmZWe88AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPyp8dJNYrA8AAAAAAAAAAAAAAAAAAAAAPyp8dJNYkA8ke18PzX+YD0xCKwcWmRIPQAAAAAAAAAA\u002fKnx0k1isDzhehSuR+F0Parx0k1ikII9uB6F61G4cj0K16NwPQpdPQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGy\u002fdJAYBVT2q8dJNYjBcPfp+arx0M\u002fQ8\u002fKnx0k1iwDwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPyp8dJNYkA85\u002fup8dItYT0bL90kBoFWPaRwPQrXY5A9AAAAAAAAAADn+6nx0k11PYPAyqFFdpU9K4cW2c73hz3wp8ZLN9mNPd+TeTgFBOk\u002fPQrXo3A9fD0AAAAAAAAAAAAAAAAAAAAAkxgEVg4tSz0AAAAAAAAAAMdLN4lBYNg8AAAAAAAAAAAAAAAAAAAAAPyp8dJNYsA8"},"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermap":[{"type":"scattermap","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"xaxis":{"gridcolor":"#DDDDDD","title":{"text":"Time"}},"yaxis":{"gridcolor":"#DDDDDD","title":{"text":"Power (GW)"}},"plot_bgcolor":"#F0FFFF","hoverlabel":{"font":{"size":12},"bgcolor":"white","bordercolor":"black"},"legend":{"x":1.02,"y":1,"bgcolor":"rgba(255,255,255,0.8)","bordercolor":"rgba(0,0,0,0.2)","borderwidth":1},"title":{"text":"Dispatch by Carrier: 2024-01-10 to 2024-01-14 for VIC1"},"hovermode":"x unified","width":800,"height":500},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('457d2ab2-b247-4f7c-9e00-43b836240311');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };            </script>        </div>
</div>
</div>
<p>Review the 2024 baseline model generator capacities.</p>
<div id="0093f267" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_generator_capacity_by_carrier(network):</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Plot total generator capacity by carrier for a given PyPSA network,</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">    excluding carriers with zero total capacity, and colour bars by carrier colour.</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1) sum and filter</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    capacity_by_carrier <span class="op">=</span> (</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>        network.generators</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>               .groupby(<span class="st">"carrier"</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>               .p_nom_opt</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>               .<span class="bu">sum</span>()</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>               .div(<span class="fl">1e3</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    capacity_by_carrier <span class="op">=</span> capacity_by_carrier[capacity_by_carrier <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2) get colors</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    colors <span class="op">=</span> [</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>        network.carriers.loc[c, <span class="st">'color'</span>]</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c <span class="kw">in</span> network.carriers.index <span class="kw">and</span> <span class="st">'color'</span> <span class="kw">in</span> network.carriers.columns</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="st">'gray'</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> c <span class="kw">in</span> capacity_by_carrier.index</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 3) create fig &amp; ax, set backgrounds</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fig.patch.set_facecolor('#F0FFFF')    # full-figure bg</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>               <span class="co"># axes bg</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 4) plot onto that ax</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    capacity_by_carrier.plot.barh(ax<span class="op">=</span>ax, color<span class="op">=</span>colors)</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 5) labels &amp; layout</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    ax.set_facecolor(<span class="st">'#F0FFFF'</span>)</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"GW"</span>)</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="st">"Total Generator Capacity by Carrier"</span>)</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>    fig.tight_layout()</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>plot_generator_capacity_by_carrier(n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="High-level_NEM_files/figure-html/cell-18-output-1.png" width="758" height="470" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>According to the AEMO’s ISP Step Change - all coal fired generation will be retired by 2038.</p>
<div style="text-align: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/step-change-coal-retirments.png" class="img-fluid figure-img"></p>
<figcaption>ISP Step Change Coal Retirements</figcaption>
</figure>
</div>
</div>
<p>Plot peak demand vs installed generation capacity per bus/region.</p>
<div id="52374ba5" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_peak_demand_vs_capacity(network, stack_carrier<span class="op">=</span><span class="va">False</span>, relative<span class="op">=</span><span class="va">False</span>, sort_by<span class="op">=</span><span class="st">"Max Demand"</span>):</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Plot peak demand vs installed generation capacity per bus, filtering out zero-capacity carriers.</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">    -----------</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">    network : pypsa.Network</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">        The PyPSA network object.</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">    stack_carrier : bool, default=False</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">        Whether to stack capacity by carrier or plot total capacity.</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">    relative : bool, default=False</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co">        If True, plot capacity as a percentage of peak demand.</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co">    sort_by : str, optional</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co">        Column to sort buses by on the x-axis. Options: "Max Demand", "Total Capacity", or None.</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- 1) Max demand per bus ---</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    max_demand <span class="op">=</span> network.loads_t.p_set.<span class="bu">max</span>()</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- 2) Capacity per bus and carrier ---</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    capacity_by_bus_carrier <span class="op">=</span> (</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>        network.generators.groupby([<span class="st">'bus'</span>, <span class="st">'carrier'</span>])</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>        .p_nom_opt.<span class="bu">sum</span>()</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>        .unstack(fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter out carriers with zero total capacity</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>    nonzero_carriers <span class="op">=</span> capacity_by_bus_carrier.columns[capacity_by_bus_carrier.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>) <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    capacity_by_bus_carrier <span class="op">=</span> capacity_by_bus_carrier[nonzero_carriers]</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>    total_capacity <span class="op">=</span> capacity_by_bus_carrier.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- 3) Combine DataFrame and filter out zero-demand &amp; zero-capacity buses ---</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.concat([max_demand.rename(<span class="st">"Max Demand"</span>),</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>                    total_capacity.rename(<span class="st">"Total Capacity"</span>)], axis<span class="op">=</span><span class="dv">1</span>).fillna(<span class="dv">0</span>)</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df[(df[<span class="st">"Max Demand"</span>] <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">|</span> (df[<span class="st">"Total Capacity"</span>] <span class="op">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- 4) Relative scaling if requested ---</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> relative:</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># avoid div-by-zero</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">"Max Demand"</span>] <span class="op">=</span> df[<span class="st">"Max Demand"</span>].replace(<span class="dv">0</span>, np.nan)</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>        relative_capacity <span class="op">=</span> capacity_by_bus_carrier.div(df[<span class="st">"Max Demand"</span>], axis<span class="op">=</span><span class="dv">0</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">"Total Capacity"</span>] <span class="op">=</span> df[<span class="st">"Total Capacity"</span>] <span class="op">/</span> df[<span class="st">"Max Demand"</span>] <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">"Max Demand"</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>        ylabel <span class="op">=</span> <span class="st">"Capacity as </span><span class="sc">% o</span><span class="st">f Peak Demand"</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># convert to GW</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>        df[[<span class="st">"Max Demand"</span>, <span class="st">"Total Capacity"</span>]] <span class="op">=</span> df[[<span class="st">"Max Demand"</span>, <span class="st">"Total Capacity"</span>]] <span class="op">/</span> <span class="fl">1e3</span></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>        relative_capacity <span class="op">=</span> capacity_by_bus_carrier <span class="op">/</span> <span class="fl">1e3</span></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>        ylabel <span class="op">=</span> <span class="st">"GW"</span></span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- 5) Sort if needed ---</span></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> sort_by <span class="kw">in</span> df.columns:</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> df.sort_values(by<span class="op">=</span>sort_by, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- 6) Plotting ---</span></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>    bar_width <span class="op">=</span> <span class="fl">0.35</span></span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>    bar_pos <span class="op">=</span> np.arange(<span class="bu">len</span>(df))</span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> stack_carrier:</span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a>        <span class="co"># stack each non-zero carrier</span></span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a>        bottom <span class="op">=</span> np.zeros(<span class="bu">len</span>(df))</span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> carrier <span class="kw">in</span> capacity_by_bus_carrier.columns:</span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>            vals <span class="op">=</span> relative_capacity[carrier].reindex(df.index).fillna(<span class="dv">0</span>).values</span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a>            color <span class="op">=</span> (network.carriers.loc[carrier, <span class="st">'color'</span>]</span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>                     <span class="cf">if</span> <span class="st">'color'</span> <span class="kw">in</span> network.carriers.columns <span class="kw">and</span> carrier <span class="kw">in</span> network.carriers.index</span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>                     <span class="cf">else</span> <span class="va">None</span>)</span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a>            ax.bar(bar_pos <span class="op">+</span> bar_width<span class="op">/</span><span class="dv">2</span>, vals, bar_width,</span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>                   bottom<span class="op">=</span>bottom, label<span class="op">=</span>carrier, color<span class="op">=</span>color)</span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>            bottom <span class="op">+=</span> vals</span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a>        <span class="co"># plot peak demand on left</span></span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>        ax.bar(bar_pos <span class="op">-</span> bar_width<span class="op">/</span><span class="dv">2</span>, df[<span class="st">"Max Demand"</span>], bar_width,</span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>               label<span class="op">=</span><span class="st">'Peak Demand'</span>, color<span class="op">=</span><span class="st">'gray'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>        ax.bar(bar_pos <span class="op">-</span> bar_width<span class="op">/</span><span class="dv">2</span>, df[<span class="st">"Max Demand"</span>], bar_width,</span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a>               label<span class="op">=</span><span class="st">'Peak Demand'</span>, color<span class="op">=</span><span class="st">'gray'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a>        ax.bar(bar_pos <span class="op">+</span> bar_width<span class="op">/</span><span class="dv">2</span>, df[<span class="st">"Total Capacity"</span>], bar_width,</span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a>               label<span class="op">=</span><span class="st">'Total Capacity'</span>, color<span class="op">=</span><span class="st">'tab:blue'</span>)</span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- 7) Labels and legend ---</span></span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a>    ax.set_xticks(bar_pos)</span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a>    ax.set_xticklabels(df.index, rotation<span class="op">=</span><span class="dv">0</span>, ha<span class="op">=</span><span class="st">'right'</span>, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(ylabel)</span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fig.patch.set_facecolor('#F0FFFF') </span></span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a>    ax.set_facecolor(<span class="st">'#F0FFFF'</span>)</span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"Region/Bus"</span>)</span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="st">"Peak Demand vs Generation Capacity per Region"</span> <span class="op">+</span> (<span class="st">" (Relative)"</span> <span class="cf">if</span> relative <span class="cf">else</span> <span class="st">""</span>))</span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a>    ax.grid(<span class="va">True</span>)</span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a>    <span class="co"># place legend outside</span></span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ax.legend(loc='upper left', bbox_to_anchor=(1.01, 1.0))</span></span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a>    ax.legend(loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-93"><a href="#cb21-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-94"><a href="#cb21-94" aria-hidden="true" tabindex="-1"></a>plot_peak_demand_vs_capacity(n, stack_carrier<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="High-level_NEM_files/figure-html/cell-19-output-1.png" width="758" height="470" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Plot total electricity demand vs generation per bus/region.</p>
<div id="cc8f57ca" class="cell" data-execution_count="19">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_total_demand_vs_generation(network, stack_carrier<span class="op">=</span><span class="va">False</span>, relative<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Plot total electricity demand vs generation per bus.</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co">    - network: PyPSA Network object</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">    - stack_carrier: If True, stack generation by carrier (color-coded)</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co">    - relative: If True, show generation as % of total demand (demand = 100%)</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total demand per bus in GWh</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    total_demand_per_bus <span class="op">=</span> network.loads_t.p_set.<span class="bu">sum</span>().div(<span class="fl">1e3</span>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    total_demand_per_bus.name <span class="op">=</span> <span class="st">"Total Demand"</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total generation per generator in GWh</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    gen_energy <span class="op">=</span> network.generators_t.p.<span class="bu">sum</span>().div(<span class="fl">1e3</span>)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    gen_info <span class="op">=</span> network.generators[[<span class="st">"bus"</span>, <span class="st">"carrier"</span>]]</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    gen_energy_by_carrier <span class="op">=</span> (</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>        gen_info.assign(energy<span class="op">=</span>gen_energy)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>        .groupby([<span class="st">"bus"</span>, <span class="st">"carrier"</span>])[<span class="st">"energy"</span>]</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">sum</span>()</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>        .unstack(fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    total_generation_per_bus <span class="op">=</span> gen_energy_by_carrier.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    total_generation_per_bus.name <span class="op">=</span> <span class="st">"Total Generation"</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Join and filter</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>    generation_vs_demand <span class="op">=</span> pd.concat([total_demand_per_bus, total_generation_per_bus], axis<span class="op">=</span><span class="dv">1</span>).fillna(<span class="dv">0</span>)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>    generation_vs_demand <span class="op">=</span> generation_vs_demand.loc[</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>        (generation_vs_demand[<span class="st">"Total Demand"</span>] <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">|</span> (generation_vs_demand[<span class="st">"Total Generation"</span>] <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> relative:</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>        generation_vs_demand[<span class="st">"Total Demand"</span>].replace(<span class="dv">0</span>, np.nan, inplace<span class="op">=</span><span class="va">True</span>)  <span class="co"># avoid div by 0</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>        generation_vs_demand.sort_values(by<span class="op">=</span><span class="st">"Total Demand"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>        relative_generation <span class="op">=</span> gen_energy_by_carrier.div(generation_vs_demand[<span class="st">"Total Demand"</span>], axis<span class="op">=</span><span class="dv">0</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>        generation_vs_demand[<span class="st">"Total Generation"</span>] <span class="op">=</span> (</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>            generation_vs_demand[<span class="st">"Total Generation"</span>] <span class="op">/</span> generation_vs_demand[<span class="st">"Total Demand"</span>] <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>        generation_vs_demand[<span class="st">"Total Demand"</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>        ylabel <span class="op">=</span> <span class="st">"Generation vs Demand (%)"</span></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>        relative_generation <span class="op">=</span> gen_energy_by_carrier</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>        ylabel <span class="op">=</span> <span class="st">"GWh"</span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sort by Total Demand (descending) and reindex    </span></span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>    generation_vs_demand <span class="op">=</span> generation_vs_demand.sort_values(by<span class="op">=</span><span class="st">"Total Demand"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>    relative_generation <span class="op">=</span> relative_generation.reindex(generation_vs_demand.index)</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot</span></span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>    bar_width <span class="op">=</span> <span class="fl">0.35</span></span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>    bar_positions <span class="op">=</span> np.arange(<span class="bu">len</span>(generation_vs_demand))</span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> stack_carrier:</span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a>        bottom <span class="op">=</span> np.zeros(<span class="bu">len</span>(generation_vs_demand))</span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>        carriers <span class="op">=</span> [</span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a>        c <span class="cf">for</span> c <span class="kw">in</span> relative_generation.columns</span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (c <span class="kw">in</span> network.carriers.index) <span class="kw">and</span> (relative_generation.loc[generation_vs_demand.index, c].<span class="bu">sum</span>() <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> carrier <span class="kw">in</span> carriers:</span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a>            values <span class="op">=</span> relative_generation.get(carrier, pd.Series(<span class="dv">0</span>, index<span class="op">=</span>generation_vs_demand.index))</span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a>            color <span class="op">=</span> network.carriers.loc[carrier, <span class="st">'color'</span>] <span class="cf">if</span> <span class="st">'color'</span> <span class="kw">in</span> network.carriers.columns <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a>            ax.bar(</span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a>                bar_positions <span class="op">+</span> bar_width <span class="op">/</span> <span class="dv">2</span>, values, bar_width,</span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="ss">f'Generation (</span><span class="sc">{</span>carrier<span class="sc">}</span><span class="ss">)'</span>, bottom<span class="op">=</span>bottom, color<span class="op">=</span>color</span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a>            bottom <span class="op">+=</span> values.values</span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a>        ax.bar(</span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a>            bar_positions <span class="op">-</span> bar_width <span class="op">/</span> <span class="dv">2</span>,</span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a>            generation_vs_demand[<span class="st">"Total Demand"</span>],</span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a>            bar_width,</span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">"Total Demand"</span>,</span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span><span class="st">"gray"</span>, alpha<span class="op">=</span><span class="fl">0.7</span></span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a>        ax.bar(</span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a>            bar_positions <span class="op">-</span> bar_width <span class="op">/</span> <span class="dv">2</span>,</span>
<span id="cb22-80"><a href="#cb22-80" aria-hidden="true" tabindex="-1"></a>            generation_vs_demand[<span class="st">"Total Demand"</span>],</span>
<span id="cb22-81"><a href="#cb22-81" aria-hidden="true" tabindex="-1"></a>            bar_width,</span>
<span id="cb22-82"><a href="#cb22-82" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">"Total Demand"</span>,</span>
<span id="cb22-83"><a href="#cb22-83" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span><span class="st">"gray"</span>, alpha<span class="op">=</span><span class="fl">0.7</span></span>
<span id="cb22-84"><a href="#cb22-84" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb22-85"><a href="#cb22-85" aria-hidden="true" tabindex="-1"></a>        ax.bar(</span>
<span id="cb22-86"><a href="#cb22-86" aria-hidden="true" tabindex="-1"></a>            bar_positions <span class="op">+</span> bar_width <span class="op">/</span> <span class="dv">2</span>,</span>
<span id="cb22-87"><a href="#cb22-87" aria-hidden="true" tabindex="-1"></a>            generation_vs_demand[<span class="st">"Total Generation"</span>],</span>
<span id="cb22-88"><a href="#cb22-88" aria-hidden="true" tabindex="-1"></a>            bar_width,</span>
<span id="cb22-89"><a href="#cb22-89" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">"Total Generation"</span>,</span>
<span id="cb22-90"><a href="#cb22-90" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span><span class="st">"tab:blue"</span></span>
<span id="cb22-91"><a href="#cb22-91" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb22-92"><a href="#cb22-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-93"><a href="#cb22-93" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-94"><a href="#cb22-94" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"Region/Bus"</span>)</span>
<span id="cb22-95"><a href="#cb22-95" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(ylabel)</span>
<span id="cb22-96"><a href="#cb22-96" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="st">"Total Demand vs Total Generation per Region"</span> <span class="op">+</span> (<span class="st">" (Relative)"</span> <span class="cf">if</span> relative <span class="cf">else</span> <span class="st">""</span>))</span>
<span id="cb22-97"><a href="#cb22-97" aria-hidden="true" tabindex="-1"></a>    ax.set_xticks(bar_positions)</span>
<span id="cb22-98"><a href="#cb22-98" aria-hidden="true" tabindex="-1"></a>    ax.set_xticklabels(generation_vs_demand.index, rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">"right"</span>)</span>
<span id="cb22-99"><a href="#cb22-99" aria-hidden="true" tabindex="-1"></a>    ax.set_facecolor(<span class="st">'#F0FFFF'</span>)</span>
<span id="cb22-100"><a href="#cb22-100" aria-hidden="true" tabindex="-1"></a>    ax.legend(loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb22-101"><a href="#cb22-101" aria-hidden="true" tabindex="-1"></a>    ax.grid(<span class="va">True</span>)</span>
<span id="cb22-102"><a href="#cb22-102" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb22-103"><a href="#cb22-103" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb22-104"><a href="#cb22-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-105"><a href="#cb22-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-106"><a href="#cb22-106" aria-hidden="true" tabindex="-1"></a>plot_total_demand_vs_generation(n, stack_carrier<span class="op">=</span><span class="va">True</span>, relative<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="High-level_NEM_files/figure-html/cell-20-output-1.png" width="758" height="470" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Load previously generated scenario data.</p>
<p>The <code>0_2024_baseline</code> scenario is the baseline and hence scale-up factor is 1. The 19 others are scaled up from the baseline model according to the Objective column.</p>
<p>Note: some of the scenarios have unserved energy, which tends to show up in NSW and VIC before other regions.</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Previously saved results generated from the generate_scenarios function in the Appendix</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: 0_2024_baseline is the baseline scenario and is equivalent to 'high-level_nem'.</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>df_results <span class="op">=</span> pd.read_csv(<span class="st">"results/scenarios/scenarios_summary_20250711_1007.csv"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Format in a more user-friendly format for HTML</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>results_tbl <span class="op">=</span> df_results.copy()</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> df_results.select_dtypes(include<span class="op">=</span>[<span class="st">'object'</span>]).columns:</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    results_tbl[col] <span class="op">=</span> results_tbl[col].<span class="bu">str</span>.replace(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>, <span class="st">'&lt;br&gt;'</span>, regex<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop to make more space.</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>results_tbl <span class="op">=</span> results_tbl.drop([<span class="st">'Unserved Energy (GWh)'</span>, <span class="st">'Battery Capacity (GW)'</span>, <span class="st">'Wind &amp; Solar Curtailment (GWh)'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the last column name</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>last_col <span class="op">=</span> results_tbl.columns[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply conditional formatting to the last column (which contains dictionary-like data)</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_last_column(val):</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pd.isna(val) <span class="kw">or</span> val <span class="op">==</span> <span class="st">''</span>:</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">str</span>(val)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> re</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use regex to find all key: value patterns</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    pattern <span class="op">=</span> <span class="vs">r'(\w+\d*): ([\d.-]+)'</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> replace_positive_values(match):</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>        key <span class="op">=</span> match.group(<span class="dv">1</span>)</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> match.group(<span class="dv">2</span>)</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>            num_val <span class="op">=</span> <span class="bu">float</span>(value)</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> num_val <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="ss">f'</span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">: &lt;span style="color: red; font-weight: bold;"&gt;</span><span class="sc">{</span>value<span class="sc">}</span><span class="ss">&lt;/span&gt;'</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="ss">f'</span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> (<span class="pp">ValueError</span>, <span class="pp">TypeError</span>):</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="ss">f'</span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Replace all matches with formatted versions</span></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> re.sub(pattern, replace_positive_values, <span class="bu">str</span>(val))</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply formatting to the last column</span></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>results_tbl[last_col] <span class="op">=</span> results_tbl[last_col].<span class="bu">apply</span>(format_last_column)</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>html_table <span class="op">=</span> results_tbl.to_html(escape<span class="op">=</span><span class="va">False</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Add container div with fixed height and scrolling</span></span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>html_table <span class="op">=</span> <span class="ss">f'''</span></span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;div style="height: 600px; overflow-y: auto; border: 1px solid #ddd;"&gt;</span></span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span>html_table<span class="sc">}</span></span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/div&gt;</span></span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a><span class="ss">'''</span></span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Style the table with sticky header</span></span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>html_table <span class="op">=</span> html_table.replace(<span class="st">'&lt;table'</span>, </span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a>    <span class="st">'&lt;table style="width: 100%; table-layout: fixed; font-size: 11px; font-family: monospace; border-collapse: collapse;"'</span>)</span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>html_table <span class="op">=</span> html_table.replace(<span class="st">'&lt;th'</span>, </span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">'&lt;th style="position: sticky; top: 0; background-color: #f5f5f5; border: 1px solid #ddd; padding: 8px; z-index: 10;"'</span>)</span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a>html_table <span class="op">=</span> html_table.replace(<span class="st">'&lt;td'</span>, </span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>    <span class="st">'&lt;td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;"'</span>)</span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(html_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div style="height: 600px; overflow-y: auto; border: 1px solid #ddd;">
<table style="width: 100%; table-layout: fixed; font-size: 11px; font-family: monospace; border-collapse: collapse;" class="dataframe table table-sm table-striped small">
<tbody><tr><th style="position: sticky; top: 0; background-color: #f5f5f5; border: 1px solid #ddd; padding: 8px; z-index: 10;" ead="">
</th></tr><tr>
<th style="position: sticky; top: 0; background-color: #f5f5f5; border: 1px solid #ddd; padding: 8px; z-index: 10;">
Scenario
</th>
<th style="position: sticky; top: 0; background-color: #f5f5f5; border: 1px solid #ddd; padding: 8px; z-index: 10;">
Objective
</th>
<th style="position: sticky; top: 0; background-color: #f5f5f5; border: 1px solid #ddd; padding: 8px; z-index: 10;">
Gas Generation (GWh)
</th>
<th style="position: sticky; top: 0; background-color: #f5f5f5; border: 1px solid #ddd; padding: 8px; z-index: 10;">
Generator Capacity (GW)
</th>
<th style="position: sticky; top: 0; background-color: #f5f5f5; border: 1px solid #ddd; padding: 8px; z-index: 10;">
Unserved by Region (GWh)
</th>
</tr>

</tbody><tbody>
<tr>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
0_2024_baseline
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1-Black Coal: x1.0<br>NSW1-Rooftop Solar: x1.0<br>NSW1-Solar: x1.0<br>NSW1-Wind: x1.0<br>NSW1-Battery: x1.0<br>QLD1-Black Coal: x1.0<br>QLD1-Rooftop Solar: x1.0<br>QLD1-Solar: x1.0<br>QLD1-Wind: x1.0<br>QLD1-Battery: x1.0<br>SA1-Rooftop Solar: x1.0<br>SA1-Solar: x1.0<br>SA1-Wind: x1.0<br>SA1-Battery: x1.0<br>VIC1-Brown Coal: x1.0<br>VIC1-Rooftop Solar: x1.0<br>VIC1-Solar: x1.0<br>VIC1-Wind: x1.0<br>VIC1-Battery: x1.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
1663.143
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
Black Coal: 16389.0<br>Brown Coal: 4690.0<br>Diesel: 1110.0<br>Gas: 12751.0<br>Hydro: 12808.0<br>Rooftop Solar: 15863.17<br>Solar: 15477.0<br>Wind: 16008.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1: 0.0<br>QLD1: 0.0<br>SA1: 0.0<br>TAS1: 0.0<br>VIC1: 0.0
</td>
</tr>
<tr>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
1_BalancedTransition
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1-Black Coal: x0.5<br>NSW1-Rooftop Solar: x1.2<br>NSW1-Solar: x1.2<br>NSW1-Wind: x1.25<br>NSW1-Battery: x1.5<br>QLD1-Black Coal: x0.5<br>QLD1-Rooftop Solar: x1.2<br>QLD1-Solar: x1.2<br>QLD1-Wind: x1.25<br>QLD1-Battery: x1.5<br>SA1-Rooftop Solar: x1.2<br>SA1-Solar: x1.2<br>SA1-Wind: x1.25<br>SA1-Battery: x1.5<br>TAS1-Wind: x1.25<br>TAS1-Battery: x1.5<br>VIC1-Brown Coal: x0.5<br>VIC1-Rooftop Solar: x1.2<br>VIC1-Solar: x1.2<br>VIC1-Wind: x1.25<br>VIC1-Battery: x1.5
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
6689.788
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
Black Coal: 8194.5<br>Brown Coal: 2345.0<br>Diesel: 1110.0<br>Gas: 12751.0<br>Hydro: 12808.0<br>Rooftop Solar: 18985.616<br>Solar: 18572.4<br>Wind: 20010.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1: 0.0<br>QLD1: 0.0<br>SA1: 0.0<br>TAS1: 0.0<br>VIC1: 0.0
</td>
</tr>
<tr>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
2_BalancedAggressiveTransition
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1-Black Coal: x0.25<br>NSW1-Rooftop Solar: x1.25<br>NSW1-Solar: x1.25<br>NSW1-Wind: x1.3<br>NSW1-Battery: x2.0<br>QLD1-Black Coal: x0.25<br>QLD1-Rooftop Solar: x1.25<br>QLD1-Solar: x1.25<br>QLD1-Wind: x1.3<br>QLD1-Battery: x2.0<br>SA1-Rooftop Solar: x1.25<br>SA1-Solar: x1.25<br>SA1-Wind: x1.3<br>SA1-Battery: x2.0<br>TAS1-Wind: x1.3<br>TAS1-Battery: x2.0<br>VIC1-Brown Coal: x0.25<br>VIC1-Rooftop Solar: x1.25<br>VIC1-Solar: x1.25<br>VIC1-Wind: x1.3<br>VIC1-Battery: x2.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
22599.405
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
Black Coal: 4097.25<br>Brown Coal: 1172.5<br>Diesel: 1110.0<br>Gas: 12751.0<br>Hydro: 12808.0<br>Rooftop Solar: 19766.228<br>Solar: 19346.25<br>Wind: 20810.4
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1: 0.0<br>QLD1: 0.0<br>SA1: 0.0<br>TAS1: 0.0<br>VIC1: 0.0
</td>
</tr>
<tr>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
3.0_VreStorageRampTransition
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1-Black Coal: x0.15<br>NSW1-Rooftop Solar: x1.3<br>NSW1-Solar: x1.3<br>NSW1-Wind: x1.5<br>NSW1-Battery: x4.0<br>QLD1-Black Coal: x0.15<br>QLD1-Rooftop Solar: x1.3<br>QLD1-Solar: x1.3<br>QLD1-Wind: x1.5<br>QLD1-Battery: x4.0<br>SA1-Rooftop Solar: x1.3<br>SA1-Solar: x1.3<br>SA1-Wind: x1.5<br>SA1-Battery: x4.0<br>TAS1-Wind: x1.5<br>TAS1-Battery: x4.0<br>VIC1-Brown Coal: x0.15<br>VIC1-Rooftop Solar: x1.3<br>VIC1-Solar: x1.3<br>VIC1-Wind: x1.5<br>VIC1-Battery: x4.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
21604.310
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
Black Coal: 2458.35<br>Brown Coal: 703.5<br>Diesel: 1110.0<br>Gas: 12751.0<br>Hydro: 12808.0<br>Rooftop Solar: 20546.839<br>Solar: 20120.1<br>Wind: 24012.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1: 0.0<br>QLD1: 0.0<br>SA1: 0.0<br>TAS1: 0.0<br>VIC1: 0.0
</td>
</tr>
<tr>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
3.1_VreStorageRampGasReduction
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1-Black Coal: x0.15<br>NSW1-Gas: x0.9<br>NSW1-Rooftop Solar: x1.3<br>NSW1-Solar: x1.3<br>NSW1-Wind: x1.5<br>NSW1-Battery: x4.0<br>QLD1-Black Coal: x0.15<br>QLD1-Gas: x0.9<br>QLD1-Rooftop Solar: x1.3<br>QLD1-Solar: x1.3<br>QLD1-Wind: x1.5<br>QLD1-Battery: x4.0<br>SA1-Gas: x0.9<br>SA1-Rooftop Solar: x1.3<br>SA1-Solar: x1.3<br>SA1-Wind: x1.5<br>SA1-Battery: x4.0<br>TAS1-Gas: x0.9<br>TAS1-Wind: x1.5<br>TAS1-Battery: x4.0<br>VIC1-Brown Coal: x0.15<br>VIC1-Gas: x0.9<br>VIC1-Rooftop Solar: x1.3<br>VIC1-Solar: x1.3<br>VIC1-Wind: x1.5<br>VIC1-Battery: x4.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
21503.251
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
Black Coal: 2458.35<br>Brown Coal: 703.5<br>Diesel: 1110.0<br>Gas: 11475.9<br>Hydro: 12808.0<br>Rooftop Solar: 20546.839<br>Solar: 20120.1<br>Wind: 24012.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1: 0.0<br>QLD1: 0.0<br>SA1: 0.0<br>TAS1: 0.0<br>VIC1: <span style="color: red; font-weight: bold;">7.278</span>
</td>
</tr>
<tr>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
3.1.1_VreStorageRampGasReduction
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1-Black Coal: x0.15<br>NSW1-Gas: x0.9<br>NSW1-Rooftop Solar: x1.3<br>NSW1-Solar: x1.3<br>NSW1-Wind: x1.5<br>NSW1-Battery: x5.0<br>QLD1-Black Coal: x0.15<br>QLD1-Gas: x0.9<br>QLD1-Rooftop Solar: x1.3<br>QLD1-Solar: x1.3<br>QLD1-Wind: x1.5<br>QLD1-Battery: x4.0<br>SA1-Gas: x0.9<br>SA1-Rooftop Solar: x1.3<br>SA1-Solar: x1.3<br>SA1-Wind: x1.5<br>SA1-Battery: x4.0<br>TAS1-Gas: x0.9<br>TAS1-Wind: x1.5<br>TAS1-Battery: x4.0<br>VIC1-Brown Coal: x0.15<br>VIC1-Gas: x0.9<br>VIC1-Rooftop Solar: x1.3<br>VIC1-Solar: x1.3<br>VIC1-Wind: x1.5<br>VIC1-Battery: x5.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
20846.689
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
Black Coal: 2458.35<br>Brown Coal: 703.5<br>Diesel: 1110.0<br>Gas: 11475.9<br>Hydro: 12808.0<br>Rooftop Solar: 20546.839<br>Solar: 20120.1<br>Wind: 24012.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1: 0.0<br>QLD1: 0.0<br>SA1: 0.0<br>TAS1: 0.0<br>VIC1: 0.0
</td>
</tr>
<tr>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
3.1.2_VreStorageRampGasReduction
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1-Black Coal: x0.15<br>NSW1-Gas: x0.9<br>NSW1-Rooftop Solar: x1.3<br>NSW1-Solar: x1.3<br>NSW1-Wind: x1.5<br>NSW1-Battery: x6.0<br>QLD1-Black Coal: x0.15<br>QLD1-Gas: x0.9<br>QLD1-Rooftop Solar: x1.3<br>QLD1-Solar: x1.3<br>QLD1-Wind: x1.5<br>QLD1-Battery: x4.0<br>SA1-Gas: x0.9<br>SA1-Rooftop Solar: x1.3<br>SA1-Solar: x1.3<br>SA1-Wind: x1.5<br>SA1-Battery: x4.0<br>TAS1-Gas: x0.9<br>TAS1-Wind: x1.5<br>TAS1-Battery: x4.0<br>VIC1-Brown Coal: x0.15<br>VIC1-Gas: x0.9<br>VIC1-Rooftop Solar: x1.3<br>VIC1-Solar: x1.3<br>VIC1-Wind: x1.5<br>VIC1-Battery: x6.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
20479.922
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
Black Coal: 2458.35<br>Brown Coal: 703.5<br>Diesel: 1110.0<br>Gas: 11475.9<br>Hydro: 12808.0<br>Rooftop Solar: 20546.839<br>Solar: 20120.1<br>Wind: 24012.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1: 0.0<br>QLD1: 0.0<br>SA1: 0.0<br>TAS1: 0.0<br>VIC1: 0.0
</td>
</tr>
<tr>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
3.2_VreStorageRampGasReduction
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1-Black Coal: x0.15<br>NSW1-Gas: x0.75<br>NSW1-Rooftop Solar: x1.3<br>NSW1-Solar: x1.3<br>NSW1-Wind: x1.5<br>NSW1-Battery: x4.0<br>QLD1-Black Coal: x0.15<br>QLD1-Gas: x0.75<br>QLD1-Rooftop Solar: x1.3<br>QLD1-Solar: x1.3<br>QLD1-Wind: x1.5<br>QLD1-Battery: x4.0<br>SA1-Gas: x0.75<br>SA1-Rooftop Solar: x1.3<br>SA1-Solar: x1.3<br>SA1-Wind: x1.5<br>SA1-Battery: x4.0<br>TAS1-Gas: x0.75<br>TAS1-Wind: x1.5<br>TAS1-Battery: x4.0<br>VIC1-Brown Coal: x0.15<br>VIC1-Gas: x0.75<br>VIC1-Rooftop Solar: x1.3<br>VIC1-Solar: x1.3<br>VIC1-Wind: x1.5<br>VIC1-Battery: x4.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
21117.562
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
Black Coal: 2458.35<br>Brown Coal: 703.5<br>Diesel: 1110.0<br>Gas: 9563.25<br>Hydro: 12808.0<br>Rooftop Solar: 20546.839<br>Solar: 20120.1<br>Wind: 24012.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1: <span style="color: red; font-weight: bold;">43.09</span><br>QLD1: <span style="color: red; font-weight: bold;">5.145</span><br>SA1: 0.0<br>TAS1: <span style="color: red; font-weight: bold;">0.68</span><br>VIC1: <span style="color: red; font-weight: bold;">164.879</span>
</td>
</tr>
<tr>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
3.3_VreStorageRampGasReduction
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1-Black Coal: x0.15<br>NSW1-Gas: x0.5<br>NSW1-Rooftop Solar: x1.3<br>NSW1-Solar: x1.3<br>NSW1-Wind: x1.5<br>NSW1-Battery: x4.0<br>QLD1-Black Coal: x0.15<br>QLD1-Gas: x0.5<br>QLD1-Rooftop Solar: x1.3<br>QLD1-Solar: x1.3<br>QLD1-Wind: x1.5<br>QLD1-Battery: x4.0<br>SA1-Gas: x0.5<br>SA1-Rooftop Solar: x1.3<br>SA1-Solar: x1.3<br>SA1-Wind: x1.5<br>SA1-Battery: x4.0<br>TAS1-Gas: x0.5<br>TAS1-Wind: x1.5<br>TAS1-Battery: x4.0<br>VIC1-Brown Coal: x0.15<br>VIC1-Gas: x0.5<br>VIC1-Rooftop Solar: x1.3<br>VIC1-Solar: x1.3<br>VIC1-Wind: x1.5<br>VIC1-Battery: x4.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
18742.999
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
Black Coal: 2458.35<br>Brown Coal: 703.5<br>Diesel: 1110.0<br>Gas: 6375.5<br>Hydro: 12808.0<br>Rooftop Solar: 20546.839<br>Solar: 20120.1<br>Wind: 24012.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1: <span style="color: red; font-weight: bold;">979.421</span><br>QLD1: <span style="color: red; font-weight: bold;">100.497</span><br>SA1: <span style="color: red; font-weight: bold;">16.113</span><br>TAS1: <span style="color: red; font-weight: bold;">21.427</span><br>VIC1: <span style="color: red; font-weight: bold;">614.799</span>
</td>
</tr>
<tr>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
4_4xVreTransitionZeroCoal
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1-Black Coal: x0.0<br>NSW1-Rooftop Solar: x2.0<br>NSW1-Solar: x4.0<br>NSW1-Wind: x4.0<br>NSW1-Battery: x4.0<br>QLD1-Black Coal: x0.0<br>QLD1-Rooftop Solar: x2.0<br>QLD1-Solar: x4.0<br>QLD1-Wind: x4.0<br>QLD1-Battery: x4.0<br>SA1-Rooftop Solar: x2.0<br>SA1-Solar: x4.0<br>SA1-Wind: x4.0<br>SA1-Battery: x4.0<br>TAS1-Battery: x4.0<br>TAS1-Wind: x4.0<br>VIC1-Brown Coal: x0.0<br>VIC1-Rooftop Solar: x2.0<br>VIC1-Solar: x4.0<br>VIC1-Wind: x4.0<br>VIC1-Battery: x4.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
5316.806
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
Black Coal: 0.0<br>Brown Coal: 0.0<br>Diesel: 1110.0<br>Gas: 12751.0<br>Hydro: 12808.0<br>Rooftop Solar: 31475.4<br>Solar: 61908.0<br>Wind: 64032.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1: 0.0<br>QLD1: 0.0<br>SA1: 0.0<br>TAS1: 0.0<br>VIC1: 0.0
</td>
</tr>
<tr>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
5_5xVreTransitionZeroCoal
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1-Black Coal: x0.0<br>NSW1-Rooftop Solar: x2.0<br>NSW1-Solar: x5.0<br>NSW1-Wind: x5.0<br>NSW1-Battery: x4.0<br>QLD1-Black Coal: x0.0<br>QLD1-Rooftop Solar: x2.0<br>QLD1-Solar: x5.0<br>QLD1-Wind: x5.0<br>QLD1-Battery: x4.0<br>SA1-Rooftop Solar: x2.0<br>SA1-Solar: x5.0<br>SA1-Wind: x5.0<br>SA1-Battery: x4.0<br>TAS1-Battery: x4.0<br>TAS1-Wind: x5.0<br>VIC1-Brown Coal: x0.0<br>VIC1-Rooftop Solar: x2.0<br>VIC1-Solar: x5.0<br>VIC1-Wind: x5.0<br>VIC1-Battery: x4.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
3717.532
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
Black Coal: 0.0<br>Brown Coal: 0.0<br>Diesel: 1110.0<br>Gas: 12751.0<br>Hydro: 12808.0<br>Rooftop Solar: 31475.4<br>Solar: 77385.0<br>Wind: 80040.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1: 0.0<br>QLD1: 0.0<br>SA1: 0.0<br>TAS1: 0.0<br>VIC1: 0.0
</td>
</tr>
<tr>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
6.0_6xVreTransitionZeroCoal
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1-Black Coal: x0.0<br>NSW1-Rooftop Solar: x2.0<br>NSW1-Solar: x6.0<br>NSW1-Wind: x6.0<br>NSW1-Battery: x4.0<br>QLD1-Black Coal: x0.0<br>QLD1-Rooftop Solar: x2.0<br>QLD1-Solar: x6.0<br>QLD1-Wind: x6.0<br>QLD1-Battery: x4.0<br>SA1-Rooftop Solar: x2.0<br>SA1-Solar: x6.0<br>SA1-Wind: x6.0<br>SA1-Battery: x4.0<br>TAS1-Battery: x4.0<br>TAS1-Wind: x6.0<br>VIC1-Brown Coal: x0.0<br>VIC1-Rooftop Solar: x2.0<br>VIC1-Solar: x6.0<br>VIC1-Wind: x6.0<br>VIC1-Battery: x4.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
2913.805
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
Black Coal: 0.0<br>Brown Coal: 0.0<br>Diesel: 1110.0<br>Gas: 12751.0<br>Hydro: 12808.0<br>Rooftop Solar: 31475.4<br>Solar: 92862.0<br>Wind: 96048.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1: 0.0<br>QLD1: 0.0<br>SA1: 0.0<br>TAS1: 0.0<br>VIC1: 0.0
</td>
</tr>
<tr>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
6.1_6xVreTransitionZeroCoal
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1-Black Coal: x0.0<br>NSW1-Gas: x0.9<br>NSW1-Rooftop Solar: x2.0<br>NSW1-Solar: x6.0<br>NSW1-Wind: x6.0<br>NSW1-Battery: x4.0<br>QLD1-Black Coal: x0.0<br>QLD1-Gas: x0.9<br>QLD1-Rooftop Solar: x2.0<br>QLD1-Solar: x6.0<br>QLD1-Wind: x6.0<br>QLD1-Battery: x4.0<br>SA1-Gas: x0.9<br>SA1-Rooftop Solar: x2.0<br>SA1-Solar: x6.0<br>SA1-Wind: x6.0<br>SA1-Battery: x4.0<br>TAS1-Gas: x0.9<br>TAS1-Wind: x6.0<br>TAS1-Battery: x4.0<br>VIC1-Brown Coal: x0.0<br>VIC1-Gas: x0.9<br>VIC1-Rooftop Solar: x2.0<br>VIC1-Solar: x6.0<br>VIC1-Wind: x6.0<br>VIC1-Battery: x4.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
2754.574
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
Black Coal: 0.0<br>Brown Coal: 0.0<br>Diesel: 1110.0<br>Gas: 11475.9<br>Hydro: 12808.0<br>Rooftop Solar: 31475.4<br>Solar: 92862.0<br>Wind: 96048.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1: 0.0<br>QLD1: 0.0<br>SA1: 0.0<br>TAS1: 0.0<br>VIC1: 0.0
</td>
</tr>
<tr>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
6.2_6xVreTransitionZeroCoal
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1-Black Coal: x0.0<br>NSW1-Gas: x0.75<br>NSW1-Rooftop Solar: x2.0<br>NSW1-Solar: x6.0<br>NSW1-Wind: x6.0<br>NSW1-Battery: x4.0<br>QLD1-Black Coal: x0.0<br>QLD1-Gas: x0.75<br>QLD1-Rooftop Solar: x2.0<br>QLD1-Solar: x6.0<br>QLD1-Wind: x6.0<br>QLD1-Battery: x4.0<br>SA1-Gas: x0.75<br>SA1-Rooftop Solar: x2.0<br>SA1-Solar: x6.0<br>SA1-Wind: x6.0<br>SA1-Battery: x4.0<br>TAS1-Gas: x0.75<br>TAS1-Wind: x6.0<br>TAS1-Battery: x4.0<br>VIC1-Brown Coal: x0.0<br>VIC1-Gas: x0.75<br>VIC1-Rooftop Solar: x2.0<br>VIC1-Solar: x6.0<br>VIC1-Wind: x6.0<br>VIC1-Battery: x4.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
2495.138
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
Black Coal: 0.0<br>Brown Coal: 0.0<br>Diesel: 1110.0<br>Gas: 9563.25<br>Hydro: 12808.0<br>Rooftop Solar: 31475.4<br>Solar: 92862.0<br>Wind: 96048.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1: <span style="color: red; font-weight: bold;">2.726</span><br>QLD1: 0.0<br>SA1: 0.0<br>TAS1: 0.0<br>VIC1: <span style="color: red; font-weight: bold;">6.625</span>
</td>
</tr>
<tr>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
6.3_6xVreTransitionZeroCoal
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1-Black Coal: x0.0<br>NSW1-Gas: x0.5<br>NSW1-Rooftop Solar: x2.0<br>NSW1-Solar: x6.0<br>NSW1-Wind: x6.0<br>NSW1-Battery: x4.0<br>QLD1-Black Coal: x0.0<br>QLD1-Gas: x0.5<br>QLD1-Rooftop Solar: x2.0<br>QLD1-Solar: x6.0<br>QLD1-Wind: x6.0<br>QLD1-Battery: x4.0<br>SA1-Gas: x0.5<br>SA1-Rooftop Solar: x2.0<br>SA1-Solar: x6.0<br>SA1-Wind: x6.0<br>SA1-Battery: x4.0<br>TAS1-Gas: x0.5<br>TAS1-Wind: x6.0<br>TAS1-Battery: x4.0<br>VIC1-Brown Coal: x0.0<br>VIC1-Gas: x0.5<br>VIC1-Rooftop Solar: x2.0<br>VIC1-Solar: x6.0<br>VIC1-Wind: x6.0<br>VIC1-Battery: x4.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
1977.328
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
Black Coal: 0.0<br>Brown Coal: 0.0<br>Diesel: 1110.0<br>Gas: 6375.5<br>Hydro: 12808.0<br>Rooftop Solar: 31475.4<br>Solar: 92862.0<br>Wind: 96048.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1: <span style="color: red; font-weight: bold;">27.149</span><br>QLD1: <span style="color: red; font-weight: bold;">15.33</span><br>SA1: <span style="color: red; font-weight: bold;">1.088</span><br>TAS1: 0.0<br>VIC1: <span style="color: red; font-weight: bold;">48.212</span>
</td>
</tr>
<tr>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
7.0_6xVre4xRoofZeroCoal
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1-Black Coal: x0.0<br>NSW1-Gas: x0.5<br>NSW1-Rooftop Solar: x4.0<br>NSW1-Solar: x6.0<br>NSW1-Wind: x6.0<br>NSW1-Battery: x4.0<br>QLD1-Black Coal: x0.0<br>QLD1-Gas: x0.5<br>QLD1-Rooftop Solar: x4.0<br>QLD1-Solar: x6.0<br>QLD1-Wind: x6.0<br>QLD1-Battery: x4.0<br>SA1-Gas: x0.5<br>SA1-Rooftop Solar: x4.0<br>SA1-Solar: x6.0<br>SA1-Wind: x6.0<br>SA1-Battery: x4.0<br>TAS1-Gas: x0.5<br>TAS1-Wind: x6.0<br>TAS1-Battery: x4.0<br>VIC1-Gas: x0.5<br>VIC1-Brown Coal: x0.0<br>VIC1-Rooftop Solar: x4.0<br>VIC1-Solar: x6.0<br>VIC1-Wind: x6.0<br>VIC1-Battery: x4.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
1934.527
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
Black Coal: 0.0<br>Brown Coal: 0.0<br>Diesel: 1110.0<br>Gas: 6375.5<br>Hydro: 12808.0<br>Rooftop Solar: 62699.86<br>Solar: 92862.0<br>Wind: 96048.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1: <span style="color: red; font-weight: bold;">28.086</span><br>QLD1: <span style="color: red; font-weight: bold;">14.708</span><br>SA1: <span style="color: red; font-weight: bold;">0.904</span><br>TAS1: 0.0<br>VIC1: <span style="color: red; font-weight: bold;">42.377</span>
</td>
</tr>
<tr>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
8.0_6xVre&amp;BatteryZeroCoal
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1-Black Coal: x0.0<br>NSW1-Gas: x1.0<br>NSW1-Rooftop Solar: x6.0<br>NSW1-Solar: x6.0<br>NSW1-Wind: x6.0<br>NSW1-Battery: x6.0<br>QLD1-Black Coal: x0.0<br>QLD1-Gas: x1.0<br>QLD1-Rooftop Solar: x6.0<br>QLD1-Solar: x6.0<br>QLD1-Wind: x6.0<br>QLD1-Battery: x6.0<br>SA1-Gas: x1.0<br>SA1-Rooftop Solar: x6.0<br>SA1-Solar: x6.0<br>SA1-Wind: x6.0<br>SA1-Battery: x6.0<br>TAS1-Gas: x1.0<br>TAS1-Wind: x6.0<br>TAS1-Battery: x6.0<br>VIC1-Gas: x1.0<br>VIC1-Brown Coal: x0.0<br>VIC1-Rooftop Solar: x6.0<br>VIC1-Solar: x6.0<br>VIC1-Wind: x6.0<br>VIC1-Battery: x6.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
2134.219
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
Black Coal: 0.0<br>Brown Coal: 0.0<br>Diesel: 1110.0<br>Gas: 12751.0<br>Hydro: 12808.0<br>Rooftop Solar: 93924.32<br>Solar: 92862.0<br>Wind: 96048.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1: 0.0<br>QLD1: 0.0<br>SA1: 0.0<br>TAS1: 0.0<br>VIC1: 0.0
</td>
</tr>
<tr>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
8.1_6xVre&amp;BatteryZeroCoal
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1-Black Coal: x0.0<br>NSW1-Gas: x0.75<br>NSW1-Rooftop Solar: x6.0<br>NSW1-Solar: x6.0<br>NSW1-Wind: x6.0<br>NSW1-Battery: x6.0<br>QLD1-Black Coal: x0.0<br>QLD1-Gas: x0.75<br>QLD1-Rooftop Solar: x6.0<br>QLD1-Solar: x6.0<br>QLD1-Wind: x6.0<br>QLD1-Battery: x6.0<br>SA1-Gas: x0.75<br>SA1-Rooftop Solar: x6.0<br>SA1-Solar: x6.0<br>SA1-Wind: x6.0<br>SA1-Battery: x6.0<br>TAS1-Gas: x0.75<br>TAS1-Wind: x6.0<br>TAS1-Battery: x6.0<br>VIC1-Gas: x0.75<br>VIC1-Brown Coal: x0.0<br>VIC1-Rooftop Solar: x6.0<br>VIC1-Solar: x6.0<br>VIC1-Wind: x6.0<br>VIC1-Battery: x6.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
1726.485
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
Black Coal: 0.0<br>Brown Coal: 0.0<br>Diesel: 1110.0<br>Gas: 9563.25<br>Hydro: 12808.0<br>Rooftop Solar: 93924.32<br>Solar: 92862.0<br>Wind: 96048.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1: 0.0<br>QLD1: 0.0<br>SA1: 0.0<br>TAS1: 0.0<br>VIC1: 0.0
</td>
</tr>
<tr>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
8.2_6xVre&amp;BatteryZeroCoal
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1-Black Coal: x0.0<br>NSW1-Gas: x0.5<br>NSW1-Rooftop Solar: x6.0<br>NSW1-Solar: x6.0<br>NSW1-Wind: x6.0<br>NSW1-Battery: x6.0<br>QLD1-Black Coal: x0.0<br>QLD1-Gas: x0.5<br>QLD1-Rooftop Solar: x6.0<br>QLD1-Solar: x6.0<br>QLD1-Wind: x6.0<br>QLD1-Battery: x6.0<br>SA1-Gas: x0.5<br>SA1-Rooftop Solar: x6.0<br>SA1-Solar: x6.0<br>SA1-Wind: x6.0<br>SA1-Battery: x6.0<br>TAS1-Gas: x0.5<br>TAS1-Wind: x6.0<br>TAS1-Battery: x6.0<br>VIC1-Gas: x0.5<br>VIC1-Brown Coal: x0.0<br>VIC1-Rooftop Solar: x6.0<br>VIC1-Solar: x6.0<br>VIC1-Wind: x6.0<br>VIC1-Battery: x6.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
1301.593
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
Black Coal: 0.0<br>Brown Coal: 0.0<br>Diesel: 1110.0<br>Gas: 6375.5<br>Hydro: 12808.0<br>Rooftop Solar: 93924.32<br>Solar: 92862.0<br>Wind: 96048.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1: <span style="color: red; font-weight: bold;">2.917</span><br>QLD1: 0.0<br>SA1: 0.0<br>TAS1: 0.0<br>VIC1: <span style="color: red; font-weight: bold;">5.642</span>
</td>
</tr>
<tr>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
8.2.1_6xVreCurtailReview
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1-Black Coal: x0.0<br>NSW1-Gas: x0.5<br>NSW1-Rooftop Solar: x3.0<br>NSW1-Solar: x3.0<br>NSW1-Wind: x6.0<br>NSW1-Battery: x8.0<br>QLD1-Black Coal: x0.0<br>QLD1-Gas: x0.5<br>QLD1-Rooftop Solar: x3.0<br>QLD1-Solar: x3.0<br>QLD1-Wind: x6.0<br>QLD1-Battery: x6.0<br>SA1-Gas: x0.5<br>SA1-Rooftop Solar: x2.0<br>SA1-Solar: x3.0<br>SA1-Wind: x2.0<br>SA1-Battery: x6.0<br>TAS1-Gas: x0.5<br>TAS1-Rooftop Solar: x3.0<br>TAS1-Wind: x5.0<br>TAS1-Battery: x8.0<br>VIC1-Gas: x0.5<br>VIC1-Brown Coal: x0.0<br>VIC1-Rooftop Solar: x4.0<br>VIC1-Solar: x4.0<br>VIC1-Wind: x4.0<br>VIC1-Battery: x8.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
1868.642
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
Black Coal: 0.0<br>Brown Coal: 0.0<br>Diesel: 1110.0<br>Gas: 6375.5<br>Hydro: 12808.0<br>Rooftop Solar: 49367.01<br>Solar: 48465.0<br>Wind: 72321.0
</td>
<td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;">
NSW1: 0.0<br>QLD1: 0.0<br>SA1: 0.0<br>TAS1: 0.0<br>VIC1: 0.0
</td>
</tr>
</tbody>
</table>
</div>
<p>In the <code>0_2024_baseline</code> scenario above, Gas Generation (GWh) is much lower than in reality because I’ve set the marginal cost of gas higher than coal and there are no other influencing constraints such as carbon emissions. PyPSA is solving based on least-cost optimisation of power plant and storage dispatch within network constraints. This is much simpler than in real life, which involves a bid stack and many more constraints.</p>
<p>It is worth adding a comparison column to compare more realistic gas generation from <a href="https://explore.openelectricity.org.au/energy/nem/?range=1y&amp;interval=1w&amp;view=discrete-time&amp;group=Simplified">Open Electricity</a> to the high VRE scenario that I’m interested in: <code>8.2.1_6xVreCurtailReview</code> . This scenario has zero coal generation and an 83% reduction in gas generation.</p>
<p>The <code>8.2.1_6xVreCurtailReview</code> is one of the more plausible scenarios found by scaling up VRE and storage from the baseline model using a csv import file with different scale-up factors.</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Filter scenario</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>df_filt <span class="op">=</span> results_tbl[results_tbl[<span class="st">"Scenario"</span>] <span class="op">==</span> <span class="st">"8.2.1_6xVreCurtailReview"</span>].copy()</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Compute the % change vs 10,919 GWh. Source: Open Electricity Data (this value will change regularly because it is a rolling 12-month period)</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>base <span class="op">=</span> <span class="dv">10919</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>df_filt[<span class="st">"Gas Δ% vs 10919GWh"</span>] <span class="op">=</span> (df_filt[<span class="st">"Gas Generation (GWh)"</span>] <span class="op">-</span> base) <span class="op">/</span> base <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Insert the new column right after “Gas Generation (GWh)”</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>col_idx <span class="op">=</span> df_filt.columns.get_loc(<span class="st">"Gas Generation (GWh)"</span>)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>df_filt.insert(col_idx<span class="op">+</span><span class="dv">1</span>, <span class="st">"Gas Δ% vs 10919GWh"</span>, df_filt.pop(<span class="st">"Gas Δ% vs 10919GWh"</span>))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>html_subset_table <span class="op">=</span> df_filt.iloc[:, :<span class="dv">5</span>].to_html(escape<span class="op">=</span><span class="va">False</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>html_subset_table <span class="op">=</span> html_subset_table.replace(<span class="st">'&lt;table'</span>, </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'&lt;table style="width: 100%; table-layout: fixed; font-size: 11px; font-family: monospace;"'</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>html_subset_table <span class="op">=</span> html_subset_table.replace(<span class="st">'&lt;td'</span>, </span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'&lt;td style="min-width: 250px; word-wrap: break-word; padding: 4px;"'</span>)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>html_subset_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<table style="width: 100%; table-layout: fixed; font-size: 11px; font-family: monospace;" class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Scenario
</th>

<th>
Objective
</th>

<th>
Gas Generation (GWh)
</th>

<th>
Gas Δ% vs 10919GWh
</th>

<th>
Generator Capacity (GW)
</th>

</tr>

</thead>

<tbody>

<tr>

<td style="min-width: 250px; word-wrap: break-word; padding: 4px;">
8.2.1_6xVreCurtailReview
</td>

<td style="min-width: 250px; word-wrap: break-word; padding: 4px;">
NSW1-Black Coal: x0.0<br>NSW1-Gas: x0.5<br>NSW1-Rooftop Solar: x3.0<br>NSW1-Solar: x3.0<br>NSW1-Wind: x6.0<br>NSW1-Battery: x8.0<br>QLD1-Black Coal: x0.0<br>QLD1-Gas: x0.5<br>QLD1-Rooftop Solar: x3.0<br>QLD1-Solar: x3.0<br>QLD1-Wind: x6.0<br>QLD1-Battery: x6.0<br>SA1-Gas: x0.5<br>SA1-Rooftop Solar: x2.0<br>SA1-Solar: x3.0<br>SA1-Wind: x2.0<br>SA1-Battery: x6.0<br>TAS1-Gas: x0.5<br>TAS1-Rooftop Solar: x3.0<br>TAS1-Wind: x5.0<br>TAS1-Battery: x8.0<br>VIC1-Gas: x0.5<br>VIC1-Brown Coal: x0.0<br>VIC1-Rooftop Solar: x4.0<br>VIC1-Solar: x4.0<br>VIC1-Wind: x4.0<br>VIC1-Battery: x8.0
</td>

<td style="min-width: 250px; word-wrap: break-word; padding: 4px;">
1868.642
</td>

<td style="min-width: 250px; word-wrap: break-word; padding: 4px;">
-82.886327
</td>

<td style="min-width: 250px; word-wrap: break-word; padding: 4px;">
Black Coal: 0.0<br>Brown Coal: 0.0<br>Diesel: 1110.0<br>Gas: 6375.5<br>Hydro: 12808.0<br>Rooftop Solar: 49367.01<br>Solar: 48465.0<br>Wind: 72321.0
</td>

</tr>

</tbody>

</table>
<p>Load the <code>8.2.1_6xVreCurtailReview</code> network.</p>
<div id="268b1888" class="cell" data-execution_count="22">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the network for the specific scenario</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> pypsa.Network(<span class="st">"results/scenarios/scenario_8.2.1_6xVreCurtailReview.nc"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Metadata to provide as arguments to the plot_dispatch() function.</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>scenario <span class="op">=</span> <span class="st">"8.2.1_6xVreCurtailReview"</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>objective_text <span class="op">=</span> df_results.loc[df_results[<span class="st">"Scenario"</span>] <span class="op">==</span> scenario, <span class="st">"Objective"</span>].values[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>INFO:pypsa.io:Imported network scenario_8.2.1_6xVreCurtailReview.nc has buses, carriers, generators, lines, links, loads, storage_units</code></pre>
</div>
</div>
<div id="bb0b6974" class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>plot_dispatch(n, time<span class="op">=</span><span class="st">"2024-05-18"</span>, days<span class="op">=</span><span class="dv">10</span>, regions<span class="op">=</span>[<span class="st">"VIC1"</span>], show_imports<span class="op">=</span><span class="va">True</span>, scenario_name<span class="op">=</span>scenario, scenario_objective<span class="op">=</span>objective_text, interactive<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="High-level_NEM_files/figure-html/cell-24-output-1.png" width="795" height="614" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In the above snapshot there is minimal gas dispatch due to high levels of renewable energy. The trade-off is curtailment, the middle of the day on the 19th of May is a good example, where almost all solar is curtailed.</p>
<div id="d01ab82f" class="cell" data-execution_count="24">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>plot_dispatch(n, time<span class="op">=</span><span class="st">"2024-09-20"</span>, days<span class="op">=</span><span class="dv">10</span>, regions<span class="op">=</span>[<span class="st">"SA1"</span>], show_imports<span class="op">=</span><span class="va">True</span>, scenario_name<span class="op">=</span>scenario, scenario_objective<span class="op">=</span>objective_text, interactive<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="High-level_NEM_files/figure-html/cell-25-output-1.png" width="796" height="614" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As anticipated, curtailment increases dramatically during the shoulder season, as shown above for South Australia.</p>
<div id="c5b34d9a" class="cell" data-execution_count="25">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>plot_generator_capacity_by_carrier(n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="High-level_NEM_files/figure-html/cell-26-output-1.png" width="758" height="470" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In this scenario, the wind generation capacity closely matches the 2049-50 ISP Step Change forecast, while solar capacity is lower as a result of my efforts to minimize curtailment. Coal has been reduced to zero and there is only a small amount of Gas. There are no changes to diesel.</p>
<div style="text-align: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/isp-nem-capacity-forecast.png" class="img-fluid figure-img"></p>
<figcaption>ISP Step Change Onshore wind ~69GW)</figcaption>
</figure>
</div>
</div>
<p>Assessing peak demand alongside installed generation capacity for each region in the <code>8.2.1_6xVreCurtailReview</code> network clearly illustrates the substantial overbuilding of renewable energy relative to demand.</p>
<div id="876b247b" class="cell" data-execution_count="26">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>plot_peak_demand_vs_capacity(n, stack_carrier<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="High-level_NEM_files/figure-html/cell-27-output-1.png" width="758" height="470" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Total generation per region also highlights the over-generation required compared to baseline.</p>
<div id="c1af23e1" class="cell" data-execution_count="27">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>plot_total_demand_vs_generation(n, stack_carrier<span class="op">=</span><span class="va">True</span>, relative<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="High-level_NEM_files/figure-html/cell-28-output-1.png" width="758" height="470" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="268f7bc9" class="cell" data-execution_count="28">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: bus and region are synonymous in this context.</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> curtailment_region_carrier(n, carriers<span class="op">=</span>[<span class="st">'Rooftop Solar'</span>, <span class="st">'Solar'</span>, <span class="st">'Wind'</span>]):</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Calculate curtailment % by bus and carrier (excluding Hydro) and pivot carriers wide.</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Adds one monthly curtailed TWh string column per carrier named</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co">    'monthly_curtailment_&lt;carrier&gt;_twh_str'.</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Fixed so that 'month' in the intermediate DataFrame is a Timestamp,</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co">    which lets us do .to_period('M') later without error.</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    records <span class="op">=</span> []</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    monthly_data <span class="op">=</span> {carrier: [] <span class="cf">for</span> carrier <span class="kw">in</span> carriers}</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create a PeriodIndex of each snapshot’s month</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    snapshot_month <span class="op">=</span> n.snapshots.to_series().dt.to_period(<span class="st">'M'</span>)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> carrier <span class="kw">in</span> carriers:</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>        mask <span class="op">=</span> n.generators.carrier <span class="op">==</span> carrier</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>        gens <span class="op">=</span> n.generators[mask]</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> bus, gens_in_bus <span class="kw">in</span> gens.groupby(<span class="st">'bus'</span>):</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>            idx <span class="op">=</span> gens_in_bus.index.intersection(n.generators_t.p_max_pu.columns)</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>            <span class="co"># overall curtailment % per bus/carrier</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(idx) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>                pct <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>                pot <span class="op">=</span> (n.generators_t.p_max_pu[idx]</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>                       .multiply(n.generators.loc[idx, <span class="st">'p_nom'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>                      ).<span class="bu">sum</span>().<span class="bu">sum</span>()</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>                act <span class="op">=</span> n.generators_t.p[idx].<span class="bu">sum</span>().<span class="bu">sum</span>()</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>                curtailed <span class="op">=</span> pot <span class="op">-</span> act</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>                pct <span class="op">=</span> <span class="dv">100</span> <span class="op">*</span> curtailed <span class="op">/</span> pot <span class="cf">if</span> pot <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="fl">0.0</span></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>            records.append({<span class="st">'bus'</span>: bus, <span class="st">'carrier'</span>: carrier, <span class="st">'curtailment_pct'</span>: <span class="bu">round</span>(pct, <span class="dv">3</span>)})</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>            <span class="co"># monthly curtailed MWh per bus/carrier</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(idx) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>                pot_m <span class="op">=</span> (n.generators_t.p_max_pu[idx]</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>                         .multiply(n.generators.loc[idx, <span class="st">'p_nom'</span>], axis<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>                act_m <span class="op">=</span> n.generators_t.p[idx]</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>                pot_mon <span class="op">=</span> pot_m.groupby(snapshot_month).<span class="bu">sum</span>().<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>                act_mon <span class="op">=</span> act_m.groupby(snapshot_month).<span class="bu">sum</span>().<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>                curtailed_mon <span class="op">=</span> pot_mon <span class="op">-</span> act_mon</span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>                <span class="co"># build a zero‐series indexed by each unique period</span></span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>                curtailed_mon <span class="op">=</span> pd.Series(<span class="fl">0.0</span>, index<span class="op">=</span>snapshot_month.unique())</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>            <span class="co"># *** store month as a Timestamp, not Period ***</span></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> period, val <span class="kw">in</span> curtailed_mon.items():</span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>                monthly_data[carrier].append({</span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'month'</span>: period.to_timestamp(),  <span class="co"># &lt;- convert here</span></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'bus'</span>: bus,</span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'curtailed_mwh'</span>: val</span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># build the bus × carrier % pivot</span></span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame(records)</span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a>    pivot_df <span class="op">=</span> df.pivot(index<span class="op">=</span><span class="st">'bus'</span>, columns<span class="op">=</span><span class="st">'carrier'</span>, values<span class="op">=</span><span class="st">'curtailment_pct'</span>).fillna(<span class="fl">0.0</span>)</span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># for each carrier, build its monthly TWh‐string column</span></span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> carrier <span class="kw">in</span> carriers:</span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a>        mon_df <span class="op">=</span> pd.DataFrame(monthly_data[carrier])</span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a>        summed <span class="op">=</span> (mon_df.groupby([<span class="st">'bus'</span>, <span class="st">'month'</span>])[<span class="st">'curtailed_mwh'</span>]</span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a>                     .<span class="bu">sum</span>()</span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a>                     .reset_index())</span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-70"><a href="#cb32-70" aria-hidden="true" tabindex="-1"></a>        <span class="co"># now month is Timestamp, so this works:</span></span>
<span id="cb32-71"><a href="#cb32-71" aria-hidden="true" tabindex="-1"></a>        start <span class="op">=</span> summed[<span class="st">'month'</span>].<span class="bu">min</span>().to_period(<span class="st">'M'</span>)</span>
<span id="cb32-72"><a href="#cb32-72" aria-hidden="true" tabindex="-1"></a>        end   <span class="op">=</span> summed[<span class="st">'month'</span>].<span class="bu">max</span>().to_period(<span class="st">'M'</span>)</span>
<span id="cb32-73"><a href="#cb32-73" aria-hidden="true" tabindex="-1"></a>        months_sorted <span class="op">=</span> pd.period_range(start, end, freq<span class="op">=</span><span class="st">'M'</span>).to_timestamp()</span>
<span id="cb32-74"><a href="#cb32-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-75"><a href="#cb32-75" aria-hidden="true" tabindex="-1"></a>        ser <span class="op">=</span> {}</span>
<span id="cb32-76"><a href="#cb32-76" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> bus <span class="kw">in</span> pivot_df.index:</span>
<span id="cb32-77"><a href="#cb32-77" aria-hidden="true" tabindex="-1"></a>            subset <span class="op">=</span> summed[summed[<span class="st">'bus'</span>] <span class="op">==</span> bus].set_index(<span class="st">'month'</span>)[<span class="st">'curtailed_mwh'</span>].to_dict()</span>
<span id="cb32-78"><a href="#cb32-78" aria-hidden="true" tabindex="-1"></a>            arr <span class="op">=</span> np.array([<span class="bu">round</span>(subset.get(m, <span class="fl">0.0</span>), <span class="dv">3</span>) <span class="cf">for</span> m <span class="kw">in</span> months_sorted])</span>
<span id="cb32-79"><a href="#cb32-79" aria-hidden="true" tabindex="-1"></a>            twh <span class="op">=</span> arr <span class="op">/</span> <span class="fl">1e6</span> <span class="co"># convert MWh to TWh</span></span>
<span id="cb32-80"><a href="#cb32-80" aria-hidden="true" tabindex="-1"></a>            ser[bus] <span class="op">=</span> <span class="st">' '</span>.join(<span class="ss">f'</span><span class="sc">{</span>x<span class="sc">:.3f}</span><span class="ss">'</span> <span class="cf">for</span> x <span class="kw">in</span> twh)</span>
<span id="cb32-81"><a href="#cb32-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-82"><a href="#cb32-82" aria-hidden="true" tabindex="-1"></a>        col <span class="op">=</span> <span class="ss">f'monthly_curtailment_</span><span class="sc">{</span>carrier<span class="sc">.</span>lower()<span class="sc">.</span>replace(<span class="st">" "</span>, <span class="st">"_"</span>)<span class="sc">}</span><span class="ss">_twh_str'</span></span>
<span id="cb32-83"><a href="#cb32-83" aria-hidden="true" tabindex="-1"></a>        pivot_df[col] <span class="op">=</span> pivot_df.index.<span class="bu">map</span>(ser)</span>
<span id="cb32-84"><a href="#cb32-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-85"><a href="#cb32-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pivot_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Leverage the <a href="https://posit-dev.github.io/great-tables/articles/intro.html">great_tables</a> python library to highlight curtailment data returned in the <code>curtailment_region_carrier</code> function above.</p>
<div id="787b33c9" class="cell" data-execution_count="29">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>pivot_df <span class="op">=</span> curtailment_region_carrier(n)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># from great_tables import GT, md, system_fonts, nanoplot_options</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>curtailment_tbl <span class="op">=</span> GT(data<span class="op">=</span>pivot_df <span class="op">\</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    .reset_index() <span class="op">\</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">round</span>(<span class="dv">2</span>) <span class="op">\</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">'bus'</span>: <span class="st">'Region'</span>,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'Solar'</span>: <span class="st">'Utility Solar'</span>,   </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'monthly_curtailment_rooftop_solar_twh_str'</span>: <span class="st">'Rooftop Solar Curtailment'</span>,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'monthly_curtailment_solar_twh_str'</span>: <span class="st">'Utility Solar Curtailment'</span>,</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'monthly_curtailment_wind_twh_str'</span>: <span class="st">'Wind Curtailment'</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>                     })</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate great table for curtailment by region and carrier</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: Scale-up objective is hardcoded in the source note.</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="co"># objective_text.replace('\n', ', ') </span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>curtailment_gt <span class="op">=</span> curtailment_tbl.tab_header(</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">"NEM Variable Renewable Energy Curtailment by Region"</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>        .tab_spanner(</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">"Curtailment (%)"</span>,</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>        columns<span class="op">=</span>[<span class="st">'Rooftop Solar'</span>, <span class="st">'Utility Solar'</span>, <span class="st">'Wind'</span>]</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>        .tab_spanner(</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">"Monthly Curtailment Profiles (TWh)"</span>,</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>            columns<span class="op">=</span>[<span class="st">'Rooftop Solar Curtailment'</span>,</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'Utility Solar Curtailment'</span>,</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'Wind Curtailment'</span>]</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>        .data_color(</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>        columns<span class="op">=</span>[<span class="st">'Rooftop Solar'</span>, <span class="st">'Utility Solar'</span>, <span class="st">'Wind'</span>],</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>        palette<span class="op">=</span>[</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#31a354"</span>, <span class="st">"#78c679"</span>, <span class="st">"#ffffcc"</span>,</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#fafa8c"</span>, <span class="st">"#f4cd1e"</span>, <span class="st">"#f8910b"</span>],</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>        domain<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">100</span>]</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>        .cols_width(</span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Wind'</span>: <span class="st">'120px'</span>, <span class="st">'Utility Solar'</span>: <span class="st">'120px'</span>, <span class="st">'Rooftop Solar'</span>: <span class="st">'120px'</span>}</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>        .cols_align(    </span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>             align<span class="op">=</span><span class="st">'center'</span></span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>        .tab_source_note(</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>            source_note<span class="op">=</span>md(</span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>                <span class="st">"**Calculation**: Curtailment = (Potential energy - Actual energy) / Potential energy * 100."</span></span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>                                           </span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>        .tab_source_note(</span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>            source_note<span class="op">=</span>md(</span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a>                <span class="st">"**Note**: there are currently no listed utility scale solar in the TAS1 [Open Electricity Facilities](https://explore.openelectricity.org.au/facilities/tas1/?tech=solar_utility&amp;status=operating,committed)"</span></span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>                                           </span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a>        .tab_source_note(</span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a>            source_note<span class="op">=</span>md(<span class="st">"**Scenario**: 8.2.1_6xVreCurtailReview (Zero coal &amp; 83</span><span class="sc">% r</span><span class="st">eduction in GPG).&lt;br&gt;&lt;br&gt; **Scale-up objective from 2024 baseline**: *NSW1-Black Coal: x0.0, NSW1-Gas: x0.5, NSW1-Rooftop Solar: x3.0, NSW1-Solar: x3.0, NSW1-Wind: x6.0, NSW1-Battery: x8.0, QLD1-Black Coal: x0.0, QLD1-Gas: x0.5, QLD1-Rooftop Solar: x3.0, QLD1-Solar: x3.0, QLD1-Wind: x6.0, QLD1-Battery: x6.0, SA1-Gas: x0.5, SA1-Rooftop Solar: x2.0, SA1-Solar: x3.0, SA1-Wind: x2.0, SA1-Battery: x6.0, TAS1-Gas: x0.5, TAS1-Rooftop Solar: x3.0, TAS1-Wind: x5.0, TAS1-Battery: x8.0, VIC1-Gas: x0.5, VIC1-Brown Coal: x0.0, VIC1-Rooftop Solar: x4.0, VIC1-Solar: x4.0, VIC1-Wind: x4.0, VIC1-Battery: x8.0*"</span>)</span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a>        .fmt_nanoplot(<span class="st">"Rooftop Solar Curtailment"</span>,</span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a>                      plot_type<span class="op">=</span><span class="st">"bar"</span>,</span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a>                      options<span class="op">=</span>nanoplot_options(</span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a>                          data_bar_fill_color<span class="op">=</span><span class="st">"#FFE066"</span>,</span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a>                          y_ref_line_fmt_fn<span class="op">=</span><span class="st">"GWh"</span>,</span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a>                          )</span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a>        .fmt_nanoplot(<span class="st">"Utility Solar Curtailment"</span>,</span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a>                      plot_type<span class="op">=</span><span class="st">"bar"</span>,</span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a>                      options<span class="op">=</span>nanoplot_options(</span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a>                          data_bar_fill_color<span class="op">=</span><span class="st">"#FDB324"</span>,</span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true" tabindex="-1"></a>                          y_ref_line_fmt_fn<span class="op">=</span><span class="st">"GWh"</span>,</span>
<span id="cb33-72"><a href="#cb33-72" aria-hidden="true" tabindex="-1"></a>                          )</span>
<span id="cb33-73"><a href="#cb33-73" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb33-74"><a href="#cb33-74" aria-hidden="true" tabindex="-1"></a>        .fmt_nanoplot(<span class="st">"Wind Curtailment"</span>,</span>
<span id="cb33-75"><a href="#cb33-75" aria-hidden="true" tabindex="-1"></a>                      plot_type<span class="op">=</span><span class="st">"bar"</span>,</span>
<span id="cb33-76"><a href="#cb33-76" aria-hidden="true" tabindex="-1"></a>                      options<span class="op">=</span>nanoplot_options(</span>
<span id="cb33-77"><a href="#cb33-77" aria-hidden="true" tabindex="-1"></a>                          data_bar_fill_color<span class="op">=</span><span class="st">"#3BBFE5"</span>,</span>
<span id="cb33-78"><a href="#cb33-78" aria-hidden="true" tabindex="-1"></a>                          y_ref_line_fmt_fn<span class="op">=</span><span class="st">"GWh"</span>,</span>
<span id="cb33-79"><a href="#cb33-79" aria-hidden="true" tabindex="-1"></a>                          )</span>
<span id="cb33-80"><a href="#cb33-80" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb33-81"><a href="#cb33-81" aria-hidden="true" tabindex="-1"></a>        .tab_options(</span>
<span id="cb33-82"><a href="#cb33-82" aria-hidden="true" tabindex="-1"></a>            source_notes_font_size<span class="op">=</span><span class="st">'x-small'</span>,</span>
<span id="cb33-83"><a href="#cb33-83" aria-hidden="true" tabindex="-1"></a>            source_notes_padding<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb33-84"><a href="#cb33-84" aria-hidden="true" tabindex="-1"></a>            heading_subtitle_font_size<span class="op">=</span><span class="st">'small'</span>,</span>
<span id="cb33-85"><a href="#cb33-85" aria-hidden="true" tabindex="-1"></a>            table_font_names<span class="op">=</span>system_fonts(<span class="st">"humanist"</span>),</span>
<span id="cb33-86"><a href="#cb33-86" aria-hidden="true" tabindex="-1"></a>            data_row_padding<span class="op">=</span><span class="st">'1px'</span>,</span>
<span id="cb33-87"><a href="#cb33-87" aria-hidden="true" tabindex="-1"></a>            heading_background_color<span class="op">=</span><span class="st">'#F0FFFF'</span>,</span>
<span id="cb33-88"><a href="#cb33-88" aria-hidden="true" tabindex="-1"></a>            source_notes_background_color<span class="op">=</span><span class="st">'#F0FFF0'</span>,</span>
<span id="cb33-89"><a href="#cb33-89" aria-hidden="true" tabindex="-1"></a>            column_labels_background_color<span class="op">=</span><span class="st">'#F0FFF0'</span>,</span>
<span id="cb33-90"><a href="#cb33-90" aria-hidden="true" tabindex="-1"></a>            table_background_color<span class="op">=</span><span class="st">'snow'</span>,</span>
<span id="cb33-91"><a href="#cb33-91" aria-hidden="true" tabindex="-1"></a>            data_row_padding_horizontal<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb33-92"><a href="#cb33-92" aria-hidden="true" tabindex="-1"></a>            column_labels_padding_horizontal<span class="op">=</span><span class="dv">58</span></span>
<span id="cb33-93"><a href="#cb33-93" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb33-94"><a href="#cb33-94" aria-hidden="true" tabindex="-1"></a>            .opt_table_outline()</span>
<span id="cb33-95"><a href="#cb33-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-96"><a href="#cb33-96" aria-hidden="true" tabindex="-1"></a>curtailment_gt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>
<div id="jsoxeltmsg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>
#jsoxeltmsg table {
          font-family: Seravek, 'Gill Sans Nova', Ubuntu, Calibri, 'DejaVu Sans', source-sans-pro, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
        }

#jsoxeltmsg thead, tbody, tfoot, tr, td, th { border-style: none; }
 tr { background-color: transparent; }
#jsoxeltmsg p { margin: 0; padding: 0; }
 #jsoxeltmsg .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: snow; width: auto; border-top-style: solid; border-top-width: 3px; border-top-color: #D3D3D3; border-right-style: solid; border-right-width: 3px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 3px; border-bottom-color: #D3D3D3; border-left-style: solid; border-left-width: 3px; border-left-color: #D3D3D3; }
 #jsoxeltmsg .gt_caption { padding-top: 4px; padding-bottom: 4px; }
 #jsoxeltmsg .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: snow; border-bottom-width: 0; }
 #jsoxeltmsg .gt_subtitle { color: #333333; font-size: small; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: snow; border-top-width: 0; }
 #jsoxeltmsg .gt_heading { background-color: #F0FFFF; text-align: center; border-bottom-color: snow; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #jsoxeltmsg .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #jsoxeltmsg .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #jsoxeltmsg .gt_col_heading { color: #333333; background-color: #F0FFF0; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; padding-left: 58; padding-right: 58; overflow-x: hidden; }
 #jsoxeltmsg .gt_column_spanner_outer { color: #333333; background-color: #F0FFF0; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }
 #jsoxeltmsg .gt_column_spanner_outer:first-child { padding-left: 0; }
 #jsoxeltmsg .gt_column_spanner_outer:last-child { padding-right: 0; }
 #jsoxeltmsg .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; }
 #jsoxeltmsg .gt_spanner_row { border-bottom-style: hidden; }
 #jsoxeltmsg .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: snow; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; }
 #jsoxeltmsg .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: snow; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; }
 #jsoxeltmsg .gt_from_md> :first-child { margin-top: 0; }
 #jsoxeltmsg .gt_from_md> :last-child { margin-bottom: 0; }
 #jsoxeltmsg .gt_row { padding-top: 1px; padding-bottom: 1px; padding-left: 3; padding-right: 3; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; }
 #jsoxeltmsg .gt_stub { color: #333333; background-color: snow; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 3; padding-right: 3; }
 #jsoxeltmsg .gt_stub_row_group { color: #333333; background-color: snow; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }
 #jsoxeltmsg .gt_row_group_first td { border-top-width: 2px; }
 #jsoxeltmsg .gt_row_group_first th { border-top-width: 2px; }
 #jsoxeltmsg .gt_striped { background-color: rgba(128,128,128,0.05); }
 #jsoxeltmsg .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #jsoxeltmsg .gt_sourcenotes { color: #333333; background-color: #F0FFF0; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }
 #jsoxeltmsg .gt_sourcenote { font-size: x-small; padding-top: 3; padding-bottom: 3; padding-left: 5px; padding-right: 5px; text-align: left; }
 #jsoxeltmsg .gt_left { text-align: left; }
 #jsoxeltmsg .gt_center { text-align: center; }
 #jsoxeltmsg .gt_right { text-align: right; font-variant-numeric: tabular-nums; }
 #jsoxeltmsg .gt_font_normal { font-weight: normal; }
 #jsoxeltmsg .gt_font_bold { font-weight: bold; }
 #jsoxeltmsg .gt_font_italic { font-style: italic; }
 #jsoxeltmsg .gt_super { font-size: 65%; }
 #jsoxeltmsg .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }
 #jsoxeltmsg .gt_asterisk { font-size: 100%; vertical-align: 0; }
 
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="7" class="gt_heading gt_title gt_font_normal">NEM Variable Renewable Energy Curtailment by Region</th>
</tr>
<tr class="odd gt_col_headings gt_spanner_row">
<th rowspan="2" id="Region" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Region</th>
<th colspan="3" id="Curtailment-(%)" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">Curtailment (%)</span></th>
<th colspan="3" id="Monthly-Curtailment-Profiles-(TWh)" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">Monthly Curtailment Profiles (TWh)</span></th>
</tr>
<tr class="header gt_col_headings">
<th id="Rooftop-Solar" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Rooftop Solar</th>
<th id="Utility-Solar" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Utility Solar</th>
<th id="Wind" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Wind</th>
<th id="Rooftop-Solar-Curtailment" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Rooftop Solar Curtailment</th>
<th id="Utility-Solar-Curtailment" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Utility Solar Curtailment</th>
<th id="Wind-Curtailment" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Wind Curtailment</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center">NSW1</td>
<td class="gt_row gt_center" style="color: #000000; background-color: #ffffc6">41.86</td>
<td class="gt_row gt_center" style="color: #000000; background-color: #99d48d">24.86</td>
<td class="gt_row gt_center" style="color: #000000; background-color: #62bb6e">13.89</td>
<td class="gt_row gt_center"><div>
<svg role="img" viewbox="0 0 700 130" style="height: 2em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="22.5" y1="115.0" x2="677.5" y2="115.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="30.0" y="34.62264150943397" width="40" height="80.37735849056602" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="84.54545454545455" y="43.93081761006291" width="40" height="71.06918238993708" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="139.0909090909091" y="45.31446540880502" width="40" height="69.68553459119498" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="193.63636363636363" y="76.44654088050314" width="40" height="38.553459119496864" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="248.1818181818182" y="92.23270440251572" width="40" height="22.767295597484278" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="302.72727272727275" y="105.062893081761" width="40" height="9.937106918238996" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="357.27272727272725" y="87.20125786163523" width="40" height="27.798742138364773" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="411.8181818181818" y="68.64779874213836" width="40" height="46.35220125786164" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="466.3636363636364" y="42.16981132075472" width="40" height="72.83018867924528" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="520.909090909091" y="37.13836477987422" width="40" height="77.86163522012578" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="575.4545454545455" y="46.32075471698113" width="40" height="68.67924528301887" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="630.0" y="15.0" width="40" height="100.0" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><g class="y-axis-line"><rect x="0" y="0" width="65" height="130" stroke="transparent" stroke-width="0" fill="transparent"></rect><text x="0" y="19.0" fill="transparent" stroke="transparent" font-size="25">1.59</text><text x="0" y="126.0" fill="transparent" stroke="transparent" font-size="25">0</text></g><g class="vert-line"><rect x="40.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="60.0" y="20" fill="transparent" stroke="transparent" font-size="30px">1.28</text></g><g class="vert-line"><rect x="94.54545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="114.54545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">1.13</text></g><g class="vert-line"><rect x="149.0909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="169.0909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">1.11</text></g><g class="vert-line"><rect x="203.63636363636363" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="223.63636363636363" y="20" fill="transparent" stroke="transparent" font-size="30px">0.61</text></g><g class="vert-line"><rect x="258.1818181818182" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="278.1818181818182" y="20" fill="transparent" stroke="transparent" font-size="30px">0.36</text></g><g class="vert-line"><rect x="312.72727272727275" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="332.72727272727275" y="20" fill="transparent" stroke="transparent" font-size="30px">0.16</text></g><g class="vert-line"><rect x="367.27272727272725" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="387.27272727272725" y="20" fill="transparent" stroke="transparent" font-size="30px">0.44</text></g><g class="vert-line"><rect x="421.8181818181818" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="441.8181818181818" y="20" fill="transparent" stroke="transparent" font-size="30px">0.74</text></g><g class="vert-line"><rect x="476.3636363636364" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="496.3636363636364" y="20" fill="transparent" stroke="transparent" font-size="30px">1.16</text></g><g class="vert-line"><rect x="530.909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="550.909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">1.24</text></g><g class="vert-line"><rect x="585.4545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="605.4545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">1.09</text></g><g class="vert-line"><rect x="640.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="660.0" y="20" fill="transparent" stroke="transparent" font-size="30px">1.59</text></g>
</svg>
</div></td>
<td class="gt_row gt_center"><div>
<svg role="img" viewbox="0 0 700 130" style="height: 2em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="22.5" y1="115.0" x2="677.5" y2="115.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="30.0" y="40.788643533123036" width="40" height="74.21135646687696" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="84.54545454545455" y="52.22397476340694" width="40" height="62.77602523659306" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="139.0909090909091" y="53.09148264984227" width="40" height="61.90851735015773" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="193.63636363636363" y="75.96214511041009" width="40" height="39.03785488958991" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="248.1818181818182" y="97.96529968454259" width="40" height="17.034700315457414" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="302.72727272727275" y="100.64668769716089" width="40" height="14.353312302839115" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="357.27272727272725" y="84.08517350157727" width="40" height="30.914826498422727" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="411.8181818181818" y="73.43848580441639" width="40" height="41.56151419558361" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="466.3636363636364" y="36.60883280757098" width="40" height="78.39116719242902" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="520.909090909091" y="26.51419558359621" width="40" height="88.4858044164038" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="575.4545454545455" y="36.76656151419558" width="40" height="78.23343848580441" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="630.0" y="15.0" width="40" height="100.0" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><g class="y-axis-line"><rect x="0" y="0" width="65" height="130" stroke="transparent" stroke-width="0" fill="transparent"></rect><text x="0" y="19.0" fill="transparent" stroke="transparent" font-size="25">1.27</text><text x="0" y="126.0" fill="transparent" stroke="transparent" font-size="25">0</text></g><g class="vert-line"><rect x="40.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="60.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.94</text></g><g class="vert-line"><rect x="94.54545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="114.54545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.80</text></g><g class="vert-line"><rect x="149.0909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="169.0909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0.78</text></g><g class="vert-line"><rect x="203.63636363636363" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="223.63636363636363" y="20" fill="transparent" stroke="transparent" font-size="30px">0.50</text></g><g class="vert-line"><rect x="258.1818181818182" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="278.1818181818182" y="20" fill="transparent" stroke="transparent" font-size="30px">0.22</text></g><g class="vert-line"><rect x="312.72727272727275" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="332.72727272727275" y="20" fill="transparent" stroke="transparent" font-size="30px">0.18</text></g><g class="vert-line"><rect x="367.27272727272725" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="387.27272727272725" y="20" fill="transparent" stroke="transparent" font-size="30px">0.39</text></g><g class="vert-line"><rect x="421.8181818181818" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="441.8181818181818" y="20" fill="transparent" stroke="transparent" font-size="30px">0.53</text></g><g class="vert-line"><rect x="476.3636363636364" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="496.3636363636364" y="20" fill="transparent" stroke="transparent" font-size="30px">0.99</text></g><g class="vert-line"><rect x="530.909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="550.909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">1.12</text></g><g class="vert-line"><rect x="585.4545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="605.4545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.99</text></g><g class="vert-line"><rect x="640.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="660.0" y="20" fill="transparent" stroke="transparent" font-size="30px">1.27</text></g>
</svg>
</div></td>
<td class="gt_row gt_center"><div>
<svg role="img" viewbox="0 0 700 130" style="height: 2em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="22.5" y1="115.0" x2="677.5" y2="115.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="30.0" y="35.45977011494253" width="40" height="79.54022988505747" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="84.54545454545455" y="54.42528735632184" width="40" height="60.57471264367816" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="139.0909090909091" y="60.17241379310345" width="40" height="54.82758620689655" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="193.63636363636363" y="77.52873563218391" width="40" height="37.47126436781609" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="248.1818181818182" y="82.9310344827586" width="40" height="32.068965517241395" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="302.72727272727275" y="101.89655172413792" width="40" height="13.103448275862078" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="357.27272727272725" y="67.75862068965517" width="40" height="47.241379310344826" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="411.8181818181818" y="54.770114942528735" width="40" height="60.229885057471265" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="466.3636363636364" y="15.0" width="40" height="100.0" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="520.909090909091" y="34.19540229885058" width="40" height="80.80459770114942" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="575.4545454545455" y="50.40229885057471" width="40" height="64.59770114942529" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="630.0" y="22.35632183908045" width="40" height="92.64367816091955" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><g class="y-axis-line"><rect x="0" y="0" width="65" height="130" stroke="transparent" stroke-width="0" fill="transparent"></rect><text x="0" y="19.0" fill="transparent" stroke="transparent" font-size="25">0.87</text><text x="0" y="126.0" fill="transparent" stroke="transparent" font-size="25">0</text></g><g class="vert-line"><rect x="40.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="60.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.69</text></g><g class="vert-line"><rect x="94.54545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="114.54545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.53</text></g><g class="vert-line"><rect x="149.0909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="169.0909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0.48</text></g><g class="vert-line"><rect x="203.63636363636363" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="223.63636363636363" y="20" fill="transparent" stroke="transparent" font-size="30px">0.33</text></g><g class="vert-line"><rect x="258.1818181818182" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="278.1818181818182" y="20" fill="transparent" stroke="transparent" font-size="30px">0.28</text></g><g class="vert-line"><rect x="312.72727272727275" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="332.72727272727275" y="20" fill="transparent" stroke="transparent" font-size="30px">0.11</text></g><g class="vert-line"><rect x="367.27272727272725" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="387.27272727272725" y="20" fill="transparent" stroke="transparent" font-size="30px">0.41</text></g><g class="vert-line"><rect x="421.8181818181818" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="441.8181818181818" y="20" fill="transparent" stroke="transparent" font-size="30px">0.52</text></g><g class="vert-line"><rect x="476.3636363636364" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="496.3636363636364" y="20" fill="transparent" stroke="transparent" font-size="30px">0.87</text></g><g class="vert-line"><rect x="530.909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="550.909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0.70</text></g><g class="vert-line"><rect x="585.4545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="605.4545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.56</text></g><g class="vert-line"><rect x="640.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="660.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.81</text></g>
</svg>
</div></td>
</tr>
<tr class="even">
<td class="gt_row gt_center">QLD1</td>
<td class="gt_row gt_center" style="color: #000000; background-color: #def1b8">35.07</td>
<td class="gt_row gt_center" style="color: #000000; background-color: #eff8c2">37.66</td>
<td class="gt_row gt_center" style="color: #000000; background-color: #67bd70">15.08</td>
<td class="gt_row gt_center"><div>
<svg role="img" viewbox="0 0 700 130" style="height: 2em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="22.5" y1="115.0" x2="677.5" y2="115.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="30.0" y="33.503937007874015" width="40" height="81.49606299212599" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="84.54545454545455" y="56.24015748031496" width="40" height="58.75984251968504" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="139.0909090909091" y="34.980314960629926" width="40" height="80.01968503937007" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="193.63636363636363" y="44.82283464566929" width="40" height="70.17716535433071" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="248.1818181818182" y="43.34645669291339" width="40" height="71.65354330708661" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="302.72727272727275" y="87.04724409448819" width="40" height="27.952755905511808" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="357.27272727272725" y="47.874015748031496" width="40" height="67.1259842519685" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="411.8181818181818" y="45.70866141732284" width="40" height="69.29133858267716" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="466.3636363636364" y="15.0" width="40" height="100.0" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="520.909090909091" y="19.232283464566933" width="40" height="95.76771653543307" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="575.4545454545455" y="30.354330708661422" width="40" height="84.64566929133858" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="630.0" y="62.83464566929133" width="40" height="52.16535433070867" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><g class="y-axis-line"><rect x="0" y="0" width="65" height="130" stroke="transparent" stroke-width="0" fill="transparent"></rect><text x="0" y="19.0" fill="transparent" stroke="transparent" font-size="25">1.02</text><text x="0" y="126.0" fill="transparent" stroke="transparent" font-size="25">0</text></g><g class="vert-line"><rect x="40.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="60.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.83</text></g><g class="vert-line"><rect x="94.54545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="114.54545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.60</text></g><g class="vert-line"><rect x="149.0909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="169.0909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0.81</text></g><g class="vert-line"><rect x="203.63636363636363" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="223.63636363636363" y="20" fill="transparent" stroke="transparent" font-size="30px">0.71</text></g><g class="vert-line"><rect x="258.1818181818182" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="278.1818181818182" y="20" fill="transparent" stroke="transparent" font-size="30px">0.73</text></g><g class="vert-line"><rect x="312.72727272727275" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="332.72727272727275" y="20" fill="transparent" stroke="transparent" font-size="30px">0.28</text></g><g class="vert-line"><rect x="367.27272727272725" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="387.27272727272725" y="20" fill="transparent" stroke="transparent" font-size="30px">0.68</text></g><g class="vert-line"><rect x="421.8181818181818" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="441.8181818181818" y="20" fill="transparent" stroke="transparent" font-size="30px">0.70</text></g><g class="vert-line"><rect x="476.3636363636364" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="496.3636363636364" y="20" fill="transparent" stroke="transparent" font-size="30px">1.02</text></g><g class="vert-line"><rect x="530.909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="550.909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0.97</text></g><g class="vert-line"><rect x="585.4545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="605.4545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.86</text></g><g class="vert-line"><rect x="640.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="660.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.53</text></g>
</svg>
</div></td>
<td class="gt_row gt_center"><div>
<svg role="img" viewbox="0 0 700 130" style="height: 2em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="22.5" y1="115.0" x2="677.5" y2="115.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="30.0" y="69.59508644222021" width="40" height="45.40491355777979" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="84.54545454545455" y="61.22383985441311" width="40" height="53.77616014558689" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="139.0909090909091" y="18.275705186533216" width="40" height="96.72429481346678" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="193.63636363636363" y="45.93721565059144" width="40" height="69.06278434940856" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="248.1818181818182" y="40.38671519563239" width="40" height="74.61328480436761" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="302.72727272727275" y="78.42129208371246" width="40" height="36.57870791628754" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="357.27272727272725" y="35.564149226569604" width="40" height="79.43585077343039" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="411.8181818181818" y="41.660600545950864" width="40" height="73.33939945404913" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="466.3636363636364" y="23.280254777070063" width="40" height="91.71974522292993" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="520.909090909091" y="15.0" width="40" height="100.0" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="575.4545454545455" y="24.372156505914464" width="40" height="90.62784349408554" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="630.0" y="28.921747042766153" width="40" height="86.07825295723384" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><g class="y-axis-line"><rect x="0" y="0" width="65" height="130" stroke="transparent" stroke-width="0" fill="transparent"></rect><text x="0" y="19.0" fill="transparent" stroke="transparent" font-size="25">1.10</text><text x="0" y="126.0" fill="transparent" stroke="transparent" font-size="25">0</text></g><g class="vert-line"><rect x="40.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="60.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.50</text></g><g class="vert-line"><rect x="94.54545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="114.54545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.59</text></g><g class="vert-line"><rect x="149.0909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="169.0909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">1.06</text></g><g class="vert-line"><rect x="203.63636363636363" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="223.63636363636363" y="20" fill="transparent" stroke="transparent" font-size="30px">0.76</text></g><g class="vert-line"><rect x="258.1818181818182" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="278.1818181818182" y="20" fill="transparent" stroke="transparent" font-size="30px">0.82</text></g><g class="vert-line"><rect x="312.72727272727275" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="332.72727272727275" y="20" fill="transparent" stroke="transparent" font-size="30px">0.40</text></g><g class="vert-line"><rect x="367.27272727272725" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="387.27272727272725" y="20" fill="transparent" stroke="transparent" font-size="30px">0.87</text></g><g class="vert-line"><rect x="421.8181818181818" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="441.8181818181818" y="20" fill="transparent" stroke="transparent" font-size="30px">0.81</text></g><g class="vert-line"><rect x="476.3636363636364" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="496.3636363636364" y="20" fill="transparent" stroke="transparent" font-size="30px">1.01</text></g><g class="vert-line"><rect x="530.909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="550.909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">1.10</text></g><g class="vert-line"><rect x="585.4545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="605.4545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">1.0</text></g><g class="vert-line"><rect x="640.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="660.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.95</text></g>
</svg>
</div></td>
<td class="gt_row gt_center"><div>
<svg role="img" viewbox="0 0 700 130" style="height: 2em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="22.5" y1="115.0" x2="677.5" y2="115.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="30.0" y="79.72416472416472" width="40" height="35.27583527583528" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="84.54545454545455" y="89.51437451437451" width="40" height="25.48562548562549" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="139.0909090909091" y="34.19191919191918" width="40" height="80.80808080808082" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="193.63636363636363" y="57.03574203574203" width="40" height="57.96425796425797" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="248.1818181818182" y="15.0" width="40" height="100.0" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="302.72727272727275" y="92.15617715617715" width="40" height="22.84382284382285" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="357.27272727272725" y="27.432012432012428" width="40" height="87.56798756798757" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="411.8181818181818" y="60.45454545454546" width="40" height="54.54545454545454" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="466.3636363636364" y="47.47863247863248" width="40" height="67.52136752136752" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="520.909090909091" y="70.16705516705517" width="40" height="44.83294483294483" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="575.4545454545455" y="70.47785547785548" width="40" height="44.522144522144515" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="630.0" y="93.01087801087802" width="40" height="21.989121989121983" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><g class="y-axis-line"><rect x="0" y="0" width="65" height="130" stroke="transparent" stroke-width="0" fill="transparent"></rect><text x="0" y="19.0" fill="transparent" stroke="transparent" font-size="25">1.29</text><text x="0" y="126.0" fill="transparent" stroke="transparent" font-size="25">0</text></g><g class="vert-line"><rect x="40.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="60.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.45</text></g><g class="vert-line"><rect x="94.54545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="114.54545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.33</text></g><g class="vert-line"><rect x="149.0909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="169.0909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">1.04</text></g><g class="vert-line"><rect x="203.63636363636363" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="223.63636363636363" y="20" fill="transparent" stroke="transparent" font-size="30px">0.75</text></g><g class="vert-line"><rect x="258.1818181818182" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="278.1818181818182" y="20" fill="transparent" stroke="transparent" font-size="30px">1.29</text></g><g class="vert-line"><rect x="312.72727272727275" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="332.72727272727275" y="20" fill="transparent" stroke="transparent" font-size="30px">0.29</text></g><g class="vert-line"><rect x="367.27272727272725" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="387.27272727272725" y="20" fill="transparent" stroke="transparent" font-size="30px">1.13</text></g><g class="vert-line"><rect x="421.8181818181818" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="441.8181818181818" y="20" fill="transparent" stroke="transparent" font-size="30px">0.70</text></g><g class="vert-line"><rect x="476.3636363636364" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="496.3636363636364" y="20" fill="transparent" stroke="transparent" font-size="30px">0.87</text></g><g class="vert-line"><rect x="530.909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="550.909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0.58</text></g><g class="vert-line"><rect x="585.4545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="605.4545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.57</text></g><g class="vert-line"><rect x="640.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="660.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.28</text></g>
</svg>
</div></td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">SA1</td>
<td class="gt_row gt_center" style="color: #000000; background-color: #f9f177">63.79</td>
<td class="gt_row gt_center" style="color: #000000; background-color: #fcfca1">53.36</td>
<td class="gt_row gt_center" style="color: #000000; background-color: #71c376">18.13</td>
<td class="gt_row gt_center"><div>
<svg role="img" viewbox="0 0 700 130" style="height: 2em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="22.5" y1="115.0" x2="677.5" y2="115.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="30.0" y="36.339563862928344" width="40" height="78.66043613707166" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="84.54545454545455" y="43.660436137071656" width="40" height="71.33956386292834" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="139.0909090909091" y="56.12149532710281" width="40" height="58.87850467289719" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="193.63636363636363" y="87.74143302180686" width="40" height="27.258566978193144" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="248.1818181818182" y="96.93146417445483" width="40" height="18.06853582554517" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="302.72727272727275" y="108.92523364485982" width="40" height="6.074766355140184" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="357.27272727272725" y="96.77570093457945" width="40" height="18.224299065420553" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="411.8181818181818" y="81.35514018691589" width="40" height="33.64485981308411" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="466.3636363636364" y="52.69470404984423" width="40" height="62.30529595015577" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="520.909090909091" y="28.0841121495327" width="40" height="86.9158878504673" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="575.4545454545455" y="38.05295950155764" width="40" height="76.94704049844236" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="630.0" y="15.0" width="40" height="100.0" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><g class="y-axis-line"><rect x="0" y="0" width="65" height="130" stroke="transparent" stroke-width="0" fill="transparent"></rect><text x="0" y="19.0" fill="transparent" stroke="transparent" font-size="25">0.64</text><text x="0" y="126.0" fill="transparent" stroke="transparent" font-size="25">0</text></g><g class="vert-line"><rect x="40.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="60.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.50</text></g><g class="vert-line"><rect x="94.54545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="114.54545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.46</text></g><g class="vert-line"><rect x="149.0909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="169.0909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0.38</text></g><g class="vert-line"><rect x="203.63636363636363" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="223.63636363636363" y="20" fill="transparent" stroke="transparent" font-size="30px">0.18</text></g><g class="vert-line"><rect x="258.1818181818182" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="278.1818181818182" y="20" fill="transparent" stroke="transparent" font-size="30px">0.12</text></g><g class="vert-line"><rect x="312.72727272727275" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="332.72727272727275" y="20" fill="transparent" stroke="transparent" font-size="30px">0.039</text></g><g class="vert-line"><rect x="367.27272727272725" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="387.27272727272725" y="20" fill="transparent" stroke="transparent" font-size="30px">0.12</text></g><g class="vert-line"><rect x="421.8181818181818" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="441.8181818181818" y="20" fill="transparent" stroke="transparent" font-size="30px">0.22</text></g><g class="vert-line"><rect x="476.3636363636364" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="496.3636363636364" y="20" fill="transparent" stroke="transparent" font-size="30px">0.40</text></g><g class="vert-line"><rect x="530.909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="550.909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0.56</text></g><g class="vert-line"><rect x="585.4545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="605.4545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.49</text></g><g class="vert-line"><rect x="640.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="660.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.64</text></g>
</svg>
</div></td>
<td class="gt_row gt_center"><div>
<svg role="img" viewbox="0 0 700 130" style="height: 2em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="22.5" y1="115.0" x2="677.5" y2="115.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="30.0" y="15.0" width="40" height="100.0" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="84.54545454545455" y="27.169312169312164" width="40" height="87.83068783068784" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="139.0909090909091" y="27.169312169312164" width="40" height="87.83068783068784" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="193.63636363636363" y="67.38095238095238" width="40" height="47.61904761904762" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="248.1818181818182" y="85.37037037037037" width="40" height="29.629629629629633" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="302.72727272727275" y="101.77248677248677" width="40" height="13.227513227513228" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="357.27272727272725" y="84.3121693121693" width="40" height="30.687830687830697" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="411.8181818181818" y="66.85185185185186" width="40" height="48.14814814814814" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="466.3636363636364" y="41.455026455026456" width="40" height="73.54497354497354" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="520.909090909091" y="51.50793650793651" width="40" height="63.49206349206349" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="575.4545454545455" y="49.39153439153439" width="40" height="65.60846560846561" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="630.0" y="33.51851851851852" width="40" height="81.48148148148148" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><g class="y-axis-line"><rect x="0" y="0" width="65" height="130" stroke="transparent" stroke-width="0" fill="transparent"></rect><text x="0" y="19.0" fill="transparent" stroke="transparent" font-size="25">0.19</text><text x="0" y="126.0" fill="transparent" stroke="transparent" font-size="25">0</text></g><g class="vert-line"><rect x="40.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="60.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.19</text></g><g class="vert-line"><rect x="94.54545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="114.54545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.17</text></g><g class="vert-line"><rect x="149.0909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="169.0909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0.17</text></g><g class="vert-line"><rect x="203.63636363636363" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="223.63636363636363" y="20" fill="transparent" stroke="transparent" font-size="30px">0.090</text></g><g class="vert-line"><rect x="258.1818181818182" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="278.1818181818182" y="20" fill="transparent" stroke="transparent" font-size="30px">0.056</text></g><g class="vert-line"><rect x="312.72727272727275" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="332.72727272727275" y="20" fill="transparent" stroke="transparent" font-size="30px">0.025</text></g><g class="vert-line"><rect x="367.27272727272725" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="387.27272727272725" y="20" fill="transparent" stroke="transparent" font-size="30px">0.058</text></g><g class="vert-line"><rect x="421.8181818181818" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="441.8181818181818" y="20" fill="transparent" stroke="transparent" font-size="30px">0.091</text></g><g class="vert-line"><rect x="476.3636363636364" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="496.3636363636364" y="20" fill="transparent" stroke="transparent" font-size="30px">0.14</text></g><g class="vert-line"><rect x="530.909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="550.909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0.12</text></g><g class="vert-line"><rect x="585.4545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="605.4545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.12</text></g><g class="vert-line"><rect x="640.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="660.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.15</text></g>
</svg>
</div></td>
<td class="gt_row gt_center"><div>
<svg role="img" viewbox="0 0 700 130" style="height: 2em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="22.5" y1="115.0" x2="677.5" y2="115.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="30.0" y="53.108882521489974" width="40" height="61.891117478510026" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="84.54545454545455" y="76.89111747851001" width="40" height="38.10888252148999" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="139.0909090909091" y="70.87392550143267" width="40" height="44.126074498567334" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="193.63636363636363" y="78.03724928366762" width="40" height="36.96275071633238" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="248.1818181818182" y="78.89684813753581" width="40" height="36.10315186246419" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="302.72727272727275" y="94.65616045845272" width="40" height="20.343839541547283" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="357.27272727272725" y="51.10315186246418" width="40" height="63.89684813753582" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="411.8181818181818" y="23.309455587392545" width="40" height="91.69054441260745" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="466.3636363636364" y="15.0" width="40" height="100.0" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="520.909090909091" y="55.114613180515754" width="40" height="59.885386819484246" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="575.4545454545455" y="60.55873925501432" width="40" height="54.44126074498568" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="630.0" y="52.53581661891117" width="40" height="62.46418338108883" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><g class="y-axis-line"><rect x="0" y="0" width="65" height="130" stroke="transparent" stroke-width="0" fill="transparent"></rect><text x="0" y="19.0" fill="transparent" stroke="transparent" font-size="25">0.35</text><text x="0" y="126.0" fill="transparent" stroke="transparent" font-size="25">0</text></g><g class="vert-line"><rect x="40.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="60.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.22</text></g><g class="vert-line"><rect x="94.54545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="114.54545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.13</text></g><g class="vert-line"><rect x="149.0909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="169.0909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0.15</text></g><g class="vert-line"><rect x="203.63636363636363" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="223.63636363636363" y="20" fill="transparent" stroke="transparent" font-size="30px">0.13</text></g><g class="vert-line"><rect x="258.1818181818182" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="278.1818181818182" y="20" fill="transparent" stroke="transparent" font-size="30px">0.13</text></g><g class="vert-line"><rect x="312.72727272727275" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="332.72727272727275" y="20" fill="transparent" stroke="transparent" font-size="30px">0.071</text></g><g class="vert-line"><rect x="367.27272727272725" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="387.27272727272725" y="20" fill="transparent" stroke="transparent" font-size="30px">0.22</text></g><g class="vert-line"><rect x="421.8181818181818" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="441.8181818181818" y="20" fill="transparent" stroke="transparent" font-size="30px">0.32</text></g><g class="vert-line"><rect x="476.3636363636364" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="496.3636363636364" y="20" fill="transparent" stroke="transparent" font-size="30px">0.35</text></g><g class="vert-line"><rect x="530.909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="550.909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0.21</text></g><g class="vert-line"><rect x="585.4545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="605.4545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.19</text></g><g class="vert-line"><rect x="640.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="660.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.22</text></g>
</svg>
</div></td>
</tr>
<tr class="even">
<td class="gt_row gt_center">TAS1</td>
<td class="gt_row gt_center" style="color: #000000; background-color: #8dcf86">23.12</td>
<td class="gt_row gt_center" style="color: #000000; background-color: #31a354">0.0</td>
<td class="gt_row gt_center" style="color: #000000; background-color: #44ad5e">5.43</td>
<td class="gt_row gt_center"><div>
<svg role="img" viewbox="0 0 700 130" style="height: 2em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="22.5" y1="115.0" x2="677.5" y2="115.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="30.0" y="58.39622641509434" width="40" height="56.60377358490566" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="84.54545454545455" y="71.60377358490567" width="40" height="43.39622641509433" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="139.0909090909091" y="84.81132075471699" width="40" height="30.188679245283012" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="193.63636363636363" y="101.79245283018868" width="40" height="13.20754716981132" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="248.1818181818182" y="111.22641509433963" width="40" height="3.773584905660371" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="302.72727272727275" y="109.33962264150944" width="40" height="5.660377358490564" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="357.27272727272725" y="103.67924528301887" width="40" height="11.320754716981128" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="411.8181818181818" y="84.81132075471699" width="40" height="30.188679245283012" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="466.3636363636364" y="41.415094339622634" width="40" height="73.58490566037736" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="520.909090909091" y="41.415094339622634" width="40" height="73.58490566037736" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="575.4545454545455" y="54.62264150943396" width="40" height="60.37735849056604" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="630.0" y="15.0" width="40" height="100.0" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><g class="y-axis-line"><rect x="0" y="0" width="65" height="130" stroke="transparent" stroke-width="0" fill="transparent"></rect><text x="0" y="19.0" fill="transparent" stroke="transparent" font-size="25">0.053</text><text x="0" y="126.0" fill="transparent" stroke="transparent" font-size="25">0</text></g><g class="vert-line"><rect x="40.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="60.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.030</text></g><g class="vert-line"><rect x="94.54545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="114.54545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.023</text></g><g class="vert-line"><rect x="149.0909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="169.0909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0.016</text></g><g class="vert-line"><rect x="203.63636363636363" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="223.63636363636363" y="20" fill="transparent" stroke="transparent" font-size="30px">7.0E−03</text></g><g class="vert-line"><rect x="258.1818181818182" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="278.1818181818182" y="20" fill="transparent" stroke="transparent" font-size="30px">2.0E−03</text></g><g class="vert-line"><rect x="312.72727272727275" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="332.72727272727275" y="20" fill="transparent" stroke="transparent" font-size="30px">3.0E−03</text></g><g class="vert-line"><rect x="367.27272727272725" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="387.27272727272725" y="20" fill="transparent" stroke="transparent" font-size="30px">6.0E−03</text></g><g class="vert-line"><rect x="421.8181818181818" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="441.8181818181818" y="20" fill="transparent" stroke="transparent" font-size="30px">0.016</text></g><g class="vert-line"><rect x="476.3636363636364" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="496.3636363636364" y="20" fill="transparent" stroke="transparent" font-size="30px">0.039</text></g><g class="vert-line"><rect x="530.909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="550.909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0.039</text></g><g class="vert-line"><rect x="585.4545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="605.4545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.032</text></g><g class="vert-line"><rect x="640.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="660.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.053</text></g>
</svg>
</div></td>
<td class="gt_row gt_center"><div>
<svg role="img" viewbox="0 0 700 130" style="height: 2em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="22.5" y1="65.0" x2="677.5" y2="65.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="30.0" y="64.0" width="40" height="2" stroke="#808080" stroke-width="4" fill="#808080"></rect><rect x="84.54545454545455" y="64.0" width="40" height="2" stroke="#808080" stroke-width="4" fill="#808080"></rect><rect x="139.0909090909091" y="64.0" width="40" height="2" stroke="#808080" stroke-width="4" fill="#808080"></rect><rect x="193.63636363636363" y="64.0" width="40" height="2" stroke="#808080" stroke-width="4" fill="#808080"></rect><rect x="248.1818181818182" y="64.0" width="40" height="2" stroke="#808080" stroke-width="4" fill="#808080"></rect><rect x="302.72727272727275" y="64.0" width="40" height="2" stroke="#808080" stroke-width="4" fill="#808080"></rect><rect x="357.27272727272725" y="64.0" width="40" height="2" stroke="#808080" stroke-width="4" fill="#808080"></rect><rect x="411.8181818181818" y="64.0" width="40" height="2" stroke="#808080" stroke-width="4" fill="#808080"></rect><rect x="466.3636363636364" y="64.0" width="40" height="2" stroke="#808080" stroke-width="4" fill="#808080"></rect><rect x="520.909090909091" y="64.0" width="40" height="2" stroke="#808080" stroke-width="4" fill="#808080"></rect><rect x="575.4545454545455" y="64.0" width="40" height="2" stroke="#808080" stroke-width="4" fill="#808080"></rect><rect x="630.0" y="64.0" width="40" height="2" stroke="#808080" stroke-width="4" fill="#808080"></rect><g class="y-axis-line"><rect x="0" y="0" width="65" height="130" stroke="transparent" stroke-width="0" fill="transparent"></rect><text x="0" y="19.0" fill="transparent" stroke="transparent" font-size="25">5</text><text x="0" y="126.0" fill="transparent" stroke="transparent" font-size="25">-5</text></g><g class="vert-line"><rect x="40.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="60.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0</text></g><g class="vert-line"><rect x="94.54545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="114.54545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0</text></g><g class="vert-line"><rect x="149.0909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="169.0909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0</text></g><g class="vert-line"><rect x="203.63636363636363" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="223.63636363636363" y="20" fill="transparent" stroke="transparent" font-size="30px">0</text></g><g class="vert-line"><rect x="258.1818181818182" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="278.1818181818182" y="20" fill="transparent" stroke="transparent" font-size="30px">0</text></g><g class="vert-line"><rect x="312.72727272727275" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="332.72727272727275" y="20" fill="transparent" stroke="transparent" font-size="30px">0</text></g><g class="vert-line"><rect x="367.27272727272725" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="387.27272727272725" y="20" fill="transparent" stroke="transparent" font-size="30px">0</text></g><g class="vert-line"><rect x="421.8181818181818" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="441.8181818181818" y="20" fill="transparent" stroke="transparent" font-size="30px">0</text></g><g class="vert-line"><rect x="476.3636363636364" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="496.3636363636364" y="20" fill="transparent" stroke="transparent" font-size="30px">0</text></g><g class="vert-line"><rect x="530.909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="550.909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0</text></g><g class="vert-line"><rect x="585.4545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="605.4545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0</text></g><g class="vert-line"><rect x="640.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="660.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0</text></g>
</svg>
</div></td>
<td class="gt_row gt_center"><div>
<svg role="img" viewbox="0 0 700 130" style="height: 2em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="22.5" y1="115.0" x2="677.5" y2="115.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="30.0" y="78.63636363636363" width="40" height="36.363636363636374" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="84.54545454545455" y="93.18181818181817" width="40" height="21.818181818181827" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="139.0909090909091" y="89.54545454545453" width="40" height="25.454545454545467" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="193.63636363636363" y="101.36363636363636" width="40" height="13.63636363636364" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="248.1818181818182" y="95.9090909090909" width="40" height="19.090909090909093" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="302.72727272727275" y="85.9090909090909" width="40" height="29.090909090909093" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="357.27272727272725" y="75.9090909090909" width="40" height="39.09090909090909" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="411.8181818181818" y="60.45454545454546" width="40" height="54.54545454545454" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="466.3636363636364" y="15.0" width="40" height="100.0" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="520.909090909091" y="61.36363636363636" width="40" height="53.63636363636364" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="575.4545454545455" y="76.81818181818181" width="40" height="38.18181818181819" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="630.0" y="63.18181818181818" width="40" height="51.81818181818182" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><g class="y-axis-line"><rect x="0" y="0" width="65" height="130" stroke="transparent" stroke-width="0" fill="transparent"></rect><text x="0" y="19.0" fill="transparent" stroke="transparent" font-size="25">0.11</text><text x="0" y="126.0" fill="transparent" stroke="transparent" font-size="25">0</text></g><g class="vert-line"><rect x="40.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="60.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.040</text></g><g class="vert-line"><rect x="94.54545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="114.54545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.024</text></g><g class="vert-line"><rect x="149.0909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="169.0909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0.028</text></g><g class="vert-line"><rect x="203.63636363636363" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="223.63636363636363" y="20" fill="transparent" stroke="transparent" font-size="30px">0.015</text></g><g class="vert-line"><rect x="258.1818181818182" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="278.1818181818182" y="20" fill="transparent" stroke="transparent" font-size="30px">0.021</text></g><g class="vert-line"><rect x="312.72727272727275" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="332.72727272727275" y="20" fill="transparent" stroke="transparent" font-size="30px">0.032</text></g><g class="vert-line"><rect x="367.27272727272725" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="387.27272727272725" y="20" fill="transparent" stroke="transparent" font-size="30px">0.043</text></g><g class="vert-line"><rect x="421.8181818181818" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="441.8181818181818" y="20" fill="transparent" stroke="transparent" font-size="30px">0.060</text></g><g class="vert-line"><rect x="476.3636363636364" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="496.3636363636364" y="20" fill="transparent" stroke="transparent" font-size="30px">0.11</text></g><g class="vert-line"><rect x="530.909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="550.909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0.059</text></g><g class="vert-line"><rect x="585.4545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="605.4545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.042</text></g><g class="vert-line"><rect x="640.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="660.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.057</text></g>
</svg>
</div></td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">VIC1</td>
<td class="gt_row gt_center" style="color: #000000; background-color: #bce3a3">30.12</td>
<td class="gt_row gt_center" style="color: #000000; background-color: #fdfdb3">47.78</td>
<td class="gt_row gt_center" style="color: #000000; background-color: #61ba6d">13.4</td>
<td class="gt_row gt_center"><div>
<svg role="img" viewbox="0 0 700 130" style="height: 2em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="22.5" y1="115.0" x2="677.5" y2="115.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="30.0" y="50.656836461126005" width="40" height="64.343163538874" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="84.54545454545455" y="50.031277926720286" width="40" height="64.96872207327971" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="139.0909090909091" y="63.436103663985705" width="40" height="51.563896336014295" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="193.63636363636363" y="89.62019660411082" width="40" height="25.379803395889184" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="248.1818181818182" y="101.59517426273459" width="40" height="13.404825737265412" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="302.72727272727275" y="101.952636282395" width="40" height="13.047363717604995" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="357.27272727272725" y="91.31814119749777" width="40" height="23.681858802502234" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="411.8181818181818" y="72.10455764075067" width="40" height="42.89544235924933" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="466.3636363636364" y="60.57640750670241" width="40" height="54.42359249329759" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="520.909090909091" y="34.12421805183199" width="40" height="80.87578194816801" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="575.4545454545455" y="45.74173369079534" width="40" height="69.25826630920466" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><rect x="630.0" y="15.0" width="40" height="100.0" stroke="#3290CC" stroke-width="4" fill="#FFE066"></rect><g class="y-axis-line"><rect x="0" y="0" width="65" height="130" stroke="transparent" stroke-width="0" fill="transparent"></rect><text x="0" y="19.0" fill="transparent" stroke="transparent" font-size="25">1.12</text><text x="0" y="126.0" fill="transparent" stroke="transparent" font-size="25">0</text></g><g class="vert-line"><rect x="40.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="60.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.72</text></g><g class="vert-line"><rect x="94.54545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="114.54545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.73</text></g><g class="vert-line"><rect x="149.0909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="169.0909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0.58</text></g><g class="vert-line"><rect x="203.63636363636363" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="223.63636363636363" y="20" fill="transparent" stroke="transparent" font-size="30px">0.28</text></g><g class="vert-line"><rect x="258.1818181818182" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="278.1818181818182" y="20" fill="transparent" stroke="transparent" font-size="30px">0.15</text></g><g class="vert-line"><rect x="312.72727272727275" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="332.72727272727275" y="20" fill="transparent" stroke="transparent" font-size="30px">0.15</text></g><g class="vert-line"><rect x="367.27272727272725" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="387.27272727272725" y="20" fill="transparent" stroke="transparent" font-size="30px">0.26</text></g><g class="vert-line"><rect x="421.8181818181818" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="441.8181818181818" y="20" fill="transparent" stroke="transparent" font-size="30px">0.48</text></g><g class="vert-line"><rect x="476.3636363636364" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="496.3636363636364" y="20" fill="transparent" stroke="transparent" font-size="30px">0.61</text></g><g class="vert-line"><rect x="530.909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="550.909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0.90</text></g><g class="vert-line"><rect x="585.4545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="605.4545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.78</text></g><g class="vert-line"><rect x="640.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="660.0" y="20" fill="transparent" stroke="transparent" font-size="30px">1.12</text></g>
</svg>
</div></td>
<td class="gt_row gt_center"><div>
<svg role="img" viewbox="0 0 700 130" style="height: 2em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="22.5" y1="115.0" x2="677.5" y2="115.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="30.0" y="19.91329479768785" width="40" height="95.08670520231215" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="84.54545454545455" y="15.0" width="40" height="100.0" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="139.0909090909091" y="29.45086705202312" width="40" height="85.54913294797689" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="193.63636363636363" y="78.29479768786126" width="40" height="36.70520231213874" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="248.1818181818182" y="93.75722543352602" width="40" height="21.242774566473983" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="302.72727272727275" y="100.83815028901734" width="40" height="14.161849710982665" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="357.27272727272725" y="91.01156069364161" width="40" height="23.988439306358387" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="411.8181818181818" y="76.84971098265896" width="40" height="38.15028901734104" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="466.3636363636364" y="54.45086705202312" width="40" height="60.54913294797688" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="520.909090909091" y="26.127167630057798" width="40" height="88.8728323699422" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="575.4545454545455" y="36.96531791907513" width="40" height="78.03468208092487" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><rect x="630.0" y="22.080924855491322" width="40" height="92.91907514450868" stroke="#3290CC" stroke-width="4" fill="#FDB324"></rect><g class="y-axis-line"><rect x="0" y="0" width="65" height="130" stroke="transparent" stroke-width="0" fill="transparent"></rect><text x="0" y="19.0" fill="transparent" stroke="transparent" font-size="25">0.69</text><text x="0" y="126.0" fill="transparent" stroke="transparent" font-size="25">0</text></g><g class="vert-line"><rect x="40.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="60.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.66</text></g><g class="vert-line"><rect x="94.54545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="114.54545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.69</text></g><g class="vert-line"><rect x="149.0909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="169.0909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0.59</text></g><g class="vert-line"><rect x="203.63636363636363" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="223.63636363636363" y="20" fill="transparent" stroke="transparent" font-size="30px">0.25</text></g><g class="vert-line"><rect x="258.1818181818182" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="278.1818181818182" y="20" fill="transparent" stroke="transparent" font-size="30px">0.15</text></g><g class="vert-line"><rect x="312.72727272727275" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="332.72727272727275" y="20" fill="transparent" stroke="transparent" font-size="30px">0.098</text></g><g class="vert-line"><rect x="367.27272727272725" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="387.27272727272725" y="20" fill="transparent" stroke="transparent" font-size="30px">0.17</text></g><g class="vert-line"><rect x="421.8181818181818" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="441.8181818181818" y="20" fill="transparent" stroke="transparent" font-size="30px">0.26</text></g><g class="vert-line"><rect x="476.3636363636364" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="496.3636363636364" y="20" fill="transparent" stroke="transparent" font-size="30px">0.42</text></g><g class="vert-line"><rect x="530.909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="550.909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0.62</text></g><g class="vert-line"><rect x="585.4545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="605.4545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.54</text></g><g class="vert-line"><rect x="640.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="660.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.64</text></g>
</svg>
</div></td>
<td class="gt_row gt_center"><div>
<svg role="img" viewbox="0 0 700 130" style="height: 2em; margin-left: auto; margin-right: auto; font-size: inherit; overflow: visible; vertical-align: middle; position:relative;">
<defs><pattern id="area_pattern" width="8" height="8" patternunits="userSpaceOnUse"><path class="pattern-line" d="M 0,8 l 8,-8 M -1,1 l 4,-4 M 6,10 l 4,-4" stroke="#FF0000" stroke-width="1.5" stroke-linecap="round" shape-rendering="geometricPrecision"></path></pattern></defs>
<style> text { font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace; stroke-width: 0.15em; paint-order: stroke; stroke-linejoin: round; cursor: default; } .vert-line:hover rect { fill: #911EB4; fill-opacity: 40%; stroke: #FFFFFF60; color: red; } .vert-line:hover text { stroke: white; fill: #212427; } .horizontal-line:hover text {stroke: white; fill: #212427; } .ref-line:hover rect { stroke: #FFFFFF60; } .ref-line:hover line { stroke: #FF0000; } .ref-line:hover text { stroke: white; fill: #212427; } .y-axis-line:hover rect { fill: #EDEDED; fill-opacity: 60%; stroke: #FFFFFF60; color: red; } .y-axis-line:hover text { stroke: white; stroke-width: 0.20em; fill: #1A1C1F; } </style>
<line x1="22.5" y1="115.0" x2="677.5" y2="115.0" stroke="#BFBFBF" stroke-width="4"></line><rect x="30.0" y="50.629921259842526" width="40" height="64.37007874015748" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="84.54545454545455" y="61.65354330708661" width="40" height="53.34645669291339" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="139.0909090909091" y="50.13779527559054" width="40" height="64.86220472440945" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="193.63636363636363" y="87.44094488188976" width="40" height="27.559055118110237" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="248.1818181818182" y="72.48031496062993" width="40" height="42.519685039370074" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="302.72727272727275" y="85.27559055118111" width="40" height="29.72440944881889" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="357.27272727272725" y="38.03149606299213" width="40" height="76.96850393700787" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="411.8181818181818" y="50.925196850393704" width="40" height="64.0748031496063" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="466.3636363636364" y="15.0" width="40" height="100.0" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="520.909090909091" y="37.34251968503936" width="40" height="77.65748031496064" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="575.4545454545455" y="60.2755905511811" width="40" height="54.7244094488189" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><rect x="630.0" y="48.07086614173228" width="40" height="66.92913385826772" stroke="#3290CC" stroke-width="4" fill="#3BBFE5"></rect><g class="y-axis-line"><rect x="0" y="0" width="65" height="130" stroke="transparent" stroke-width="0" fill="transparent"></rect><text x="0" y="19.0" fill="transparent" stroke="transparent" font-size="25">1.02</text><text x="0" y="126.0" fill="transparent" stroke="transparent" font-size="25">0</text></g><g class="vert-line"><rect x="40.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="60.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.65</text></g><g class="vert-line"><rect x="94.54545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="114.54545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.54</text></g><g class="vert-line"><rect x="149.0909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="169.0909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0.66</text></g><g class="vert-line"><rect x="203.63636363636363" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="223.63636363636363" y="20" fill="transparent" stroke="transparent" font-size="30px">0.28</text></g><g class="vert-line"><rect x="258.1818181818182" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="278.1818181818182" y="20" fill="transparent" stroke="transparent" font-size="30px">0.43</text></g><g class="vert-line"><rect x="312.72727272727275" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="332.72727272727275" y="20" fill="transparent" stroke="transparent" font-size="30px">0.30</text></g><g class="vert-line"><rect x="367.27272727272725" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="387.27272727272725" y="20" fill="transparent" stroke="transparent" font-size="30px">0.78</text></g><g class="vert-line"><rect x="421.8181818181818" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="441.8181818181818" y="20" fill="transparent" stroke="transparent" font-size="30px">0.65</text></g><g class="vert-line"><rect x="476.3636363636364" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="496.3636363636364" y="20" fill="transparent" stroke="transparent" font-size="30px">1.02</text></g><g class="vert-line"><rect x="530.909090909091" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="550.909090909091" y="20" fill="transparent" stroke="transparent" font-size="30px">0.79</text></g><g class="vert-line"><rect x="585.4545454545455" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="605.4545454545455" y="20" fill="transparent" stroke="transparent" font-size="30px">0.56</text></g><g class="vert-line"><rect x="640.0" y="0" width="20" height="130" stroke="transparent" stroke-width="12" fill="transparent"></rect><text x="660.0" y="20" fill="transparent" stroke="transparent" font-size="30px">0.68</text></g>
</svg>
</div></td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="even">
<td colspan="7" class="gt_sourcenote"><strong>Calculation</strong>: Curtailment = (Potential energy - Actual energy) / Potential energy * 100.</td>
</tr>
<tr class="odd">
<td colspan="7" class="gt_sourcenote"><strong>Note</strong>: there are currently no listed utility scale solar in the TAS1 <a href="https://explore.openelectricity.org.au/facilities/tas1/?tech=solar_utility&amp;status=operating,committed">Open Electricity Facilities</a></td>
</tr>
<tr class="even">
<td colspan="7" class="gt_sourcenote"><strong>Scenario</strong>: 8.2.1_6xVreCurtailReview (Zero coal &amp; 83% reduction in GPG).<br>
<br>
<strong>Scale-up objective from 2024 baseline</strong>: <em>NSW1-Black Coal: x0.0, NSW1-Gas: x0.5, NSW1-Rooftop Solar: x3.0, NSW1-Solar: x3.0, NSW1-Wind: x6.0, NSW1-Battery: x8.0, QLD1-Black Coal: x0.0, QLD1-Gas: x0.5, QLD1-Rooftop Solar: x3.0, QLD1-Solar: x3.0, QLD1-Wind: x6.0, QLD1-Battery: x6.0, SA1-Gas: x0.5, SA1-Rooftop Solar: x2.0, SA1-Solar: x3.0, SA1-Wind: x2.0, SA1-Battery: x6.0, TAS1-Gas: x0.5, TAS1-Rooftop Solar: x3.0, TAS1-Wind: x5.0, TAS1-Battery: x8.0, VIC1-Gas: x0.5, VIC1-Brown Coal: x0.0, VIC1-Rooftop Solar: x4.0, VIC1-Solar: x4.0, VIC1-Wind: x4.0, VIC1-Battery: x8.0</em></td>
</tr>
</tfoot>

</table>


</div>
        
</div>
</div>
</div>
<p>The model applies relatively harsh curtailment to rooftop solar. This is a result of curtailment already being incorporated into utility-scale solar availability (capacity) factors, which I’ve sourced and then calculated from AEMO’s NEMWEB dispatch data.</p>
<blockquote class="blockquote">
<p>Almost every large solar farm in Australia’s southeastern states will be forced to switch off at least one-third of the power they generate by 2027 as delays to critical energy transition projects cause major bottlenecks on the electricity grid. - Ryan Cropp, Australian Financial Review, Jul 10, 2025 <a href="https://www.afr.com/policy/energy-and-climate/solar-farms-forced-to-switch-off-due-to-energy-grid-logjam-20250710-p5mdw5">[link]</a>.</p>
</blockquote>
<blockquote class="blockquote">
<p>Large-scale solar is fast and cost-effective to build, but it’s also the most exposed to curtailment, especially when system security limits or negative prices hit in the middle of a sunny day. - Chris O’Keefe, Clean Energy Council.</p>
</blockquote>
<p>The built-in curtailment would likely, at least partially explain why AEMO uses solar and wind traces, rather than solely relying on historical data, in its ISP modelling.</p>
<p>Comparing rooftop solar with utility solar availability (capacity) factors in our network will help clarify this:</p>
<div id="82ce4b59" class="cell" data-execution_count="30">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>solar_cf <span class="op">=</span> n.generators_t.p_max_pu[[<span class="st">'SA1-SOLAR'</span>, <span class="st">'SA1-ROOFTOP-SOLAR'</span>,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'VIC1-SOLAR'</span>, <span class="st">'VIC1-ROOFTOP-SOLAR'</span>,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'QLD1-SOLAR'</span>, <span class="st">'QLD1-ROOFTOP-SOLAR'</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'NSW1-SOLAR'</span>, <span class="st">'NSW1-ROOFTOP-SOLAR'</span>]].reset_index()</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>solar_cf[<span class="st">'hour'</span>] <span class="op">=</span> solar_cf[<span class="st">'snapshot'</span>].dt.hour</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>hours <span class="op">=</span> <span class="bu">sorted</span>(solar_cf[<span class="st">'hour'</span>].unique())</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>even_hours <span class="op">=</span> [h <span class="cf">for</span> h <span class="kw">in</span> hours <span class="cf">if</span> h <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>]</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>even_positions <span class="op">=</span> [hours.index(h) <span class="cf">for</span> h <span class="kw">in</span> even_hours]</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>combos <span class="op">=</span> [</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'SA1-SOLAR'</span>, <span class="st">'SA1-ROOFTOP-SOLAR'</span>],</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'VIC1-SOLAR'</span>, <span class="st">'VIC1-ROOFTOP-SOLAR'</span>],</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'QLD1-SOLAR'</span>, <span class="st">'QLD1-ROOFTOP-SOLAR'</span>],</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'NSW1-SOLAR'</span>, <span class="st">'NSW1-ROOFTOP-SOLAR'</span>]</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    nrows<span class="op">=</span><span class="dv">2</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>),</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span>   <span class="co"># share y for common scale</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.35</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="bu">len</span>(hours))</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax, (sol_col, rt_col) <span class="kw">in</span> <span class="bu">zip</span>(axes, combos):</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>    sol_data <span class="op">=</span> [solar_cf[solar_cf[<span class="st">'hour'</span>]<span class="op">==</span>h][sol_col].dropna().values <span class="cf">for</span> h <span class="kw">in</span> hours]</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>    rt_data  <span class="op">=</span> [solar_cf[solar_cf[<span class="st">'hour'</span>]<span class="op">==</span>h][rt_col].dropna().values <span class="cf">for</span> h <span class="kw">in</span> hours]</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>    bp1 <span class="op">=</span> ax.boxplot(</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>        sol_data,</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>        positions<span class="op">=</span>x <span class="op">-</span> width<span class="op">/</span><span class="dv">2</span>, widths<span class="op">=</span>width, patch_artist<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>        boxprops<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">'#FDB324'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>        medianprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'blue'</span>),</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>        whiskerprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>        capprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>        flierprops<span class="op">=</span><span class="bu">dict</span>(markeredgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>    bp2 <span class="op">=</span> ax.boxplot(</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>        rt_data,</span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>        positions<span class="op">=</span>x <span class="op">+</span> width<span class="op">/</span><span class="dv">2</span>, widths<span class="op">=</span>width, patch_artist<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>        boxprops<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">'#FFE066'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>        medianprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'green'</span>),</span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>        whiskerprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>        capprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>        flierprops<span class="op">=</span><span class="bu">dict</span>(markeredgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f"</span><span class="sc">{</span>sol_col<span class="sc">}</span><span class="ss"> vs </span><span class="sc">{</span>rt_col<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>    ax.set_xticks(even_positions)</span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a>    ax.set_xticklabels(even_hours)</span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a>    ax.set_facecolor(<span class="st">'#F0FFFF'</span>)</span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># no individual ylabel here</span></span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a><span class="co"># shared legend</span></span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a>handles <span class="op">=</span> [bp1[<span class="st">"boxes"</span>][<span class="dv">0</span>], bp2[<span class="st">"boxes"</span>][<span class="dv">0</span>]]</span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a>labels  <span class="op">=</span> [<span class="st">'Utility-scale Solar'</span>, <span class="st">'Rooftop Solar'</span>]</span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a>fig.legend(handles, labels, loc<span class="op">=</span><span class="st">'upper center'</span>, ncol<span class="op">=</span><span class="dv">2</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">0.5</span>, <span class="fl">0.98</span>))</span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a><span class="co"># one common y-axis label</span></span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a>fig.supxlabel(<span class="st">'Hour of Day (2024)'</span>)</span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a>fig.supylabel(<span class="st">'Capacity Factor'</span>)</span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-65"><a href="#cb34-65" aria-hidden="true" tabindex="-1"></a>fig.tight_layout(rect<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.95</span>])</span>
<span id="cb34-66"><a href="#cb34-66" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="High-level_NEM_files/figure-html/cell-31-output-1.png" width="757" height="757" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>There is a clear midday <strong>plateau</strong> in utility solar output (orange boxplots), likely resulting from either <strong>negative market prices</strong> or <strong>network constraints</strong> such as congestion.</p>
<p>In Victoria, the curtailment plateau is especially pronounced. This is likely due to utility-scale solar farms being situated in parts of the network that experience congestion. Congestion arises when the network’s ability to transmit electricity is constrained, requiring operators to curtail solar generation despite sufficient solar resources being available.</p>
<div style="text-align: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/vic1-solar-operating.png" class="img-fluid figure-img"></p>
<figcaption>Operating utility solar in Victoria (Open Electricity)</figcaption>
</figure>
</div>
</div>
<blockquote class="blockquote">
<p>Under near-term operating conditions, connection points in Victoria have on average close to 50% curtailment for solar and 30% curtailment for wind. - AEMO, 2025 Enhanced Locational Information (ELI) Report <a href="https://aemo.com.au/-/media/files/electricity/nem/planning_and_forecasting/enhanced-locational-information/2025/2025-enhanced-locational-information-report.pdf?la=en">[link]</a></p>
</blockquote>
<blockquote class="blockquote">
<p>Further congestion is noted to impact the curtailment at north-west Victoria, due to local transmission network limitations and existing high level of renewable energy generation. - AEMO, 2025 ELI Report</p>
</blockquote>
<p>In contrast, <strong>rooftop solar</strong> is far more challenging to curtail in real-world conditions. Although mechanisms exist (such as the capability to remotely disconnect rooftop PV via regulations like South Australia’s Smarter Homes program), these are described as a “tool of last resort” and invoked only in extreme security conditions. The technical ability to enforce widespread, routine curtailment of rooftop systems is currently limited; implementing it more broadly would risk significant <strong>social license erosion</strong> unless there is a <em>massive uptake</em> of consumer energy resources such as batteries and electric vehicles, allowing households to store their own surplus solar for later use.</p>
<p>A similar dynamic is evident with wind output. The dip in wind is too pronounced to be natural drop-off in wind speed during the middle of the day.</p>
<div id="735d3401" class="cell" data-execution_count="31">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>wind_cf <span class="op">=</span> n.generators_t.p_max_pu[[<span class="st">'SA1-WIND'</span>, <span class="st">'SA1-ROOFTOP-SOLAR'</span>,</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'VIC1-WIND'</span>, <span class="st">'VIC1-ROOFTOP-SOLAR'</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'QLD1-WIND'</span>, <span class="st">'QLD1-ROOFTOP-SOLAR'</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'NSW1-WIND'</span>, <span class="st">'NSW1-ROOFTOP-SOLAR'</span>]].reset_index()</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>wind_cf[<span class="st">'hour'</span>] <span class="op">=</span> wind_cf[<span class="st">'snapshot'</span>].dt.hour</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>hours <span class="op">=</span> <span class="bu">sorted</span>(wind_cf[<span class="st">'hour'</span>].unique())</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>even_hours <span class="op">=</span> [h <span class="cf">for</span> h <span class="kw">in</span> hours <span class="cf">if</span> h <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>]</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>even_positions <span class="op">=</span> [hours.index(h) <span class="cf">for</span> h <span class="kw">in</span> even_hours]</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>combos <span class="op">=</span> [</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'SA1-WIND'</span>, <span class="st">'SA1-ROOFTOP-SOLAR'</span>],</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'VIC1-WIND'</span>, <span class="st">'VIC1-ROOFTOP-SOLAR'</span>],</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'QLD1-WIND'</span>, <span class="st">'QLD1-ROOFTOP-SOLAR'</span>],</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'NSW1-WIND'</span>, <span class="st">'NSW1-ROOFTOP-SOLAR'</span>]</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    nrows<span class="op">=</span><span class="dv">2</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>),</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span>   <span class="co"># share y for common scale</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.35</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="bu">len</span>(hours))</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax, (sol_col, rt_col) <span class="kw">in</span> <span class="bu">zip</span>(axes, combos):</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>    wind_data <span class="op">=</span> [wind_cf[wind_cf[<span class="st">'hour'</span>]<span class="op">==</span>h][sol_col].dropna().values <span class="cf">for</span> h <span class="kw">in</span> hours]</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>    rt_data  <span class="op">=</span> [wind_cf[wind_cf[<span class="st">'hour'</span>]<span class="op">==</span>h][rt_col].dropna().values <span class="cf">for</span> h <span class="kw">in</span> hours]</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>    bp1 <span class="op">=</span> ax.boxplot(</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>        wind_data,</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>        positions<span class="op">=</span>x <span class="op">-</span> width<span class="op">/</span><span class="dv">2</span>, widths<span class="op">=</span>width, patch_artist<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>        boxprops<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">'#3BBFE5'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>        medianprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'blue'</span>),</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>        whiskerprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>        capprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>        flierprops<span class="op">=</span><span class="bu">dict</span>(markeredgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>    bp2 <span class="op">=</span> ax.boxplot(</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>        rt_data,</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>        positions<span class="op">=</span>x <span class="op">+</span> width<span class="op">/</span><span class="dv">2</span>, widths<span class="op">=</span>width, patch_artist<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>        boxprops<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">'#FFE066'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>        medianprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'green'</span>),</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>        whiskerprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>        capprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>        flierprops<span class="op">=</span><span class="bu">dict</span>(markeredgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f"</span><span class="sc">{</span>sol_col<span class="sc">}</span><span class="ss"> vs </span><span class="sc">{</span>rt_col<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>    ax.set_xticks(even_positions)</span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>    ax.set_xticklabels(even_hours)</span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>    ax.set_facecolor(<span class="st">'#F0FFFF'</span>)</span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># no individual ylabel here</span></span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a><span class="co"># shared legend</span></span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a>handles <span class="op">=</span> [bp1[<span class="st">"boxes"</span>][<span class="dv">0</span>], bp2[<span class="st">"boxes"</span>][<span class="dv">0</span>]]</span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a>labels  <span class="op">=</span> [<span class="st">'Wind'</span>, <span class="st">'Rooftop Solar'</span>]</span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a>fig.legend(handles, labels, loc<span class="op">=</span><span class="st">'upper center'</span>, ncol<span class="op">=</span><span class="dv">2</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">0.5</span>, <span class="fl">0.98</span>))</span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a><span class="co"># one common y-axis label</span></span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a>fig.supxlabel(<span class="st">'Hour of Day (2024)'</span>)</span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>fig.supylabel(<span class="st">'Capacity Factor'</span>)</span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>fig.tight_layout(rect<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.95</span>])</span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="High-level_NEM_files/figure-html/cell-32-output-1.png" width="757" height="757" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="conclusion-and-next-steps" class="level3">
<h3 class="anchored" data-anchor-id="conclusion-and-next-steps">05 Conclusion and Next Steps</h3>
<p>This simple model demonstrates that achieving a high-penetration renewable energy grid is possible. However, there is an inherent trade-off between deploying large amounts of variable renewable energy and managing increased curtailment. The model focuses solely on power flow analysis and does not account for costs beyond assigning marginal costs to generators to enable least-cost dispatch. Additionally, I’ve assigned a very small negative marginal cost to storage units, encouraging batteries to charge earlier rather than at the last possible moment - an approach enabled by the model’s assumption of perfect foresight.</p>
<p>It is also important to note that there is no assurance the system would operate in a <strong>secure state</strong> within the <code>8.2.1_6xVreCurtailReview</code> scenario/network. Incorporating the necessary constraints to ensure secure system operation would introduce significant complexity and is reserved for future analysis. Additionally, this scenario is highly sensitive to increases in demand - a 5% rise, for instance, leads to unserved energy. This highlights the need for substantial overbuilding to create an adequate reserve buffer, which, in turn, further increases curtailment.</p>
<p>During the development of the <code>8.2.1_6xVreCurtailReview</code> scenario, several scenarios with aggressive coal reduction - such as <code>2_BalancedAggressiveTransition</code> - led to a doubling of gas-powered generation (GPG). This occurred because GPG was required to compensate for the loss of 75% of baseload capacity previously provided by coal. Further details can be found in the Appendix.</p>
<p>The high penetration VRE scenarios are also under-utilising hydro. Some of this can be explained by setting a small marginal price ($8.58) as per 2024 ISP Inputs and Assumptions workbook. An example of this marginal price sensitivity can be found in the Appendix. 2024 was a dry year, which also contributed to Hydro underperformance.</p>
<p>Potential future analysis would also incorporate:<br>
- increased transmission (lines/links currently stacked on top of each other as they join the same bus) - accurate geospatial resolution<br>
- more detailed costs, including capital costs, and<br>
- carbon emissions.</p>
</section>
<section id="appendix" class="level3">
<h3 class="anchored" data-anchor-id="appendix">06 Appendix</h3>
<p>As mentioned in the conclusion, there is no certainty around whether or not the <code>8.2.1_6xVreCurtailReview</code> network could operate in a secure state.</p>
<p>It is possible to determine in rough terms, how often for example the network would be issued Lack of Reserve (LOR) notices by the system operator. Here we’ll use the per region thresholds published by AEMO.</p>
<p>It is worth noting that these reserve requirements are dynamic and always changing, see example below of a recent LOR notice from AEMO in reference to the South Australian region:</p>
<div style="text-align: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/lor-notice-example.png" class="img-fluid figure-img"></p>
<figcaption>LOR notice example showing dynamic reserve requirements</figcaption>
</figure>
</div>
</div>
<div id="02a4ae91" class="cell" data-execution_count="32">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_reserve_breaches_df(n, threshold_mw<span class="op">=</span><span class="dv">850</span>):</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Count how many hours in 2024 the reserve margin</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co">    (available capacity minus load) at each bus dips below threshold_mw.</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns a DataFrame with breach counts and breach ratios.</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co">    n : pypsa.Network</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="co">        A solved PyPSA network.</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co">    threshold_mw : float or dict</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="co">        If float, same threshold (in MW) for every bus.</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="co">        If dict, keys are bus names and values are thresholds for those buses;</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co">        any bus not in the dict uses the global default (if provided) or 0.</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="co">    pd.DataFrame</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="co">        DataFrame with columns:</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a><span class="co">          'breach_hours': number of hours below threshold</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a><span class="co">          'breach_ratio': breach_hours / total_snapshots</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="co">        Index is bus name.</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>    avail <span class="op">=</span> n.generators_t.p_max_pu.multiply(n.generators.p_nom, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>    avail_by_bus <span class="op">=</span> avail.T.groupby(n.generators.bus).<span class="bu">sum</span>().T</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>    loads <span class="op">=</span> n.loads_t.p_set</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>    load_by_bus <span class="op">=</span> loads.T.groupby(n.loads.bus).<span class="bu">sum</span>().T</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>    all_buses <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>(avail_by_bus.columns) <span class="op">|</span> <span class="bu">set</span>(load_by_bus.columns))</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>    avail_by_bus <span class="op">=</span> avail_by_bus.reindex(columns<span class="op">=</span>all_buses, fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>    load_by_bus  <span class="op">=</span> load_by_bus.reindex(columns<span class="op">=</span>all_buses, fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>    avail_by_bus <span class="op">=</span> avail_by_bus.reindex(index<span class="op">=</span>load_by_bus.index, fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>    reserve <span class="op">=</span> avail_by_bus.subtract(load_by_bus, fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(threshold_mw, <span class="bu">dict</span>):</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>        thresh <span class="op">=</span> pd.Series({bus: threshold_mw.get(bus, <span class="fl">0.0</span>) <span class="cf">for</span> bus <span class="kw">in</span> all_buses})</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>        thresh <span class="op">=</span> pd.Series(threshold_mw, index<span class="op">=</span>all_buses)</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>    breaches <span class="op">=</span> (reserve.lt(thresh, axis<span class="op">=</span><span class="dv">1</span>)).<span class="bu">sum</span>()</span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>    total_snapshots <span class="op">=</span> reserve.shape[<span class="dv">0</span>]</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>        <span class="st">'breach_hours'</span>: breaches,</span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>        <span class="st">'breach_ratio'</span>: breaches <span class="op">/</span> total_snapshots</span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a><span class="co"># For per-region thresholds</span></span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Source: 2024 ISP Inputs and Assumptions workbook.xlsx (sheet: Reserves)</span></span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>per_region <span class="op">=</span> {<span class="st">"NSW1"</span>:<span class="dv">705</span>, <span class="st">"VIC1"</span>:<span class="dv">550</span>, <span class="st">"QLD1"</span>:<span class="dv">710</span>, <span class="st">"SA1"</span>:<span class="dv">195</span>, <span class="st">"TAS1"</span>:<span class="dv">140</span>}</span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>count_reserve_breaches_df(n, threshold_mw<span class="op">=</span>per_region)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="32">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">breach_hours</th>
<th data-quarto-table-cell-role="th">breach_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">bus</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">NSW1</td>
<td>3229</td>
<td>0.367600</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">QLD1</td>
<td>2174</td>
<td>0.247495</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SA1</td>
<td>2707</td>
<td>0.308174</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">TAS1</td>
<td>1799</td>
<td>0.204804</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">VIC1</td>
<td>2026</td>
<td>0.230647</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>New South Wales is attracting the most breaches at just over one third of hours breached.</p>
<p>We can take a quick look at the gas generation coverage.</p>
<div id="72af2ad4" class="cell" data-execution_count="33">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>gas <span class="op">=</span> (</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    n.generators</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>     .query(<span class="st">"carrier == 'Gas'"</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>     .<span class="bu">filter</span>([<span class="st">'bus'</span>,<span class="st">'p_nom'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>     .reset_index()</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>     .rename(columns<span class="op">=</span>{<span class="st">'index'</span>:<span class="st">'name'</span>})</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co"># add per-region lookup</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>gas[<span class="st">'reserve'</span>] <span class="op">=</span> gas[<span class="st">'bus'</span>].<span class="bu">map</span>(per_region)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>gas <span class="op">=</span> gas[[<span class="st">'bus'</span>, <span class="st">'p_nom'</span>, <span class="st">'reserve'</span>]]</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>gas</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">bus</th>
<th data-quarto-table-cell-role="th">p_nom</th>
<th data-quarto-table-cell-role="th">reserve</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NSW1</td>
<td>1639.0</td>
<td>705</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>QLD1</td>
<td>1601.0</td>
<td>710</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>SA1</td>
<td>1704.0</td>
<td>195</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>TAS1</td>
<td>186.0</td>
<td>140</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>VIC1</td>
<td>1245.5</td>
<td>550</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>There is enough reserve of gas capacity, however the model will operate under this on many occasions (as highlighted above), unless a custom constraint is added, which will increase solver run times.</p>
<section id="generator-sensitivity-to-marginal-costs" class="level4">
<h4 class="anchored" data-anchor-id="generator-sensitivity-to-marginal-costs">Generator Sensitivity to Marginal Costs</h4>
<p>Review potential vs dispatch of Hydro in the current network. This example highlights how changing one input assumption can make a big difference to the dispatch result.</p>
<p>When the marginal price is set to $8.58 Hydro is seldomly dispatched - mainly in the winter months.</p>
<div id="6a7401d3" class="cell" data-execution_count="34">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot hydro dispatch vs potential</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_hydro_dispatch_vs_potential(n):</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    hydro_gens  <span class="op">=</span> n.generators.index[n.generators.carrier <span class="op">==</span> <span class="st">'Hydro'</span>]</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    hydro_cols  <span class="op">=</span> hydro_gens.intersection(n.generators_t.p_max_pu.columns)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    n_hydro     <span class="op">=</span> <span class="bu">len</span>(hydro_cols)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    ncols       <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    nrows       <span class="op">=</span> (n_hydro <span class="op">+</span> ncols <span class="op">-</span> <span class="dv">1</span>) <span class="op">//</span> ncols</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># set up the date locator/formatter once</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    locator   <span class="op">=</span> AutoDateLocator()</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    formatter <span class="op">=</span> ConciseDateFormatter(locator)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>        nrows<span class="op">=</span>nrows, ncols<span class="op">=</span>ncols,</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>        figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">4</span><span class="op">*</span>nrows),</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>        sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>    axes <span class="op">=</span> axes.flatten()</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>    legend_handles, legend_labels <span class="op">=</span> [], []</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, gen <span class="kw">in</span> <span class="bu">enumerate</span>(hydro_cols):</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>        ax <span class="op">=</span> axes[i]</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>        potential <span class="op">=</span> n.generators_t.p_max_pu[gen] <span class="op">*</span> n.generators.loc[gen, <span class="st">'p_nom'</span>]</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>        dispatch  <span class="op">=</span> n.generators_t.p[gen]</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>        ln1 <span class="op">=</span> ax.plot(</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>            n.snapshots, potential,</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">'Potential'</span>, linestyle<span class="op">=</span><span class="st">':'</span>, color<span class="op">=</span><span class="st">'orange'</span>, alpha<span class="op">=</span><span class="fl">0.6</span></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>        ln2 <span class="op">=</span> ax.plot(</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>            n.snapshots, dispatch,</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">'Dispatch'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, color<span class="op">=</span><span class="st">'#1E81D4'</span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># apply concise date formatting</span></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>        ax.xaxis.set_major_locator(locator)</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>        ax.xaxis.set_major_formatter(formatter)</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>        ax.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelrotation<span class="op">=</span><span class="dv">0</span>, labelsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="ss">f'Hydro Gen: </span><span class="sc">{</span>gen<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>        ax.set_facecolor(<span class="st">'#F0FFFF'</span>)</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>        ax.grid(<span class="va">True</span>)</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>            legend_handles <span class="op">=</span> ln1 <span class="op">+</span> ln2</span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>            legend_labels  <span class="op">=</span> [<span class="st">'Potential'</span>, <span class="st">'Dispatch'</span>]</span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># drop any empty subplots</span></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i<span class="op">+</span><span class="dv">1</span>, <span class="bu">len</span>(axes)):</span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>        fig.delaxes(axes[j])</span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># one shared legend &amp; axis labels</span></span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>    fig.legend(legend_handles, legend_labels,</span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>               loc<span class="op">=</span><span class="st">'upper center'</span>, ncol<span class="op">=</span><span class="dv">2</span>, frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>    fig.supxlabel(<span class="st">'Time'</span>)</span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a>    fig.supylabel(<span class="st">'Power (MW)'</span>)</span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout(rect<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.95</span>])</span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a>plot_hydro_dispatch_vs_potential(n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="High-level_NEM_files/figure-html/cell-35-output-1.png" width="756" height="773" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now set marginal cost of Hydro generators to zero.</p>
<p>Optimize the network.</p>
<div id="136d259f" class="cell" data-execution_count="35">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ilustrate sensitivity of Hydro generation to marginal cost setting</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get indices of Hydro generators</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>hydro_gens <span class="op">=</span> n.generators.index[n.generators.carrier <span class="op">==</span> <span class="st">'Hydro'</span>]</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set marginal_cost to zero &amp; optimise</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>n.generators.loc[hydro_gens, <span class="st">'marginal_cost'</span>] <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>n.optimize()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>WARNING:pypsa.consistency:Encountered nan's in static data for columns ['max_growth', 'max_relative_growth', 'co2_emissions'] of component 'Carrier'.
INFO:linopy.model: Solve problem using Highs solver
INFO:linopy.io:Writing objective.
Writing constraints.:   0%|          | 0/21 [00:00&lt;?, ?it/s]Writing constraints.:  14%|█▍        | 3/21 [00:00&lt;00:05,  3.22it/s]Writing constraints.:  19%|█▉        | 4/21 [00:02&lt;00:09,  1.79it/s]Writing constraints.:  24%|██▍       | 5/21 [00:02&lt;00:06,  2.32it/s]Writing constraints.:  29%|██▊       | 6/21 [00:02&lt;00:05,  2.75it/s]Writing constraints.:  33%|███▎      | 7/21 [00:03&lt;00:07,  1.91it/s]Writing constraints.:  38%|███▊      | 8/21 [00:04&lt;00:08,  1.62it/s]Writing constraints.:  43%|████▎     | 9/21 [00:04&lt;00:06,  1.94it/s]Writing constraints.:  48%|████▊     | 10/21 [00:04&lt;00:04,  2.22it/s]Writing constraints.:  52%|█████▏    | 11/21 [00:04&lt;00:03,  2.63it/s]Writing constraints.:  57%|█████▋    | 12/21 [00:05&lt;00:03,  2.98it/s]Writing constraints.:  62%|██████▏   | 13/21 [00:05&lt;00:02,  3.64it/s]Writing constraints.:  67%|██████▋   | 14/21 [00:05&lt;00:01,  4.14it/s]Writing constraints.:  71%|███████▏  | 15/21 [00:05&lt;00:01,  4.66it/s]Writing constraints.:  76%|███████▌  | 16/21 [00:05&lt;00:01,  4.92it/s]Writing constraints.:  81%|████████  | 17/21 [00:05&lt;00:00,  5.59it/s]Writing constraints.:  86%|████████▌ | 18/21 [00:06&lt;00:00,  5.70it/s]Writing constraints.:  90%|█████████ | 19/21 [00:07&lt;00:01,  1.76it/s]Writing constraints.:  95%|█████████▌| 20/21 [00:07&lt;00:00,  2.05it/s]Writing constraints.: 100%|██████████| 21/21 [00:08&lt;00:00,  2.12it/s]Writing constraints.: 100%|██████████| 21/21 [00:08&lt;00:00,  2.54it/s]
Writing continuous variables.:   0%|          | 0/7 [00:00&lt;?, ?it/s]Writing continuous variables.:  29%|██▊       | 2/7 [00:00&lt;00:02,  2.45it/s]Writing continuous variables.:  43%|████▎     | 3/7 [00:01&lt;00:01,  3.11it/s]Writing continuous variables.:  57%|█████▋    | 4/7 [00:01&lt;00:00,  3.71it/s]Writing continuous variables.:  71%|███████▏  | 5/7 [00:01&lt;00:00,  4.62it/s]Writing continuous variables.:  86%|████████▌ | 6/7 [00:01&lt;00:00,  5.47it/s]Writing continuous variables.: 100%|██████████| 7/7 [00:01&lt;00:00,  6.34it/s]Writing continuous variables.: 100%|██████████| 7/7 [00:01&lt;00:00,  4.56it/s]
INFO:linopy.io: Writing time: 10.21s
INFO:linopy.constants: Optimization successful: 
Status: ok
Termination condition: optimal
Solution: 606101 primals, 1651363 duals
Objective: 1.87e+08
Solver model: available
Solver message: Optimal

INFO:pypsa.optimization.optimize:The shadow-prices of the constraints Generator-fix-p-lower, Generator-fix-p-upper, Generator-ext-p-lower, Generator-ext-p-upper, Generator-fix-p-ramp_limit_up, Generator-fix-p-ramp_limit_down, Line-fix-s-lower, Line-fix-s-upper, Link-fix-p-lower, Link-fix-p-upper, StorageUnit-fix-p_dispatch-lower, StorageUnit-fix-p_dispatch-upper, StorageUnit-fix-p_store-lower, StorageUnit-fix-p_store-upper, StorageUnit-fix-state_of_charge-lower, StorageUnit-fix-state_of_charge-upper, Kirchhoff-Voltage-Law, StorageUnit-energy_balance were not assigned to the network.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>('ok', 'optimal')</code></pre>
</div>
</div>
<p>Run the same function again to compare the difference.</p>
<div id="fe9494b7" class="cell" data-execution_count="36">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-run function</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>plot_hydro_dispatch_vs_potential(n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="High-level_NEM_files/figure-html/cell-37-output-1.png" width="756" height="773" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="gpg-in-2_balancedaggressivetransition" class="level5">
<h5 class="anchored" data-anchor-id="gpg-in-2_balancedaggressivetransition">GPG in 2_BalancedAggressiveTransition</h5>
<p>The <code>2_BalancedAggressiveTransition</code> scenario has a 75% reduction in coal and only a mild increase in renewables and storage (see table below).</p>
<p>This indicates that without rapidly expanding renewables and storage, phasing out coal will strain gas generators and related infrastructure, as this scenario sees gas-powered generation rise by 107% compared to Open Electricity consumption over a recent 12 month period.</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Filter scenario</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>df_bat <span class="op">=</span> results_tbl[results_tbl[<span class="st">"Scenario"</span>] <span class="op">==</span> <span class="st">"2_BalancedAggressiveTransition"</span>].copy()</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Compute the % change vs 10,919 GWh. Source: Open Electricity Data (note this will change regularly because it is a rolling 12-month period)</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>base <span class="op">=</span> <span class="dv">10919</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>df_bat[<span class="st">"Gas Δ% vs 10919GWh"</span>] <span class="op">=</span> (df_bat[<span class="st">"Gas Generation (GWh)"</span>] <span class="op">-</span> base) <span class="op">/</span> base <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Insert the new column right after “Gas Generation (GWh)”</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>col_idx <span class="op">=</span> df_bat.columns.get_loc(<span class="st">"Gas Generation (GWh)"</span>)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>df_bat.insert(col_idx<span class="op">+</span><span class="dv">1</span>, <span class="st">"Gas Δ% vs 10919GWh"</span>, df_bat.pop(<span class="st">"Gas Δ% vs 10919GWh"</span>))</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>html_bat_table <span class="op">=</span> df_bat.iloc[:, :<span class="dv">5</span>].to_html(escape<span class="op">=</span><span class="va">False</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>html_bat_table <span class="op">=</span> html_bat_table.replace(<span class="st">'&lt;table'</span>, </span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'&lt;table style="width: 100%; table-layout: fixed; font-size: 11px; font-family: monospace;"'</span>)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>html_bat_table <span class="op">=</span> html_bat_table.replace(<span class="st">'&lt;td'</span>, </span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'&lt;td style="min-width: 250px; word-wrap: break-word; padding: 4px;"'</span>)</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>html_bat_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<table style="width: 100%; table-layout: fixed; font-size: 11px; font-family: monospace;" class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Scenario
</th>

<th>
Objective
</th>

<th>
Gas Generation (GWh)
</th>

<th>
Gas Δ% vs 10919GWh
</th>

<th>
Generator Capacity (GW)
</th>

</tr>

</thead>

<tbody>

<tr>

<td style="min-width: 250px; word-wrap: break-word; padding: 4px;">
2_BalancedAggressiveTransition
</td>

<td style="min-width: 250px; word-wrap: break-word; padding: 4px;">
NSW1-Black Coal: x0.25<br>NSW1-Rooftop Solar: x1.25<br>NSW1-Solar: x1.25<br>NSW1-Wind: x1.3<br>NSW1-Battery: x2.0<br>QLD1-Black Coal: x0.25<br>QLD1-Rooftop Solar: x1.25<br>QLD1-Solar: x1.25<br>QLD1-Wind: x1.3<br>QLD1-Battery: x2.0<br>SA1-Rooftop Solar: x1.25<br>SA1-Solar: x1.25<br>SA1-Wind: x1.3<br>SA1-Battery: x2.0<br>TAS1-Wind: x1.3<br>TAS1-Battery: x2.0<br>VIC1-Brown Coal: x0.25<br>VIC1-Rooftop Solar: x1.25<br>VIC1-Solar: x1.25<br>VIC1-Wind: x1.3<br>VIC1-Battery: x2.0
</td>

<td style="min-width: 250px; word-wrap: break-word; padding: 4px;">
22599.405
</td>

<td style="min-width: 250px; word-wrap: break-word; padding: 4px;">
106.973212
</td>

<td style="min-width: 250px; word-wrap: break-word; padding: 4px;">
Black Coal: 4097.25<br>Brown Coal: 1172.5<br>Diesel: 1110.0<br>Gas: 12751.0<br>Hydro: 12808.0<br>Rooftop Solar: 19766.228<br>Solar: 19346.25<br>Wind: 20810.4
</td>

</tr>

</tbody>

</table>
<p>Load the <code>2_BalancedAggressiveTransition</code> network. This scenario has a 75% reduction in coal and a limited increase in renewables and storage.</p>
<div id="696cb4e3" class="cell" data-execution_count="38">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the network for the specific scenario</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> pypsa.Network(<span class="st">"results/scenarios/scenario_2_BalancedAggressiveTransition.nc"</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Metadata to provide as arguments to the plot_dispatch() function.</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>scenario <span class="op">=</span> <span class="st">"2_BalancedAggressiveTransition"</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>objective_text <span class="op">=</span> df_results.loc[df_results[<span class="st">"Scenario"</span>] <span class="op">==</span> scenario, <span class="st">"Objective"</span>].values[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>INFO:pypsa.io:Imported network scenario_2_BalancedAggressiveTransition.nc has buses, carriers, generators, lines, links, loads, storage_units</code></pre>
</div>
</div>
<p>Review a previous dispatch period over 10 days in Victoria.</p>
<div id="bf5f85bc" class="cell" data-execution_count="39">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>plot_dispatch(n, time<span class="op">=</span><span class="st">"2024-05-18"</span>, days<span class="op">=</span><span class="dv">10</span>, regions<span class="op">=</span>[<span class="st">"VIC1"</span>], show_imports<span class="op">=</span><span class="va">True</span>, scenario_name<span class="op">=</span>scenario, scenario_objective<span class="op">=</span>objective_text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="High-level_NEM_files/figure-html/cell-40-output-1.png" width="795" height="601" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="generate-scenarios-function" class="level5">
<h5 class="anchored" data-anchor-id="generate-scenarios-function">Generate Scenarios Function</h5>
<p>Below is the function for generating scenarios from a CSV file.</p>
<p>Ensure any amendments are updated in the the input assumptions file and stored in <code>data/inputs/tech_assumptions.csv</code> before execution.</p>
<div id="4f2cfdcf" class="cell" data-execution_count="40">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Script to generate a simplified sensitivity analysis template</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># that can be plugged into a PyPSA workflow.</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co">###--- GENERATE SCENARIOS ---####</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Intergrate csv input assumptions for tech - this better documents scenarios</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dict_to_multiline_string(d):</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(<span class="ss">f"</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>v<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> k, v <span class="kw">in</span> d.items()) <span class="cf">if</span> d <span class="cf">else</span> <span class="st">""</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_scenarios(</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>        network,</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>        tech_assumptions_path,</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>        export_dir<span class="op">=</span><span class="st">"results/scenarios"</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>    ):</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="co">    Apply scaling from a technology-assumptions CSV, solve each scenario, export</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="co">    the solved network, and return a summary DataFrame.</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="co">    Extra metrics collected:</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="co">    • **Unserved Energy (GWh)** - total unserved energy across the system.</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a><span class="co">    • **Generator Capacity (GW)** - total generator capacity by carrier.</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="co">      (built-in `n.generators.p_nom`)</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a><span class="co">    • **Gas Generation (GWh)** - total dispatched energy from carrier 'Gas'.</span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a><span class="co">    • **Wind and Solar Curtailment (GWh)** - renewable curtailment across the whole</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a><span class="co">      system (built-in `n.statistics.curtailment`).</span></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a><span class="co">    • **Battery Capacity (GW)** - total battery storage capacity in the system.</span></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a><span class="co">    network : pypsa.Network</span></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a><span class="co">        The base PyPSA network object to scale up/down.</span></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a><span class="co">    tech_assumptions_path : str</span></span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a><span class="co">        Path to CSV file with scaling assumptions for generators/storage.</span></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a><span class="co">    export_dir : str, default "results/scenarios"</span></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a><span class="co">        Directory path to export .nc and CSV results.</span></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a><span class="co">    pandas.DataFrame</span></span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a><span class="co">        Scenario metrics including battery capacity (GW), generator capacity (GW), curtailment (GWh), unserved energy (GWh) and gas generation (GWh).</span></span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>    os.makedirs(export_dir, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a>    tech_df <span class="op">=</span> pd.read_csv(tech_assumptions_path)</span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a>    scenario_names <span class="op">=</span> tech_df[<span class="st">"scenario"</span>].unique()</span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a>    timer_all <span class="op">=</span> perf_counter()</span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> scenario <span class="kw">in</span> scenario_names:</span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\u2192</span><span class="ss"> Scenario: </span><span class="sc">{</span>scenario<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ── copy network ───────────────────────────────────────────────</span></span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a>        n <span class="op">=</span> network.copy(snapshots<span class="op">=</span>network.snapshots)</span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ── apply scaling from CSV ────────────────────────────────────</span></span>
<span id="cb47-61"><a href="#cb47-61" aria-hidden="true" tabindex="-1"></a>        df_s <span class="op">=</span> tech_df[tech_df[<span class="st">"scenario"</span>] <span class="op">==</span> scenario]</span>
<span id="cb47-62"><a href="#cb47-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _, row <span class="kw">in</span> df_s.iterrows():</span>
<span id="cb47-63"><a href="#cb47-63" aria-hidden="true" tabindex="-1"></a>            component, bus, carrier, scale <span class="op">=</span> (</span>
<span id="cb47-64"><a href="#cb47-64" aria-hidden="true" tabindex="-1"></a>                row[<span class="st">"component"</span>], row[<span class="st">"bus"</span>], row[<span class="st">"carrier"</span>], row[<span class="st">"scale_factor"</span>]</span>
<span id="cb47-65"><a href="#cb47-65" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb47-66"><a href="#cb47-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> component <span class="op">==</span> <span class="st">"generator"</span>:</span>
<span id="cb47-67"><a href="#cb47-67" aria-hidden="true" tabindex="-1"></a>                mask <span class="op">=</span> (n.generators.bus <span class="op">==</span> bus) <span class="op">&amp;</span> (n.generators.carrier <span class="op">==</span> carrier)</span>
<span id="cb47-68"><a href="#cb47-68" aria-hidden="true" tabindex="-1"></a>                n.generators.loc[mask, <span class="st">"p_nom"</span>] <span class="op">*=</span> scale</span>
<span id="cb47-69"><a href="#cb47-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">"p_nom_max"</span> <span class="kw">in</span> n.generators.columns:</span>
<span id="cb47-70"><a href="#cb47-70" aria-hidden="true" tabindex="-1"></a>                    n.generators.loc[mask, <span class="st">"p_nom_max"</span>] <span class="op">*=</span> scale</span>
<span id="cb47-71"><a href="#cb47-71" aria-hidden="true" tabindex="-1"></a>                n.generators.loc[mask, <span class="st">"p_nom_extendable"</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb47-72"><a href="#cb47-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> component <span class="op">==</span> <span class="st">"storage_unit"</span>:</span>
<span id="cb47-73"><a href="#cb47-73" aria-hidden="true" tabindex="-1"></a>                mask <span class="op">=</span> (n.storage_units.bus <span class="op">==</span> bus) <span class="op">&amp;</span> (n.storage_units.carrier <span class="op">==</span> carrier)</span>
<span id="cb47-74"><a href="#cb47-74" aria-hidden="true" tabindex="-1"></a>                n.storage_units.loc[mask, <span class="st">"p_nom"</span>] <span class="op">*=</span> scale</span>
<span id="cb47-75"><a href="#cb47-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">"p_nom_max"</span> <span class="kw">in</span> n.storage_units.columns:</span>
<span id="cb47-76"><a href="#cb47-76" aria-hidden="true" tabindex="-1"></a>                    n.storage_units.loc[mask, <span class="st">"p_nom_max"</span>] <span class="op">*=</span> scale</span>
<span id="cb47-77"><a href="#cb47-77" aria-hidden="true" tabindex="-1"></a>                n.storage_units.loc[mask, <span class="st">"p_nom_extendable"</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb47-78"><a href="#cb47-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-79"><a href="#cb47-79" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ── solve ──────────────────────────────────────────────────────</span></span>
<span id="cb47-80"><a href="#cb47-80" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Change to open source solver if required, default is HiGHS</span></span>
<span id="cb47-81"><a href="#cb47-81" aria-hidden="true" tabindex="-1"></a>        n.optimize()</span>
<span id="cb47-82"><a href="#cb47-82" aria-hidden="true" tabindex="-1"></a>        <span class="co"># n.optimize(solver_name="gurobi")</span></span>
<span id="cb47-83"><a href="#cb47-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-84"><a href="#cb47-84" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ── unserved energy ───────────────────────────────────────────</span></span>
<span id="cb47-85"><a href="#cb47-85" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"Unserved Energy"</span> <span class="kw">in</span> n.generators.carrier.values:</span>
<span id="cb47-86"><a href="#cb47-86" aria-hidden="true" tabindex="-1"></a>            ue_cols <span class="op">=</span> n.generators[n.generators.carrier <span class="op">==</span> <span class="st">"Unserved Energy"</span>].index</span>
<span id="cb47-87"><a href="#cb47-87" aria-hidden="true" tabindex="-1"></a>            ue_df <span class="op">=</span> n.generators_t.p[ue_cols]</span>
<span id="cb47-88"><a href="#cb47-88" aria-hidden="true" tabindex="-1"></a>            ue_GWh <span class="op">=</span> ue_df.<span class="bu">sum</span>().<span class="bu">sum</span>() <span class="op">/</span> <span class="fl">1e3</span></span>
<span id="cb47-89"><a href="#cb47-89" aria-hidden="true" tabindex="-1"></a>            ue_by_bus <span class="op">=</span> (</span>
<span id="cb47-90"><a href="#cb47-90" aria-hidden="true" tabindex="-1"></a>                ue_df.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb47-91"><a href="#cb47-91" aria-hidden="true" tabindex="-1"></a>                .groupby(n.generators.loc[ue_cols, <span class="st">"bus"</span>]).<span class="bu">sum</span>() <span class="op">/</span> <span class="fl">1e3</span></span>
<span id="cb47-92"><a href="#cb47-92" aria-hidden="true" tabindex="-1"></a>            ).<span class="bu">round</span>(<span class="dv">3</span>).to_dict()</span>
<span id="cb47-93"><a href="#cb47-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb47-94"><a href="#cb47-94" aria-hidden="true" tabindex="-1"></a>            ue_GWh, ue_by_bus <span class="op">=</span> <span class="fl">0.0</span>, {}</span>
<span id="cb47-95"><a href="#cb47-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-96"><a href="#cb47-96" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ── gas energy ────────────────────────────────────────────────</span></span>
<span id="cb47-97"><a href="#cb47-97" aria-hidden="true" tabindex="-1"></a>        gas_idx <span class="op">=</span> n.generators.index[n.generators.carrier <span class="op">==</span> <span class="st">"Gas"</span>]</span>
<span id="cb47-98"><a href="#cb47-98" aria-hidden="true" tabindex="-1"></a>        gas_GWh <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb47-99"><a href="#cb47-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(gas_idx):</span>
<span id="cb47-100"><a href="#cb47-100" aria-hidden="true" tabindex="-1"></a>            gas_GWh <span class="op">=</span> n.generators_t.p[gas_idx].<span class="bu">sum</span>().<span class="bu">sum</span>() <span class="op">/</span> <span class="fl">1e3</span>  <span class="co"># to GWh</span></span>
<span id="cb47-101"><a href="#cb47-101" aria-hidden="true" tabindex="-1"></a>        gas_GWh <span class="op">=</span> <span class="bu">round</span>(gas_GWh, <span class="dv">3</span>)</span>
<span id="cb47-102"><a href="#cb47-102" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb47-103"><a href="#cb47-103" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ── curtailment (built‑in helper) ─────────────────────────</span></span>
<span id="cb47-104"><a href="#cb47-104" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">hasattr</span>(n, <span class="st">"statistics"</span>) <span class="kw">and</span> <span class="bu">hasattr</span>(n.statistics, <span class="st">"curtailment"</span>):</span>
<span id="cb47-105"><a href="#cb47-105" aria-hidden="true" tabindex="-1"></a>            curtailment_df <span class="op">=</span> n.statistics.curtailment()</span>
<span id="cb47-106"><a href="#cb47-106" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb47-107"><a href="#cb47-107" aria-hidden="true" tabindex="-1"></a>            existing_carriers <span class="op">=</span> curtailment_df.index.get_level_values(<span class="dv">1</span>).unique()</span>
<span id="cb47-108"><a href="#cb47-108" aria-hidden="true" tabindex="-1"></a>            wanted_carriers <span class="op">=</span> [<span class="st">'Wind'</span>, <span class="st">'Solar'</span>, <span class="st">'Rooftop Solar'</span>]</span>
<span id="cb47-109"><a href="#cb47-109" aria-hidden="true" tabindex="-1"></a>            valid_carriers <span class="op">=</span> [c <span class="cf">for</span> c <span class="kw">in</span> wanted_carriers <span class="cf">if</span> c <span class="kw">in</span> existing_carriers]</span>
<span id="cb47-110"><a href="#cb47-110" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid_carriers:</span>
<span id="cb47-111"><a href="#cb47-111" aria-hidden="true" tabindex="-1"></a>                vre_curt_GWh <span class="op">=</span> curtailment_df.loc[(<span class="bu">slice</span>(<span class="va">None</span>), valid_carriers)].<span class="bu">sum</span>() <span class="op">/</span> <span class="fl">1e3</span></span>
<span id="cb47-112"><a href="#cb47-112" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb47-113"><a href="#cb47-113" aria-hidden="true" tabindex="-1"></a>                vre_curt_GWh <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb47-114"><a href="#cb47-114" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb47-115"><a href="#cb47-115" aria-hidden="true" tabindex="-1"></a>            vre_curt_GWh <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb47-116"><a href="#cb47-116" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb47-117"><a href="#cb47-117" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ── Battery Capacity ─────────────────────────</span></span>
<span id="cb47-118"><a href="#cb47-118" aria-hidden="true" tabindex="-1"></a>        battery_carrier <span class="op">=</span> <span class="st">"Battery"</span>  <span class="co"># adjust as needed</span></span>
<span id="cb47-119"><a href="#cb47-119" aria-hidden="true" tabindex="-1"></a>        battery_mask <span class="op">=</span> n.storage_units.carrier <span class="op">==</span> battery_carrier</span>
<span id="cb47-120"><a href="#cb47-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-121"><a href="#cb47-121" aria-hidden="true" tabindex="-1"></a>        battery_capacity_GW <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb47-122"><a href="#cb47-122" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> battery_mask.<span class="bu">any</span>():</span>
<span id="cb47-123"><a href="#cb47-123" aria-hidden="true" tabindex="-1"></a>            battery_capacity_GW <span class="op">=</span> n.storage_units.loc[battery_mask, <span class="st">"p_nom"</span>].<span class="bu">sum</span>() <span class="op">/</span> <span class="fl">1e3</span>  <span class="co"># MW to GW</span></span>
<span id="cb47-124"><a href="#cb47-124" aria-hidden="true" tabindex="-1"></a>            battery_capacity_GW <span class="op">=</span> <span class="bu">round</span>(battery_capacity_GW, <span class="dv">3</span>)</span>
<span id="cb47-125"><a href="#cb47-125" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb47-126"><a href="#cb47-126" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ── Generator capacity by carrier ─────────────────────────</span></span>
<span id="cb47-127"><a href="#cb47-127" aria-hidden="true" tabindex="-1"></a>        capacity_by_carrier <span class="op">=</span> (</span>
<span id="cb47-128"><a href="#cb47-128" aria-hidden="true" tabindex="-1"></a>            n.generators[n.generators.carrier <span class="op">!=</span> <span class="st">'Unserved Energy'</span>]</span>
<span id="cb47-129"><a href="#cb47-129" aria-hidden="true" tabindex="-1"></a>            .groupby(<span class="st">"carrier"</span>)[<span class="st">"p_nom"</span>]</span>
<span id="cb47-130"><a href="#cb47-130" aria-hidden="true" tabindex="-1"></a>            .<span class="bu">sum</span>()</span>
<span id="cb47-131"><a href="#cb47-131" aria-hidden="true" tabindex="-1"></a>            .<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb47-132"><a href="#cb47-132" aria-hidden="true" tabindex="-1"></a>            .to_dict()</span>
<span id="cb47-133"><a href="#cb47-133" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb47-134"><a href="#cb47-134" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb47-135"><a href="#cb47-135" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ── collect metrics ───────────────────────────────────────────</span></span>
<span id="cb47-136"><a href="#cb47-136" aria-hidden="true" tabindex="-1"></a>        results.append({</span>
<span id="cb47-137"><a href="#cb47-137" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Scenario"</span>: scenario,</span>
<span id="cb47-138"><a href="#cb47-138" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Objective"</span>: <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(</span>
<span id="cb47-139"><a href="#cb47-139" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f"</span><span class="sc">{</span>r[<span class="st">'bus'</span>]<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>r[<span class="st">'carrier'</span>]<span class="sc">}</span><span class="ss">: x</span><span class="sc">{</span>r[<span class="st">'scale_factor'</span>]<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> _, r <span class="kw">in</span> df_s.iterrows()</span>
<span id="cb47-140"><a href="#cb47-140" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb47-141"><a href="#cb47-141" aria-hidden="true" tabindex="-1"></a>            <span class="co"># "Total System Cost (B$)": round(n.objective / 1e9, 3),</span></span>
<span id="cb47-142"><a href="#cb47-142" aria-hidden="true" tabindex="-1"></a>            <span class="co"># "Total New Capacity (GW)": round(n.generators.p_nom_opt.sum() / 1e3, 3),</span></span>
<span id="cb47-143"><a href="#cb47-143" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Gas Generation (GWh)"</span>: gas_GWh,</span>
<span id="cb47-144"><a href="#cb47-144" aria-hidden="true" tabindex="-1"></a>            <span class="co"># "Total Curtailment (GWh)": round(curt_GWh, 3),</span></span>
<span id="cb47-145"><a href="#cb47-145" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Battery Capacity (GW)"</span>: battery_capacity_GW,</span>
<span id="cb47-146"><a href="#cb47-146" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Generator Capacity (GW)"</span>: dict_to_multiline_string(capacity_by_carrier),</span>
<span id="cb47-147"><a href="#cb47-147" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Wind &amp; Solar Curtailment (GWh)"</span>: <span class="bu">round</span>(vre_curt_GWh, <span class="dv">3</span>),</span>
<span id="cb47-148"><a href="#cb47-148" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Unserved Energy (GWh)"</span>: <span class="bu">round</span>(ue_GWh, <span class="dv">3</span>),</span>
<span id="cb47-149"><a href="#cb47-149" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Unserved by Region (GWh)"</span>: dict_to_multiline_string(ue_by_bus)</span>
<span id="cb47-150"><a href="#cb47-150" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb47-151"><a href="#cb47-151" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb47-152"><a href="#cb47-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-153"><a href="#cb47-153" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ── export solved network ─────────────────────────────────────</span></span>
<span id="cb47-154"><a href="#cb47-154" aria-hidden="true" tabindex="-1"></a>        n.export_to_netcdf(os.path.join(export_dir, <span class="ss">f"scenario_</span><span class="sc">{</span>scenario<span class="sc">}</span><span class="ss">.nc"</span>))</span>
<span id="cb47-155"><a href="#cb47-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-156"><a href="#cb47-156" aria-hidden="true" tabindex="-1"></a>    df_results <span class="op">=</span> pd.DataFrame(results)</span>
<span id="cb47-157"><a href="#cb47-157" aria-hidden="true" tabindex="-1"></a>    timestamp <span class="op">=</span> datetime.now().strftime(<span class="st">"%Y%m</span><span class="sc">%d</span><span class="st">_%H%M"</span>)</span>
<span id="cb47-158"><a href="#cb47-158" aria-hidden="true" tabindex="-1"></a>    df_results.to_csv(os.path.join(export_dir, <span class="ss">f"scenarios_summary_</span><span class="sc">{</span>timestamp<span class="sc">}</span><span class="ss">.csv"</span>), index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb47-159"><a href="#cb47-159" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-160"><a href="#cb47-160" aria-hidden="true" tabindex="-1"></a>    total_time <span class="op">=</span> <span class="bu">round</span>(perf_counter() <span class="op">-</span> timer_all, <span class="dv">1</span>)</span>
<span id="cb47-161"><a href="#cb47-161" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"All scenarios completed in </span><span class="sc">{</span>total_time<span class="sc">}</span><span class="ss"> seconds"</span>)</span>
<span id="cb47-162"><a href="#cb47-162" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-163"><a href="#cb47-163" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Run the above function and assign results to <code>df_results</code> for further analysis.</p>
<div id="0cff7d57" class="cell" data-execution_count="41">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Important: initialise baseline network first to avoid scaling up unwanted network (n)</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> pypsa.Network(<span class="st">"results/high-level_nem.nc"</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>df_results <span class="op">=</span> generate_scenarios(n, tech_assumptions_path<span class="op">=</span><span class="st">"data/inputs/tech_assumptions.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<!-- -->

</section>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb49" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "A High-level Open Source Model for the Australian National Electricity Market (NEM)"</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Grant Chalmers"</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2025-07-26"</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co">    output-file: index.html</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co">    output-dir: docs        # doesn't work. Use subprocess script</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo            # theme</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true         # hide code by default, with toggle</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true        # show global “Show/Hide” &amp; “Copy” buttons</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: paged         # &lt;— turn on HTML-paged DataFrame printing</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print-paged:</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="co">      page-length: 10       #   rows per page</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="co">  #pdf:</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="co">  #  df-print: kable    </span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="fu">## **Introduction**</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>The NEM power system is undergoing rapid transformation, driven by the need for increased renewable energy (RE) integration, grid modernization, and the pursuit of sustainable, reliable, and affordable electricity. To support these goals, advanced modelling tools are essential for analysing the current state of the grid, evaluating future scenarios, and informing policy and investment decisions.</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>This notebook presents the development of a high-level baseline model for the NEM power system using <span class="co">[</span><span class="ot">PyPSA (Python for Power System Analysis)</span><span class="co">](https://pypsa.readthedocs.io/en/latest/)</span>, an open-source framework for simulating and optimizing modern energy systems. The model, referred to as High-level_NEM, is a 5-node model (one bus per region) based on actual 2024 generation and demand profiles at hourly resolution. A comparison of the 2024 baseline model with a future scenario is presented in the notebook.</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>The future scenario has increased renewable energy and storage and associated reduction in thermal generation.</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>The workflow implemented in this notebook encompasses the following key steps:  </span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Data Import and Preprocessing:** Loading and preparing network topology, generator, storage, and time series data from actual NEM system records and relevant administrative datasets.  </span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Network Construction:** Building the PyPSA network by adding buses, loads, generators, storage units, and transmission lines.  </span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Temporal Resolution and Snapshots:** Setting up the model to operate at a chosen temporal granularity, allowing for the study of daily and seasonal variability in demand and renewable generation.  </span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Optimisation and Scenario Analysis:** Solving the baseline model using linear optimisation to determine the optimal dispatch of resources, and extending the analysis to a plausible future scenario with an aggressive increase in variable renewable energy and associated reduction in thermal generation.   </span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Results Visualization and Verification:** Generating plots and statistics to interpret model outputs, including network topology, dispatch profiles, generation mix, and importantly, curtailment.  </span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Scenario Functions:** Providing reusable functions for projecting various scaled-up generation scenarios. </span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a><span class="fu">## **Research Objectives**</span></span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a>*Objective:*</span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a>Develop a high-level 5-node baseline PyPSA model for the NEM and VRE/storage scale-up scenarios with:  </span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a><span class="ss">  1. </span>One bus per NEM region with transmission interconnectors  </span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a><span class="ss">  2. </span>Hourly time resolution to capture some RE intermittency  </span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a><span class="ss">  3. </span>Comparison of 2024 baseline model to a high penetration renewable energy scenario  </span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-47"><a href="#cb49-47" aria-hidden="true" tabindex="-1"></a>*Key Assumptions*  </span>
<span id="cb49-48"><a href="#cb49-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-49"><a href="#cb49-49" aria-hidden="true" tabindex="-1"></a>Baseline 2024 model:</span>
<span id="cb49-50"><a href="#cb49-50" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>2024 demand  </span>
<span id="cb49-51"><a href="#cb49-51" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>2024 generation profiles  </span>
<span id="cb49-52"><a href="#cb49-52" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>2024 renewable energy availability (capacity) factors (incl. hydro).  </span>
<span id="cb49-53"><a href="#cb49-53" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Generator registered capacities sourced from <span class="co">[</span><span class="ot">Open Electricity facilities</span><span class="co">](https://explore.openelectricity.org.au/facilities/nem/?status=operating,committed)</span> Inclusive of operating and **committed**, therefore includes Snowy 2.0, Hunter Gas and a significant increase in battery storage over what is currently operating.  </span>
<span id="cb49-54"><a href="#cb49-54" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Time series data is at hourly resolution.  </span>
<span id="cb49-55"><a href="#cb49-55" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Rooftop solar sourced from AEMO via <span class="co">[</span><span class="ot">nemosis</span><span class="co">](https://github.com/UNSW-CEEM/NEMOSIS)</span> python package (TYPE = *'MEASUREMENT'*).  </span>
<span id="cb49-56"><a href="#cb49-56" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Efficiency of storage on the way in and out set at 0.917 (round trip 0.84) via <span class="co">[</span><span class="ot">2024 ISP Inputs and Assumptions workbook</span><span class="co">](https://aemo.com.au/-/media/files/major-publications/isp/2024/2024-isp-inputs-and-assumptions-workbook.xlsx?la=en)</span>.  </span>
<span id="cb49-57"><a href="#cb49-57" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Starter battery (600MW Cellars Hill) added in TAS1 in order to be able to scale up (not currently operating, but has some level of state govt. support).  </span>
<span id="cb49-58"><a href="#cb49-58" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Project EnergyConnect and Marinus stage 1 implemented on top of existing interconnectors (constrained by nominal capacity)  </span>
<span id="cb49-59"><a href="#cb49-59" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>One generator of each major source and one battery setup per region/bus</span>
<span id="cb49-60"><a href="#cb49-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-61"><a href="#cb49-61" aria-hidden="true" tabindex="-1"></a>By following this workflow, the notebook provides a high-level example for those learning power system analysis with PyPSA.</span>
<span id="cb49-62"><a href="#cb49-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-63"><a href="#cb49-63" aria-hidden="true" tabindex="-1"></a>**Important links/references:**  </span>
<span id="cb49-64"><a href="#cb49-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-65"><a href="#cb49-65" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">TU Berlin: Data Science for Energy System Modelling</span><span class="co">](https://fneum.github.io/data-science-for-esm/intro.html#jupyter.org/)</span>  </span>
<span id="cb49-66"><a href="#cb49-66" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">PyPSA Documentation and Components</span><span class="co">](https://pypsa.readthedocs.io/en/latest/user-guide/components.html)</span>  </span>
<span id="cb49-67"><a href="#cb49-67" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">PyPSA Earth Documentation</span><span class="co">](https://pypsa-earth.readthedocs.io/en/latest/)</span>  </span>
<span id="cb49-68"><a href="#cb49-68" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">GitHub PyPSA Sources</span><span class="co">](https://github.com/PyPSA)</span>  </span>
<span id="cb49-69"><a href="#cb49-69" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">PyPSA-PH: High-Resolution Open Source Power System Model for the Philippines</span><span class="co">](https://github.com/arizeosalac/PyPSA-PH/tree/main)</span>  </span>
<span id="cb49-70"><a href="#cb49-70" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">2024 Integrated System Plan (ISP)</span><span class="co">](https://aemo.com.au/energy-systems/major-publications/integrated-system-plan-isp/2024-integrated-system-plan-isp)</span>  </span>
<span id="cb49-71"><a href="#cb49-71" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Open Electricity</span><span class="co">](https://openelectricity.org.au/)</span></span>
<span id="cb49-72"><a href="#cb49-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-73"><a href="#cb49-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-74"><a href="#cb49-74" aria-hidden="true" tabindex="-1"></a><span class="fu">### 01 Import </span></span>
<span id="cb49-75"><a href="#cb49-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-76"><a href="#cb49-76" aria-hidden="true" tabindex="-1"></a>This section imports all necessary Python packages and libraries required for data processing, power system modelling, geospatial analysis, and visualization. These packages provide the foundational tools for building, analysing, and visualising the High-leve_NEM baseline model and high penetration renewable energy model.</span>
<span id="cb49-77"><a href="#cb49-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-80"><a href="#cb49-80" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-81"><a href="#cb49-81" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb49-82"><a href="#cb49-82" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb49-83"><a href="#cb49-83" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb49-84"><a href="#cb49-84" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb49-85"><a href="#cb49-85" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.dates <span class="im">import</span> AutoDateLocator, ConciseDateFormatter</span>
<span id="cb49-86"><a href="#cb49-86" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pypsa</span>
<span id="cb49-87"><a href="#cb49-87" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pypsa.plot.maps.static <span class="im">import</span> add_legend_patches</span>
<span id="cb49-88"><a href="#cb49-88" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> timedelta</span>
<span id="cb49-89"><a href="#cb49-89" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime  </span>
<span id="cb49-90"><a href="#cb49-90" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dateutil.parser <span class="im">import</span> parse</span>
<span id="cb49-91"><a href="#cb49-91" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cartopy.crs <span class="im">as</span> ccrs</span>
<span id="cb49-92"><a href="#cb49-92" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cartopy.feature <span class="im">as</span> cfeature</span>
<span id="cb49-93"><a href="#cb49-93" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> time <span class="im">import</span> perf_counter</span>
<span id="cb49-94"><a href="#cb49-94" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> great_tables <span class="im">import</span> GT, md, system_fonts, nanoplot_options</span>
<span id="cb49-95"><a href="#cb49-95" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display, HTML</span>
<span id="cb49-96"><a href="#cb49-96" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-97"><a href="#cb49-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-98"><a href="#cb49-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-99"><a href="#cb49-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-100"><a href="#cb49-100" aria-hidden="true" tabindex="-1"></a><span class="fu">### 02 Create Network</span></span>
<span id="cb49-101"><a href="#cb49-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-102"><a href="#cb49-102" aria-hidden="true" tabindex="-1"></a>This section covers the creation of the High-level_NEME network, including loading network data, initializing the PyPSA network object, and preparing the structure for adding buses, loads, generators, storage units, and transmission lines. </span>
<span id="cb49-103"><a href="#cb49-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-104"><a href="#cb49-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-105"><a href="#cb49-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-106"><a href="#cb49-106" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 02.01 Load Network Data</span></span>
<span id="cb49-107"><a href="#cb49-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-110"><a href="#cb49-110" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-111"><a href="#cb49-111" aria-hidden="true" tabindex="-1"></a><span class="co"># Load components</span></span>
<span id="cb49-112"><a href="#cb49-112" aria-hidden="true" tabindex="-1"></a>generators <span class="op">=</span> pd.read_csv(<span class="st">"data/generators.csv"</span>).set_index(<span class="st">'name'</span>)</span>
<span id="cb49-113"><a href="#cb49-113" aria-hidden="true" tabindex="-1"></a>buses <span class="op">=</span> pd.read_csv(<span class="st">"data/buses.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb49-114"><a href="#cb49-114" aria-hidden="true" tabindex="-1"></a>loads <span class="op">=</span> pd.read_csv(<span class="st">"data/loads.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb49-115"><a href="#cb49-115" aria-hidden="true" tabindex="-1"></a>lines <span class="op">=</span> pd.read_csv(<span class="st">"data/lines.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb49-116"><a href="#cb49-116" aria-hidden="true" tabindex="-1"></a>links <span class="op">=</span> pd.read_csv(<span class="st">"data/links.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb49-117"><a href="#cb49-117" aria-hidden="true" tabindex="-1"></a>storage_units <span class="op">=</span> pd.read_csv(<span class="st">"data/storage_units.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb49-118"><a href="#cb49-118" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-119"><a href="#cb49-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-122"><a href="#cb49-122" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-123"><a href="#cb49-123" aria-hidden="true" tabindex="-1"></a><span class="co"># Load time series data</span></span>
<span id="cb49-124"><a href="#cb49-124" aria-hidden="true" tabindex="-1"></a>load_ts <span class="op">=</span> pd.read_csv(<span class="st">"data/loads_t.p_set.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb49-125"><a href="#cb49-125" aria-hidden="true" tabindex="-1"></a>load_ts.index <span class="op">=</span> pd.to_datetime(load_ts.index, errors<span class="op">=</span><span class="st">"raise"</span>)</span>
<span id="cb49-126"><a href="#cb49-126" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(load_ts.index.dtype) </span>
<span id="cb49-127"><a href="#cb49-127" aria-hidden="true" tabindex="-1"></a><span class="co"># Below should be empty if all dates are valid</span></span>
<span id="cb49-128"><a href="#cb49-128" aria-hidden="true" tabindex="-1"></a>load_ts[<span class="op">~</span>load_ts.index.notnull()]</span>
<span id="cb49-129"><a href="#cb49-129" aria-hidden="true" tabindex="-1"></a>generators_ts <span class="op">=</span> pd.read_csv(<span class="st">"data/generators_t.p_max_pu.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb49-130"><a href="#cb49-130" aria-hidden="true" tabindex="-1"></a>generators_ts.index <span class="op">=</span> pd.to_datetime(generators_ts.index, errors<span class="op">=</span><span class="st">"raise"</span>)</span>
<span id="cb49-131"><a href="#cb49-131" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generators_ts.index.dtype)</span>
<span id="cb49-132"><a href="#cb49-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-133"><a href="#cb49-133" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> load_ts.index.equals(generators_ts.index):    </span>
<span id="cb49-134"><a href="#cb49-134" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Time series indices are not aligned"</span>)</span>
<span id="cb49-135"><a href="#cb49-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-136"><a href="#cb49-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-137"><a href="#cb49-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-138"><a href="#cb49-138" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 02.02 Initialize the network</span></span>
<span id="cb49-139"><a href="#cb49-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-142"><a href="#cb49-142" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-143"><a href="#cb49-143" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> pypsa.Network()</span>
<span id="cb49-144"><a href="#cb49-144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-145"><a href="#cb49-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-146"><a href="#cb49-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-147"><a href="#cb49-147" aria-hidden="true" tabindex="-1"></a><span class="fu">### 03 Add Network Components</span></span>
<span id="cb49-148"><a href="#cb49-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-149"><a href="#cb49-149" aria-hidden="true" tabindex="-1"></a>This section details the process of adding key components to the PyPSA-PH network, including buses, loads, generators, storage units, and transmission lines. Each component is integrated with relevant time series data and technical parameters to accurately represent the Philippine power system's structure and operation.</span>
<span id="cb49-150"><a href="#cb49-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-153"><a href="#cb49-153" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-154"><a href="#cb49-154" aria-hidden="true" tabindex="-1"></a><span class="co"># Add components</span></span>
<span id="cb49-155"><a href="#cb49-155" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, row <span class="kw">in</span> buses.iterrows():</span>
<span id="cb49-156"><a href="#cb49-156" aria-hidden="true" tabindex="-1"></a>    n.add(<span class="st">"Bus"</span>, name, <span class="op">**</span>row.to_dict())</span>
<span id="cb49-157"><a href="#cb49-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-158"><a href="#cb49-158" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, row <span class="kw">in</span> loads.iterrows():</span>
<span id="cb49-159"><a href="#cb49-159" aria-hidden="true" tabindex="-1"></a>    n.add(<span class="st">"Load"</span>, name, <span class="op">**</span>row.to_dict())</span>
<span id="cb49-160"><a href="#cb49-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-161"><a href="#cb49-161" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, row <span class="kw">in</span> lines.iterrows():</span>
<span id="cb49-162"><a href="#cb49-162" aria-hidden="true" tabindex="-1"></a>    n.add(<span class="st">"Line"</span>, name, <span class="op">**</span>row.to_dict())</span>
<span id="cb49-163"><a href="#cb49-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-164"><a href="#cb49-164" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, row <span class="kw">in</span> generators.iterrows():</span>
<span id="cb49-165"><a href="#cb49-165" aria-hidden="true" tabindex="-1"></a>    n.add(<span class="st">"Generator"</span>, name, <span class="op">**</span>row.to_dict())</span>
<span id="cb49-166"><a href="#cb49-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-167"><a href="#cb49-167" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, row <span class="kw">in</span> links.iterrows():</span>
<span id="cb49-168"><a href="#cb49-168" aria-hidden="true" tabindex="-1"></a>    n.add(<span class="st">"Link"</span>, name, <span class="op">**</span>row.to_dict())</span>
<span id="cb49-169"><a href="#cb49-169" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-170"><a href="#cb49-170" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, row <span class="kw">in</span> storage_units.iterrows():</span>
<span id="cb49-171"><a href="#cb49-171" aria-hidden="true" tabindex="-1"></a>    n.add(<span class="st">"StorageUnit"</span>, name, <span class="op">**</span>row.to_dict())    </span>
<span id="cb49-172"><a href="#cb49-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-173"><a href="#cb49-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-174"><a href="#cb49-174" aria-hidden="true" tabindex="-1"></a><span class="co"># Set time series</span></span>
<span id="cb49-175"><a href="#cb49-175" aria-hidden="true" tabindex="-1"></a>n.set_snapshots(load_ts.index)</span>
<span id="cb49-176"><a href="#cb49-176" aria-hidden="true" tabindex="-1"></a>n.loads_t.p_set <span class="op">=</span> load_ts</span>
<span id="cb49-177"><a href="#cb49-177" aria-hidden="true" tabindex="-1"></a>n.generators_t.p_max_pu <span class="op">=</span> generators_ts</span>
<span id="cb49-178"><a href="#cb49-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-179"><a href="#cb49-179" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="bu">all</span>(n.generators_t.p_max_pu.index <span class="op">==</span> n.snapshots)</span>
<span id="cb49-180"><a href="#cb49-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-181"><a href="#cb49-181" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove negative values in p_max_pu (Hydro is the culprit)</span></span>
<span id="cb49-182"><a href="#cb49-182" aria-hidden="true" tabindex="-1"></a>n.generators_t.p_max_pu <span class="op">=</span> n.generators_t.p_max_pu.clip(lower<span class="op">=</span><span class="fl">0.0</span>, upper<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb49-183"><a href="#cb49-183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-184"><a href="#cb49-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-185"><a href="#cb49-185" aria-hidden="true" tabindex="-1"></a>Introduce a dummy 'load shedding' generator to help identify infeasible scenarios within the model. This approach is more informative than simply receiving a "not feasible" message from the solver, as it highlights which regions are affected. With this information, we can make targeted adjustments - such as increasing generation or storage in future iterations.</span>
<span id="cb49-186"><a href="#cb49-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-187"><a href="#cb49-187" aria-hidden="true" tabindex="-1"></a>Set the marginal cost very high so it is only used as a last resort.</span>
<span id="cb49-188"><a href="#cb49-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-191"><a href="#cb49-191" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-192"><a href="#cb49-192" aria-hidden="true" tabindex="-1"></a><span class="co"># Add one unserved energy generator per load bus</span></span>
<span id="cb49-193"><a href="#cb49-193" aria-hidden="true" tabindex="-1"></a><span class="co"># Acts like a dummy "load shedding" generator</span></span>
<span id="cb49-194"><a href="#cb49-194" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> bus <span class="kw">in</span> n.loads.bus.unique():</span>
<span id="cb49-195"><a href="#cb49-195" aria-hidden="true" tabindex="-1"></a>    gen_name <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>bus<span class="sc">}</span><span class="ss">-UNSERVED"</span></span>
<span id="cb49-196"><a href="#cb49-196" aria-hidden="true" tabindex="-1"></a>    n.add(<span class="st">"Generator"</span>,</span>
<span id="cb49-197"><a href="#cb49-197" aria-hidden="true" tabindex="-1"></a>          name<span class="op">=</span>gen_name,</span>
<span id="cb49-198"><a href="#cb49-198" aria-hidden="true" tabindex="-1"></a>          bus<span class="op">=</span>bus,</span>
<span id="cb49-199"><a href="#cb49-199" aria-hidden="true" tabindex="-1"></a>          carrier<span class="op">=</span><span class="st">"Unserved Energy"</span>,</span>
<span id="cb49-200"><a href="#cb49-200" aria-hidden="true" tabindex="-1"></a>          p_nom_extendable<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb49-201"><a href="#cb49-201" aria-hidden="true" tabindex="-1"></a>          p_nom<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb49-202"><a href="#cb49-202" aria-hidden="true" tabindex="-1"></a>          marginal_cost<span class="op">=</span><span class="dv">10000</span>,  <span class="co"># Very expensive fallback</span></span>
<span id="cb49-203"><a href="#cb49-203" aria-hidden="true" tabindex="-1"></a>          capital_cost<span class="op">=</span><span class="dv">0</span>,       <span class="co"># Optional: make it purely operational cost</span></span>
<span id="cb49-204"><a href="#cb49-204" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-205"><a href="#cb49-205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-206"><a href="#cb49-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-209"><a href="#cb49-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-210"><a href="#cb49-210" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostic output</span></span>
<span id="cb49-211"><a href="#cb49-211" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded </span><span class="sc">{</span><span class="bu">len</span>(n.buses)<span class="sc">}</span><span class="ss"> buses"</span>)</span>
<span id="cb49-212"><a href="#cb49-212" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded </span><span class="sc">{</span><span class="bu">len</span>(n.loads)<span class="sc">}</span><span class="ss"> loads with time series of shape </span><span class="sc">{</span>n<span class="sc">.</span>loads_t<span class="sc">.</span>p_set<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb49-213"><a href="#cb49-213" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded </span><span class="sc">{</span><span class="bu">len</span>(n.generators)<span class="sc">}</span><span class="ss"> generators with time series of shape </span><span class="sc">{</span>n<span class="sc">.</span>generators_t<span class="sc">.</span>p_max_pu<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb49-214"><a href="#cb49-214" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded </span><span class="sc">{</span><span class="bu">len</span>(n.lines)<span class="sc">}</span><span class="ss"> lines"</span>)</span>
<span id="cb49-215"><a href="#cb49-215" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded </span><span class="sc">{</span><span class="bu">len</span>(n.links)<span class="sc">}</span><span class="ss"> links"</span>)</span>
<span id="cb49-216"><a href="#cb49-216" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded </span><span class="sc">{</span><span class="bu">len</span>(n.generators)<span class="sc">}</span><span class="ss"> generators"</span>)</span>
<span id="cb49-217"><a href="#cb49-217" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded </span><span class="sc">{</span><span class="bu">len</span>(n.storage_units)<span class="sc">}</span><span class="ss"> storage units"</span>)</span>
<span id="cb49-218"><a href="#cb49-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-219"><a href="#cb49-219" aria-hidden="true" tabindex="-1"></a><span class="co"># Check total demand makes sense</span></span>
<span id="cb49-220"><a href="#cb49-220" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total demand:  </span><span class="sc">{</span>n<span class="sc">.</span>loads_t<span class="sc">.</span>p_set<span class="sc">.</span><span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)<span class="sc">.</span><span class="bu">max</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb49-221"><a href="#cb49-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-222"><a href="#cb49-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-223"><a href="#cb49-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-224"><a href="#cb49-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-225"><a href="#cb49-225" aria-hidden="true" tabindex="-1"></a>Add carrier colours for plotting consistency.</span>
<span id="cb49-226"><a href="#cb49-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-229"><a href="#cb49-229" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-230"><a href="#cb49-230" aria-hidden="true" tabindex="-1"></a><span class="co"># Add carrier colours for plotting consistency.</span></span>
<span id="cb49-231"><a href="#cb49-231" aria-hidden="true" tabindex="-1"></a><span class="co"># Userved Energy bright red!</span></span>
<span id="cb49-232"><a href="#cb49-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-233"><a href="#cb49-233" aria-hidden="true" tabindex="-1"></a>carrier_list <span class="op">=</span> n.generators.carrier.unique()</span>
<span id="cb49-234"><a href="#cb49-234" aria-hidden="true" tabindex="-1"></a>carrier_colors <span class="op">=</span> {</span>
<span id="cb49-235"><a href="#cb49-235" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Biomass"</span>: <span class="st">'#127E2A'</span>,</span>
<span id="cb49-236"><a href="#cb49-236" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hydro"</span>: <span class="st">'#1E81D4'</span>,</span>
<span id="cb49-237"><a href="#cb49-237" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Black Coal"</span>: <span class="st">"#39322D"</span>,</span>
<span id="cb49-238"><a href="#cb49-238" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Solar"</span>: <span class="st">'#FDB324'</span>,</span>
<span id="cb49-239"><a href="#cb49-239" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rooftop Solar"</span>: <span class="st">'#FFE066'</span>,</span>
<span id="cb49-240"><a href="#cb49-240" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Wind"</span>: <span class="st">'#3BBFE5'</span>,</span>
<span id="cb49-241"><a href="#cb49-241" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Diesel"</span>: <span class="st">"#D486BA"</span>,</span>
<span id="cb49-242"><a href="#cb49-242" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Brown Coal"</span>: <span class="st">"#715E50"</span>,</span>
<span id="cb49-243"><a href="#cb49-243" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gas"</span>: <span class="st">'#E6622D'</span>,</span>
<span id="cb49-244"><a href="#cb49-244" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ROR"</span>: <span class="st">'#8ab2d4'</span>,</span>
<span id="cb49-245"><a href="#cb49-245" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Battery"</span>: <span class="st">'#814ad4'</span>,</span>
<span id="cb49-246"><a href="#cb49-246" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pump Hydro"</span>: <span class="st">'#104775'</span>,</span>
<span id="cb49-247"><a href="#cb49-247" aria-hidden="true" tabindex="-1"></a>    <span class="st">"AC"</span>: <span class="st">'#999999'</span>,</span>
<span id="cb49-248"><a href="#cb49-248" aria-hidden="true" tabindex="-1"></a>    <span class="st">"DC"</span>: <span class="st">"#3277AF"</span>,</span>
<span id="cb49-249"><a href="#cb49-249" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Unserved Energy"</span>: <span class="st">"#F40B16"</span></span>
<span id="cb49-250"><a href="#cb49-250" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-251"><a href="#cb49-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-252"><a href="#cb49-252" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> carrier, color <span class="kw">in</span> carrier_colors.items():</span>
<span id="cb49-253"><a href="#cb49-253" aria-hidden="true" tabindex="-1"></a>    n.carriers.loc[carrier, <span class="st">'color'</span>] <span class="op">=</span> color</span>
<span id="cb49-254"><a href="#cb49-254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-255"><a href="#cb49-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-256"><a href="#cb49-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-257"><a href="#cb49-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-258"><a href="#cb49-258" aria-hidden="true" tabindex="-1"></a>Plot high-level NEM network (buses, lines &amp; links).  </span>
<span id="cb49-259"><a href="#cb49-259" aria-hidden="true" tabindex="-1"></a>Note: the lines/links below are not geographically accurate - just for representation.</span>
<span id="cb49-260"><a href="#cb49-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-263"><a href="#cb49-263" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-264"><a href="#cb49-264" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot high-level NEM network (buses, lines &amp; links)</span></span>
<span id="cb49-265"><a href="#cb49-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-266"><a href="#cb49-266" aria-hidden="true" tabindex="-1"></a><span class="co"># Use PlateCarree projection for lat/lon</span></span>
<span id="cb49-267"><a href="#cb49-267" aria-hidden="true" tabindex="-1"></a>crs <span class="op">=</span> ccrs.PlateCarree()</span>
<span id="cb49-268"><a href="#cb49-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-269"><a href="#cb49-269" aria-hidden="true" tabindex="-1"></a><span class="co"># Create figure and map</span></span>
<span id="cb49-270"><a href="#cb49-270" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">6</span>), subplot_kw<span class="op">=</span>{<span class="st">'projection'</span>: crs})</span>
<span id="cb49-271"><a href="#cb49-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-272"><a href="#cb49-272" aria-hidden="true" tabindex="-1"></a><span class="co"># Add base map features</span></span>
<span id="cb49-273"><a href="#cb49-273" aria-hidden="true" tabindex="-1"></a>ax.add_feature(cfeature.COASTLINE)</span>
<span id="cb49-274"><a href="#cb49-274" aria-hidden="true" tabindex="-1"></a>ax.add_feature(cfeature.BORDERS, linestyle<span class="op">=</span><span class="st">":"</span>)</span>
<span id="cb49-275"><a href="#cb49-275" aria-hidden="true" tabindex="-1"></a>ax.add_feature(cfeature.STATES, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb49-276"><a href="#cb49-276" aria-hidden="true" tabindex="-1"></a>ax.set_extent([<span class="dv">110</span>, <span class="dv">155</span>, <span class="op">-</span><span class="dv">45</span>, <span class="op">-</span><span class="dv">10</span>])  <span class="co"># Australia-wide view</span></span>
<span id="cb49-277"><a href="#cb49-277" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.patch.set_facecolor('#F0FFFF') </span></span>
<span id="cb49-278"><a href="#cb49-278" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.set_facecolor('#F0FFFF')</span></span>
<span id="cb49-279"><a href="#cb49-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-280"><a href="#cb49-280" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot buses</span></span>
<span id="cb49-281"><a href="#cb49-281" aria-hidden="true" tabindex="-1"></a>ax.scatter(</span>
<span id="cb49-282"><a href="#cb49-282" aria-hidden="true" tabindex="-1"></a>    n.buses[<span class="st">"x"</span>], n.buses[<span class="st">"y"</span>],</span>
<span id="cb49-283"><a href="#cb49-283" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">'red'</span>, s<span class="op">=</span><span class="dv">50</span>, transform<span class="op">=</span>crs, zorder<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb49-284"><a href="#cb49-284" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">"Buses"</span></span>
<span id="cb49-285"><a href="#cb49-285" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-286"><a href="#cb49-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-287"><a href="#cb49-287" aria-hidden="true" tabindex="-1"></a><span class="co"># Label each bus</span></span>
<span id="cb49-288"><a href="#cb49-288" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, row <span class="kw">in</span> n.buses.iterrows():</span>
<span id="cb49-289"><a href="#cb49-289" aria-hidden="true" tabindex="-1"></a>    ax.text(</span>
<span id="cb49-290"><a href="#cb49-290" aria-hidden="true" tabindex="-1"></a>        row[<span class="st">"x"</span>], row[<span class="st">"y"</span>], name,</span>
<span id="cb49-291"><a href="#cb49-291" aria-hidden="true" tabindex="-1"></a>        transform<span class="op">=</span>crs, fontsize<span class="op">=</span><span class="dv">9</span>, ha<span class="op">=</span><span class="st">'left'</span>, va<span class="op">=</span><span class="st">'bottom'</span></span>
<span id="cb49-292"><a href="#cb49-292" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-293"><a href="#cb49-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-294"><a href="#cb49-294" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot lines (AC)</span></span>
<span id="cb49-295"><a href="#cb49-295" aria-hidden="true" tabindex="-1"></a>first_line <span class="op">=</span> <span class="va">True</span></span>
<span id="cb49-296"><a href="#cb49-296" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, line <span class="kw">in</span> n.lines.iterrows():</span>
<span id="cb49-297"><a href="#cb49-297" aria-hidden="true" tabindex="-1"></a>    x0, y0 <span class="op">=</span> n.buses.loc[line.bus0, [<span class="st">"x"</span>, <span class="st">"y"</span>]]</span>
<span id="cb49-298"><a href="#cb49-298" aria-hidden="true" tabindex="-1"></a>    x1, y1 <span class="op">=</span> n.buses.loc[line.bus1, [<span class="st">"x"</span>, <span class="st">"y"</span>]]</span>
<span id="cb49-299"><a href="#cb49-299" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> carrier_colors.get(line.carrier, <span class="st">"gray"</span>)  <span class="co"># fallback if undefined</span></span>
<span id="cb49-300"><a href="#cb49-300" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-301"><a href="#cb49-301" aria-hidden="true" tabindex="-1"></a>    ax.plot([x0, x1], [y0, y1], color<span class="op">=</span>color, transform<span class="op">=</span>crs, zorder<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb49-302"><a href="#cb49-302" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">"Lines (AC)"</span> <span class="cf">if</span> first_line <span class="cf">else</span> <span class="va">None</span>)</span>
<span id="cb49-303"><a href="#cb49-303" aria-hidden="true" tabindex="-1"></a>    first_line <span class="op">=</span> <span class="va">False</span></span>
<span id="cb49-304"><a href="#cb49-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-305"><a href="#cb49-305" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot links (DC)</span></span>
<span id="cb49-306"><a href="#cb49-306" aria-hidden="true" tabindex="-1"></a>first_link <span class="op">=</span> <span class="va">True</span></span>
<span id="cb49-307"><a href="#cb49-307" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, link <span class="kw">in</span> n.links.iterrows():</span>
<span id="cb49-308"><a href="#cb49-308" aria-hidden="true" tabindex="-1"></a>    x0, y0 <span class="op">=</span> n.buses.loc[link.bus0, [<span class="st">"x"</span>, <span class="st">"y"</span>]]</span>
<span id="cb49-309"><a href="#cb49-309" aria-hidden="true" tabindex="-1"></a>    x1, y1 <span class="op">=</span> n.buses.loc[link.bus1, [<span class="st">"x"</span>, <span class="st">"y"</span>]]</span>
<span id="cb49-310"><a href="#cb49-310" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> carrier_colors.get(link.carrier, <span class="st">"blue"</span>)</span>
<span id="cb49-311"><a href="#cb49-311" aria-hidden="true" tabindex="-1"></a>    ax.plot([x0, x1], [y0, y1], color<span class="op">=</span>color, linestyle<span class="op">=</span><span class="st">"--"</span>, transform<span class="op">=</span>crs, zorder<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb49-312"><a href="#cb49-312" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">"Links (DC)"</span> <span class="cf">if</span> first_link <span class="cf">else</span> <span class="va">None</span>)</span>
<span id="cb49-313"><a href="#cb49-313" aria-hidden="true" tabindex="-1"></a>    first_link <span class="op">=</span> <span class="va">False</span></span>
<span id="cb49-314"><a href="#cb49-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-315"><a href="#cb49-315" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"PyPSA High-level NEM Network (Buses, Lines, Links)"</span>)</span>
<span id="cb49-316"><a href="#cb49-316" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb49-317"><a href="#cb49-317" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb49-318"><a href="#cb49-318" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb49-319"><a href="#cb49-319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-320"><a href="#cb49-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-321"><a href="#cb49-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-322"><a href="#cb49-322" aria-hidden="true" tabindex="-1"></a><span class="fu">### 03 Solve the network</span></span>
<span id="cb49-323"><a href="#cb49-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-326"><a href="#cb49-326" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-327"><a href="#cb49-327" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve the nework</span></span>
<span id="cb49-328"><a href="#cb49-328" aria-hidden="true" tabindex="-1"></a><span class="co"># Change to open source solver if required, default is HiGHS:</span></span>
<span id="cb49-329"><a href="#cb49-329" aria-hidden="true" tabindex="-1"></a><span class="co"># n.optimize()</span></span>
<span id="cb49-330"><a href="#cb49-330" aria-hidden="true" tabindex="-1"></a><span class="co"># n.optimize(solver_name = "gurobi")</span></span>
<span id="cb49-331"><a href="#cb49-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-332"><a href="#cb49-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-335"><a href="#cb49-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-336"><a href="#cb49-336" aria-hidden="true" tabindex="-1"></a><span class="co"># Export the baseline network to NetCDF format so it is accessible for other tools.</span></span>
<span id="cb49-337"><a href="#cb49-337" aria-hidden="true" tabindex="-1"></a><span class="co"># This is useful for sharing the network with others or for further analysis.</span></span>
<span id="cb49-338"><a href="#cb49-338" aria-hidden="true" tabindex="-1"></a><span class="co"># n.export_to_netcdf("results/high-level_nem.nc")</span></span>
<span id="cb49-339"><a href="#cb49-339" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-340"><a href="#cb49-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-343"><a href="#cb49-343" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-344"><a href="#cb49-344" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the network back from NetCDF format (if needed)</span></span>
<span id="cb49-345"><a href="#cb49-345" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> pypsa.Network(<span class="st">"results/high-level_nem.nc"</span>)</span>
<span id="cb49-346"><a href="#cb49-346" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-347"><a href="#cb49-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-348"><a href="#cb49-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-349"><a href="#cb49-349" aria-hidden="true" tabindex="-1"></a><span class="in">`.p_nom_opt`</span> is the optimised nominal capacity of a generator, after running n.optimize() in PyPSA.</span>
<span id="cb49-350"><a href="#cb49-350" aria-hidden="true" tabindex="-1"></a>In the baseline model, it is expected that there will be zero unserved energy.</span>
<span id="cb49-351"><a href="#cb49-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-354"><a href="#cb49-354" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-355"><a href="#cb49-355" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by bus and carrier to sum the optimised nominal power in MW.</span></span>
<span id="cb49-356"><a href="#cb49-356" aria-hidden="true" tabindex="-1"></a>n.generators.groupby([<span class="st">"bus"</span>, <span class="st">"carrier"</span>]).p_nom_opt.<span class="bu">sum</span>().reset_index() <span class="op">\</span></span>
<span id="cb49-357"><a href="#cb49-357" aria-hidden="true" tabindex="-1"></a>    .pivot(index<span class="op">=</span><span class="st">'bus'</span>, columns<span class="op">=</span><span class="st">'carrier'</span>, values<span class="op">=</span><span class="st">'p_nom_opt'</span>) <span class="op">\</span></span>
<span id="cb49-358"><a href="#cb49-358" aria-hidden="true" tabindex="-1"></a>    .fillna(<span class="dv">0</span>).astype(<span class="bu">int</span>).sort_index()</span>
<span id="cb49-359"><a href="#cb49-359" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-360"><a href="#cb49-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-361"><a href="#cb49-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-362"><a href="#cb49-362" aria-hidden="true" tabindex="-1"></a><span class="fu">### 04 Visualisations</span></span>
<span id="cb49-363"><a href="#cb49-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-364"><a href="#cb49-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-365"><a href="#cb49-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-368"><a href="#cb49-368" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-369"><a href="#cb49-369" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting function for generation dispatch</span></span>
<span id="cb49-370"><a href="#cb49-370" aria-hidden="true" tabindex="-1"></a><span class="co"># Interactive version (optional)</span></span>
<span id="cb49-371"><a href="#cb49-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-372"><a href="#cb49-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-373"><a href="#cb49-373" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_dispatch(n, time<span class="op">=</span><span class="st">"2024"</span>, days<span class="op">=</span><span class="va">None</span>, regions<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb49-374"><a href="#cb49-374" aria-hidden="true" tabindex="-1"></a>                   show_imports<span class="op">=</span><span class="va">True</span>, show_curtailment<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb49-375"><a href="#cb49-375" aria-hidden="true" tabindex="-1"></a>                   scenario_name<span class="op">=</span><span class="va">None</span>, scenario_objective<span class="op">=</span><span class="va">None</span>, interactive<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb49-376"><a href="#cb49-376" aria-hidden="true" tabindex="-1"></a>     <span class="co">"""</span></span>
<span id="cb49-377"><a href="#cb49-377" aria-hidden="true" tabindex="-1"></a><span class="co">     Plot a generation dispatch stack by carrier for a PyPSA network, with optional</span></span>
<span id="cb49-378"><a href="#cb49-378" aria-hidden="true" tabindex="-1"></a><span class="co">     net imports/exports and a region‑filtered curtailment overlay.</span></span>
<span id="cb49-379"><a href="#cb49-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-380"><a href="#cb49-380" aria-hidden="true" tabindex="-1"></a><span class="co">     Parameters</span></span>
<span id="cb49-381"><a href="#cb49-381" aria-hidden="true" tabindex="-1"></a><span class="co">     ----------</span></span>
<span id="cb49-382"><a href="#cb49-382" aria-hidden="true" tabindex="-1"></a><span class="co">     n : pypsa.Network</span></span>
<span id="cb49-383"><a href="#cb49-383" aria-hidden="true" tabindex="-1"></a><span class="co">         The PyPSA network to plot.</span></span>
<span id="cb49-384"><a href="#cb49-384" aria-hidden="true" tabindex="-1"></a><span class="co">     time : str, default "2024"</span></span>
<span id="cb49-385"><a href="#cb49-385" aria-hidden="true" tabindex="-1"></a><span class="co">         Start of the time window (e.g. "2024", "2024-07", or "2024-07-15").</span></span>
<span id="cb49-386"><a href="#cb49-386" aria-hidden="true" tabindex="-1"></a><span class="co">     days : int, optional</span></span>
<span id="cb49-387"><a href="#cb49-387" aria-hidden="true" tabindex="-1"></a><span class="co">         Number of days from `time` to include in the plot.</span></span>
<span id="cb49-388"><a href="#cb49-388" aria-hidden="true" tabindex="-1"></a><span class="co">     regions : list of str, optional</span></span>
<span id="cb49-389"><a href="#cb49-389" aria-hidden="true" tabindex="-1"></a><span class="co">         Region bus names to filter by. If None, the entire network is included.</span></span>
<span id="cb49-390"><a href="#cb49-390" aria-hidden="true" tabindex="-1"></a><span class="co">     show_imports : bool, default True</span></span>
<span id="cb49-391"><a href="#cb49-391" aria-hidden="true" tabindex="-1"></a><span class="co">         Whether to include net imports/exports in the dispatch stack.</span></span>
<span id="cb49-392"><a href="#cb49-392" aria-hidden="true" tabindex="-1"></a><span class="co">     show_curtailment : bool, default True</span></span>
<span id="cb49-393"><a href="#cb49-393" aria-hidden="true" tabindex="-1"></a><span class="co">         Whether to calculate and plot VRE curtailment (Solar, Wind, Rooftop Solar).</span></span>
<span id="cb49-394"><a href="#cb49-394" aria-hidden="true" tabindex="-1"></a><span class="co">     scenario_name : str, optional</span></span>
<span id="cb49-395"><a href="#cb49-395" aria-hidden="true" tabindex="-1"></a><span class="co">         Scenario label to display below the title.</span></span>
<span id="cb49-396"><a href="#cb49-396" aria-hidden="true" tabindex="-1"></a><span class="co">     scenario_objective : str, optional</span></span>
<span id="cb49-397"><a href="#cb49-397" aria-hidden="true" tabindex="-1"></a><span class="co">         Objective description to display next to the legend.</span></span>
<span id="cb49-398"><a href="#cb49-398" aria-hidden="true" tabindex="-1"></a><span class="co">     interactive : bool, default False</span></span>
<span id="cb49-399"><a href="#cb49-399" aria-hidden="true" tabindex="-1"></a><span class="co">         Whether to create an interactive plot using Plotly instead of matplotlib.</span></span>
<span id="cb49-400"><a href="#cb49-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-401"><a href="#cb49-401" aria-hidden="true" tabindex="-1"></a><span class="co">     Notes</span></span>
<span id="cb49-402"><a href="#cb49-402" aria-hidden="true" tabindex="-1"></a><span class="co">     -----</span></span>
<span id="cb49-403"><a href="#cb49-403" aria-hidden="true" tabindex="-1"></a><span class="co">     - All power values are converted to GW.</span></span>
<span id="cb49-404"><a href="#cb49-404" aria-hidden="true" tabindex="-1"></a><span class="co">     - Curtailment is plotted as a dashed black line if enabled.</span></span>
<span id="cb49-405"><a href="#cb49-405" aria-hidden="true" tabindex="-1"></a><span class="co">     - Demand (load) is plotted as a solid green line.</span></span>
<span id="cb49-406"><a href="#cb49-406" aria-hidden="true" tabindex="-1"></a><span class="co">     - Storage charging and net exports (negative values) are shown below zero.</span></span>
<span id="cb49-407"><a href="#cb49-407" aria-hidden="true" tabindex="-1"></a><span class="co">     """</span></span>
<span id="cb49-408"><a href="#cb49-408" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb49-409"><a href="#cb49-409" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb49-410"><a href="#cb49-410" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> interactive:</span>
<span id="cb49-411"><a href="#cb49-411" aria-hidden="true" tabindex="-1"></a>         <span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb49-412"><a href="#cb49-412" aria-hidden="true" tabindex="-1"></a>         <span class="im">from</span> plotly.subplots <span class="im">import</span> make_subplots</span>
<span id="cb49-413"><a href="#cb49-413" aria-hidden="true" tabindex="-1"></a>         <span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb49-414"><a href="#cb49-414" aria-hidden="true" tabindex="-1"></a>     <span class="cf">else</span>:</span>
<span id="cb49-415"><a href="#cb49-415" aria-hidden="true" tabindex="-1"></a>         <span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb49-416"><a href="#cb49-416" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb49-417"><a href="#cb49-417" aria-hidden="true" tabindex="-1"></a>     <span class="co"># 1) REGION MASKS</span></span>
<span id="cb49-418"><a href="#cb49-418" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> regions <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb49-419"><a href="#cb49-419" aria-hidden="true" tabindex="-1"></a>         gen_mask   <span class="op">=</span> n.generators.bus.isin(regions)</span>
<span id="cb49-420"><a href="#cb49-420" aria-hidden="true" tabindex="-1"></a>         sto_mask   <span class="op">=</span> n.storage_units.bus.isin(regions) <span class="cf">if</span> <span class="kw">not</span> n.storage_units.empty <span class="cf">else</span> []</span>
<span id="cb49-421"><a href="#cb49-421" aria-hidden="true" tabindex="-1"></a>         store_mask <span class="op">=</span> n.stores.bus.isin(regions) <span class="cf">if</span> <span class="kw">not</span> n.stores.empty <span class="cf">else</span> []</span>
<span id="cb49-422"><a href="#cb49-422" aria-hidden="true" tabindex="-1"></a>         region_buses <span class="op">=</span> <span class="bu">set</span>(regions)</span>
<span id="cb49-423"><a href="#cb49-423" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb49-424"><a href="#cb49-424" aria-hidden="true" tabindex="-1"></a>     <span class="cf">else</span>:</span>
<span id="cb49-425"><a href="#cb49-425" aria-hidden="true" tabindex="-1"></a>        gen_mask <span class="op">=</span> pd.Series(<span class="va">True</span>, index<span class="op">=</span>n.generators.index)</span>
<span id="cb49-426"><a href="#cb49-426" aria-hidden="true" tabindex="-1"></a>        sto_mask <span class="op">=</span> pd.Series(<span class="va">True</span>, index<span class="op">=</span>n.storage_units.index) <span class="cf">if</span> <span class="kw">not</span> n.storage_units.empty <span class="cf">else</span> pd.Series(dtype<span class="op">=</span><span class="bu">bool</span>)</span>
<span id="cb49-427"><a href="#cb49-427" aria-hidden="true" tabindex="-1"></a>        store_mask <span class="op">=</span> pd.Series(<span class="va">True</span>, index<span class="op">=</span>n.stores.index) <span class="cf">if</span> <span class="kw">not</span> n.stores.empty <span class="cf">else</span> pd.Series(dtype<span class="op">=</span><span class="bu">bool</span>)</span>
<span id="cb49-428"><a href="#cb49-428" aria-hidden="true" tabindex="-1"></a>        region_buses <span class="op">=</span> <span class="bu">set</span>(n.buses.index)</span>
<span id="cb49-429"><a href="#cb49-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-430"><a href="#cb49-430" aria-hidden="true" tabindex="-1"></a>     <span class="co"># 2) AGGREGATE BY CARRIER (GW)</span></span>
<span id="cb49-431"><a href="#cb49-431" aria-hidden="true" tabindex="-1"></a>     <span class="kw">def</span> _agg(df_t, df_stat, mask):</span>
<span id="cb49-432"><a href="#cb49-432" aria-hidden="true" tabindex="-1"></a>         <span class="cf">return</span> (</span>
<span id="cb49-433"><a href="#cb49-433" aria-hidden="true" tabindex="-1"></a>             df_t.loc[:, mask]</span>
<span id="cb49-434"><a href="#cb49-434" aria-hidden="true" tabindex="-1"></a>                 .T</span>
<span id="cb49-435"><a href="#cb49-435" aria-hidden="true" tabindex="-1"></a>                 .groupby(df_stat.loc[mask, <span class="st">'carrier'</span>])</span>
<span id="cb49-436"><a href="#cb49-436" aria-hidden="true" tabindex="-1"></a>                 .<span class="bu">sum</span>()</span>
<span id="cb49-437"><a href="#cb49-437" aria-hidden="true" tabindex="-1"></a>                 .T</span>
<span id="cb49-438"><a href="#cb49-438" aria-hidden="true" tabindex="-1"></a>                 .div(<span class="fl">1e3</span>)</span>
<span id="cb49-439"><a href="#cb49-439" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb49-440"><a href="#cb49-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-441"><a href="#cb49-441" aria-hidden="true" tabindex="-1"></a>     p_by_carrier <span class="op">=</span> _agg(n.generators_t.p, n.generators, gen_mask)</span>
<span id="cb49-442"><a href="#cb49-442" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> <span class="kw">not</span> n.storage_units.empty:</span>
<span id="cb49-443"><a href="#cb49-443" aria-hidden="true" tabindex="-1"></a>         p_by_carrier <span class="op">=</span> pd.concat([p_by_carrier,</span>
<span id="cb49-444"><a href="#cb49-444" aria-hidden="true" tabindex="-1"></a>                                   _agg(n.storage_units_t.p, n.storage_units, sto_mask)],</span>
<span id="cb49-445"><a href="#cb49-445" aria-hidden="true" tabindex="-1"></a>                                  axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb49-446"><a href="#cb49-446" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> <span class="kw">not</span> n.stores.empty:</span>
<span id="cb49-447"><a href="#cb49-447" aria-hidden="true" tabindex="-1"></a>         p_by_carrier <span class="op">=</span> pd.concat([p_by_carrier,</span>
<span id="cb49-448"><a href="#cb49-448" aria-hidden="true" tabindex="-1"></a>                                   _agg(n.stores_t.p, n.stores, store_mask)],</span>
<span id="cb49-449"><a href="#cb49-449" aria-hidden="true" tabindex="-1"></a>                                  axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb49-450"><a href="#cb49-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-451"><a href="#cb49-451" aria-hidden="true" tabindex="-1"></a>     <span class="co"># 3) TIME WINDOW</span></span>
<span id="cb49-452"><a href="#cb49-452" aria-hidden="true" tabindex="-1"></a>     parts <span class="op">=</span> time.split(<span class="st">"-"</span>)</span>
<span id="cb49-453"><a href="#cb49-453" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> <span class="bu">len</span>(parts) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb49-454"><a href="#cb49-454" aria-hidden="true" tabindex="-1"></a>         start <span class="op">=</span> pd.to_datetime(<span class="ss">f"</span><span class="sc">{</span>parts[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">-01-01"</span>)</span>
<span id="cb49-455"><a href="#cb49-455" aria-hidden="true" tabindex="-1"></a>     <span class="cf">elif</span> <span class="bu">len</span>(parts) <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb49-456"><a href="#cb49-456" aria-hidden="true" tabindex="-1"></a>         start <span class="op">=</span> pd.to_datetime(<span class="ss">f"</span><span class="sc">{</span>parts[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>parts[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">-01"</span>)</span>
<span id="cb49-457"><a href="#cb49-457" aria-hidden="true" tabindex="-1"></a>     <span class="cf">else</span>:</span>
<span id="cb49-458"><a href="#cb49-458" aria-hidden="true" tabindex="-1"></a>         start <span class="op">=</span> pd.to_datetime(time)</span>
<span id="cb49-459"><a href="#cb49-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-460"><a href="#cb49-460" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> days <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb49-461"><a href="#cb49-461" aria-hidden="true" tabindex="-1"></a>         end <span class="op">=</span> start <span class="op">+</span> pd.Timedelta(days<span class="op">=</span>days) <span class="op">-</span> pd.Timedelta(hours<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb49-462"><a href="#cb49-462" aria-hidden="true" tabindex="-1"></a>     <span class="cf">elif</span> <span class="bu">len</span>(parts) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb49-463"><a href="#cb49-463" aria-hidden="true" tabindex="-1"></a>         end <span class="op">=</span> pd.to_datetime(<span class="ss">f"</span><span class="sc">{</span>parts[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">-12-31 23:00"</span>)</span>
<span id="cb49-464"><a href="#cb49-464" aria-hidden="true" tabindex="-1"></a>     <span class="cf">elif</span> <span class="bu">len</span>(parts) <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb49-465"><a href="#cb49-465" aria-hidden="true" tabindex="-1"></a>         end <span class="op">=</span> start <span class="op">+</span> pd.offsets.MonthEnd(<span class="dv">0</span>) <span class="op">+</span> pd.Timedelta(hours<span class="op">=</span><span class="dv">23</span>)</span>
<span id="cb49-466"><a href="#cb49-466" aria-hidden="true" tabindex="-1"></a>     <span class="cf">else</span>:</span>
<span id="cb49-467"><a href="#cb49-467" aria-hidden="true" tabindex="-1"></a>         end <span class="op">=</span> start <span class="op">+</span> pd.Timedelta(hours<span class="op">=</span><span class="dv">23</span>)</span>
<span id="cb49-468"><a href="#cb49-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-469"><a href="#cb49-469" aria-hidden="true" tabindex="-1"></a>     p_slice <span class="op">=</span> p_by_carrier.loc[start:end].copy()</span>
<span id="cb49-470"><a href="#cb49-470" aria-hidden="true" tabindex="-1"></a>     <span class="co"># drop carriers with zero activity</span></span>
<span id="cb49-471"><a href="#cb49-471" aria-hidden="true" tabindex="-1"></a>     zero <span class="op">=</span> p_slice.columns[p_slice.<span class="bu">abs</span>().<span class="bu">sum</span>() <span class="op">==</span> <span class="dv">0</span>]</span>
<span id="cb49-472"><a href="#cb49-472" aria-hidden="true" tabindex="-1"></a>     p_slice.drop(columns<span class="op">=</span>zero, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb49-473"><a href="#cb49-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-474"><a href="#cb49-474" aria-hidden="true" tabindex="-1"></a>     <span class="co"># 4) IMPORTS/EXPORTS</span></span>
<span id="cb49-475"><a href="#cb49-475" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> show_imports:</span>
<span id="cb49-476"><a href="#cb49-476" aria-hidden="true" tabindex="-1"></a>         ac <span class="op">=</span> ( n.lines_t.p0.loc[start:end, n.lines.bus1.isin(region_buses) <span class="op">&amp;</span> <span class="op">~</span>n.lines.bus0.isin(region_buses)].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb49-477"><a href="#cb49-477" aria-hidden="true" tabindex="-1"></a>              <span class="op">+</span> n.lines_t.p1.loc[start:end, n.lines.bus0.isin(region_buses) <span class="op">&amp;</span> <span class="op">~</span>n.lines.bus1.isin(region_buses)].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>) )</span>
<span id="cb49-478"><a href="#cb49-478" aria-hidden="true" tabindex="-1"></a>         dc <span class="op">=</span> ( n.links_t.p0.loc[start:end, n.links.bus1.isin(region_buses) <span class="op">&amp;</span> <span class="op">~</span>n.links.bus0.isin(region_buses)].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb49-479"><a href="#cb49-479" aria-hidden="true" tabindex="-1"></a>              <span class="op">+</span> n.links_t.p1.loc[start:end, n.links.bus0.isin(region_buses) <span class="op">&amp;</span> <span class="op">~</span>n.links.bus1.isin(region_buses)].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>) )</span>
<span id="cb49-480"><a href="#cb49-480" aria-hidden="true" tabindex="-1"></a>         p_slice[<span class="st">'Imports/Exports'</span>] <span class="op">=</span> (ac <span class="op">+</span> dc).div(<span class="fl">1e3</span>)</span>
<span id="cb49-481"><a href="#cb49-481" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> <span class="st">'Imports/Exports'</span> <span class="kw">not</span> <span class="kw">in</span> n.carriers.index:</span>
<span id="cb49-482"><a href="#cb49-482" aria-hidden="true" tabindex="-1"></a>             n.carriers.loc[<span class="st">'Imports/Exports'</span>,<span class="st">'color'</span>]<span class="op">=</span><span class="st">'#7f7f7f'</span></span>
<span id="cb49-483"><a href="#cb49-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-484"><a href="#cb49-484" aria-hidden="true" tabindex="-1"></a>     <span class="co"># 5) LOAD SERIES</span></span>
<span id="cb49-485"><a href="#cb49-485" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> regions:</span>
<span id="cb49-486"><a href="#cb49-486" aria-hidden="true" tabindex="-1"></a>         load_cols <span class="op">=</span> [c <span class="cf">for</span> c <span class="kw">in</span> n.loads[n.loads.bus.isin(regions)].index <span class="cf">if</span> c <span class="kw">in</span> n.loads_t.p_set]</span>
<span id="cb49-487"><a href="#cb49-487" aria-hidden="true" tabindex="-1"></a>         load_series <span class="op">=</span> n.loads_t.p_set[load_cols].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb49-488"><a href="#cb49-488" aria-hidden="true" tabindex="-1"></a>     <span class="cf">else</span>:</span>
<span id="cb49-489"><a href="#cb49-489" aria-hidden="true" tabindex="-1"></a>         load_series <span class="op">=</span> n.loads_t.p_set.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb49-490"><a href="#cb49-490" aria-hidden="true" tabindex="-1"></a>     load_series <span class="op">=</span> load_series.loc[start:end].div(<span class="fl">1e3</span>)</span>
<span id="cb49-491"><a href="#cb49-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-492"><a href="#cb49-492" aria-hidden="true" tabindex="-1"></a>     <span class="co"># 6) VRE CURTAILMENT (GW) if requested</span></span>
<span id="cb49-493"><a href="#cb49-493" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> show_curtailment:</span>
<span id="cb49-494"><a href="#cb49-494" aria-hidden="true" tabindex="-1"></a>         vre <span class="op">=</span> [<span class="st">'Solar'</span>,<span class="st">'Wind'</span>, <span class="st">'Rooftop Solar'</span>]</span>
<span id="cb49-495"><a href="#cb49-495" aria-hidden="true" tabindex="-1"></a>         mask_vre <span class="op">=</span> gen_mask <span class="op">&amp;</span> n.generators.carrier.isin(vre)</span>
<span id="cb49-496"><a href="#cb49-496" aria-hidden="true" tabindex="-1"></a>         avail <span class="op">=</span> (n.generators_t.p_max_pu.loc[start:end, mask_vre]</span>
<span id="cb49-497"><a href="#cb49-497" aria-hidden="true" tabindex="-1"></a>                  .multiply(n.generators.loc[mask_vre,<span class="st">'p_nom'</span>], axis<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb49-498"><a href="#cb49-498" aria-hidden="true" tabindex="-1"></a>         disp  <span class="op">=</span> n.generators_t.p.loc[start:end, mask_vre]</span>
<span id="cb49-499"><a href="#cb49-499" aria-hidden="true" tabindex="-1"></a>         curtail <span class="op">=</span> (avail.sub(disp, fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb49-500"><a href="#cb49-500" aria-hidden="true" tabindex="-1"></a>                        .clip(lower<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb49-501"><a href="#cb49-501" aria-hidden="true" tabindex="-1"></a>                        .<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb49-502"><a href="#cb49-502" aria-hidden="true" tabindex="-1"></a>                        .div(<span class="fl">1e3</span>))</span>
<span id="cb49-503"><a href="#cb49-503" aria-hidden="true" tabindex="-1"></a>     <span class="cf">else</span>:</span>
<span id="cb49-504"><a href="#cb49-504" aria-hidden="true" tabindex="-1"></a>         curtail <span class="op">=</span> <span class="va">None</span></span>
<span id="cb49-505"><a href="#cb49-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-506"><a href="#cb49-506" aria-hidden="true" tabindex="-1"></a>     <span class="co"># 7) PLOT</span></span>
<span id="cb49-507"><a href="#cb49-507" aria-hidden="true" tabindex="-1"></a>     title_tail <span class="op">=</span> <span class="ss">f" for </span><span class="sc">{</span><span class="st">', '</span><span class="sc">.</span>join(regions)<span class="sc">}</span><span class="ss">"</span> <span class="cf">if</span> regions <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb49-508"><a href="#cb49-508" aria-hidden="true" tabindex="-1"></a>     plot_title <span class="op">=</span> <span class="ss">f"Dispatch by Carrier: </span><span class="sc">{</span>start<span class="sc">.</span>date()<span class="sc">}</span><span class="ss"> to </span><span class="sc">{</span>end<span class="sc">.</span>date()<span class="sc">}{</span>title_tail<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb49-509"><a href="#cb49-509" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb49-510"><a href="#cb49-510" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> interactive:</span>
<span id="cb49-511"><a href="#cb49-511" aria-hidden="true" tabindex="-1"></a>         <span class="co"># PLOTLY INTERACTIVE PLOT</span></span>
<span id="cb49-512"><a href="#cb49-512" aria-hidden="true" tabindex="-1"></a>         fig <span class="op">=</span> go.Figure()</span>
<span id="cb49-513"><a href="#cb49-513" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb49-514"><a href="#cb49-514" aria-hidden="true" tabindex="-1"></a>         fig.update_layout(</span>
<span id="cb49-515"><a href="#cb49-515" aria-hidden="true" tabindex="-1"></a>            plot_bgcolor<span class="op">=</span><span class="st">'#F0FFFF'</span>,</span>
<span id="cb49-516"><a href="#cb49-516" aria-hidden="true" tabindex="-1"></a>            xaxis<span class="op">=</span><span class="bu">dict</span>(gridcolor<span class="op">=</span><span class="st">'#DDDDDD'</span>),</span>
<span id="cb49-517"><a href="#cb49-517" aria-hidden="true" tabindex="-1"></a>            yaxis<span class="op">=</span><span class="bu">dict</span>(gridcolor<span class="op">=</span><span class="st">'#DDDDDD'</span>)        <span class="co"># Plot area background</span></span>
<span id="cb49-518"><a href="#cb49-518" aria-hidden="true" tabindex="-1"></a>         ) </span>
<span id="cb49-519"><a href="#cb49-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-520"><a href="#cb49-520" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Prepare data for stacked area plot</span></span>
<span id="cb49-521"><a href="#cb49-521" aria-hidden="true" tabindex="-1"></a>         positive_data <span class="op">=</span> p_slice.where(p_slice <span class="op">&gt;</span> <span class="dv">0</span>).fillna(<span class="dv">0</span>)</span>
<span id="cb49-522"><a href="#cb49-522" aria-hidden="true" tabindex="-1"></a>         negative_data <span class="op">=</span> p_slice.where(p_slice <span class="op">&lt;</span> <span class="dv">0</span>).fillna(<span class="dv">0</span>)</span>
<span id="cb49-523"><a href="#cb49-523" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb49-524"><a href="#cb49-524" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Add positive generation as stacked area</span></span>
<span id="cb49-525"><a href="#cb49-525" aria-hidden="true" tabindex="-1"></a>         <span class="cf">for</span> i, col <span class="kw">in</span> <span class="bu">enumerate</span>(positive_data.columns):</span>
<span id="cb49-526"><a href="#cb49-526" aria-hidden="true" tabindex="-1"></a>             <span class="cf">if</span> positive_data[col].<span class="bu">sum</span>() <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb49-527"><a href="#cb49-527" aria-hidden="true" tabindex="-1"></a>                 color <span class="op">=</span> n.carriers.loc[col, <span class="st">'color'</span>]</span>
<span id="cb49-528"><a href="#cb49-528" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># Only add points where value &gt; 0.001</span></span>
<span id="cb49-529"><a href="#cb49-529" aria-hidden="true" tabindex="-1"></a>                 mask <span class="op">=</span> positive_data[col].<span class="bu">abs</span>() <span class="op">&gt;</span> <span class="fl">0.001</span></span>
<span id="cb49-530"><a href="#cb49-530" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">if</span> mask.<span class="bu">any</span>():</span>
<span id="cb49-531"><a href="#cb49-531" aria-hidden="true" tabindex="-1"></a>                     fig.add_trace(go.Scatter(</span>
<span id="cb49-532"><a href="#cb49-532" aria-hidden="true" tabindex="-1"></a>                         x<span class="op">=</span>positive_data.index[mask],</span>
<span id="cb49-533"><a href="#cb49-533" aria-hidden="true" tabindex="-1"></a>                         y<span class="op">=</span>positive_data[col][mask],</span>
<span id="cb49-534"><a href="#cb49-534" aria-hidden="true" tabindex="-1"></a>                         mode<span class="op">=</span><span class="st">'lines'</span>,</span>
<span id="cb49-535"><a href="#cb49-535" aria-hidden="true" tabindex="-1"></a>                         fill<span class="op">=</span><span class="st">'tonexty'</span> <span class="cf">if</span> i <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">'tozeroy'</span>,</span>
<span id="cb49-536"><a href="#cb49-536" aria-hidden="true" tabindex="-1"></a>                         line<span class="op">=</span><span class="bu">dict</span>(width<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span>color),</span>
<span id="cb49-537"><a href="#cb49-537" aria-hidden="true" tabindex="-1"></a>                         fillcolor<span class="op">=</span>color,</span>
<span id="cb49-538"><a href="#cb49-538" aria-hidden="true" tabindex="-1"></a>                         name<span class="op">=</span>col,</span>
<span id="cb49-539"><a href="#cb49-539" aria-hidden="true" tabindex="-1"></a>                         stackgroup<span class="op">=</span><span class="st">'positive'</span>,</span>
<span id="cb49-540"><a href="#cb49-540" aria-hidden="true" tabindex="-1"></a>                         hovertemplate<span class="op">=</span><span class="st">'&lt;b&gt;%</span><span class="sc">{fullData.name}</span><span class="st">&lt;/b&gt;&lt;br&gt;Power: %</span><span class="sc">{y:.3f}</span><span class="st"> GW&lt;extra&gt;&lt;/extra&gt;'</span>,</span>
<span id="cb49-541"><a href="#cb49-541" aria-hidden="true" tabindex="-1"></a>                         showlegend<span class="op">=</span><span class="va">True</span></span>
<span id="cb49-542"><a href="#cb49-542" aria-hidden="true" tabindex="-1"></a>                     ))</span>
<span id="cb49-543"><a href="#cb49-543" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb49-544"><a href="#cb49-544" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Add negative generation (storage charging, exports)</span></span>
<span id="cb49-545"><a href="#cb49-545" aria-hidden="true" tabindex="-1"></a>         <span class="cf">for</span> col <span class="kw">in</span> negative_data.columns:</span>
<span id="cb49-546"><a href="#cb49-546" aria-hidden="true" tabindex="-1"></a>             <span class="cf">if</span> negative_data[col].<span class="bu">sum</span>() <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb49-547"><a href="#cb49-547" aria-hidden="true" tabindex="-1"></a>                 color <span class="op">=</span> n.carriers.loc[col, <span class="st">'color'</span>]</span>
<span id="cb49-548"><a href="#cb49-548" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># Only add points where value &lt; -0.001</span></span>
<span id="cb49-549"><a href="#cb49-549" aria-hidden="true" tabindex="-1"></a>                 mask <span class="op">=</span> negative_data[col].<span class="bu">abs</span>() <span class="op">&gt;</span> <span class="fl">0.001</span></span>
<span id="cb49-550"><a href="#cb49-550" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">if</span> mask.<span class="bu">any</span>():</span>
<span id="cb49-551"><a href="#cb49-551" aria-hidden="true" tabindex="-1"></a>                     fig.add_trace(go.Scatter(</span>
<span id="cb49-552"><a href="#cb49-552" aria-hidden="true" tabindex="-1"></a>                         x<span class="op">=</span>negative_data.index[mask],</span>
<span id="cb49-553"><a href="#cb49-553" aria-hidden="true" tabindex="-1"></a>                         y<span class="op">=</span>negative_data[col][mask],</span>
<span id="cb49-554"><a href="#cb49-554" aria-hidden="true" tabindex="-1"></a>                         mode<span class="op">=</span><span class="st">'lines'</span>,</span>
<span id="cb49-555"><a href="#cb49-555" aria-hidden="true" tabindex="-1"></a>                         fill<span class="op">=</span><span class="st">'tonexty'</span>,</span>
<span id="cb49-556"><a href="#cb49-556" aria-hidden="true" tabindex="-1"></a>                         line<span class="op">=</span><span class="bu">dict</span>(width<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span>color),</span>
<span id="cb49-557"><a href="#cb49-557" aria-hidden="true" tabindex="-1"></a>                         fillcolor<span class="op">=</span>color,</span>
<span id="cb49-558"><a href="#cb49-558" aria-hidden="true" tabindex="-1"></a>                         name<span class="op">=</span>col,</span>
<span id="cb49-559"><a href="#cb49-559" aria-hidden="true" tabindex="-1"></a>                         stackgroup<span class="op">=</span><span class="st">'negative'</span>,</span>
<span id="cb49-560"><a href="#cb49-560" aria-hidden="true" tabindex="-1"></a>                         hovertemplate<span class="op">=</span><span class="st">'&lt;b&gt;%</span><span class="sc">{fullData.name}</span><span class="st">&lt;/b&gt;&lt;br&gt;Power: %</span><span class="sc">{y:.2f}</span><span class="st"> GW&lt;extra&gt;&lt;/extra&gt;'</span>,</span>
<span id="cb49-561"><a href="#cb49-561" aria-hidden="true" tabindex="-1"></a>                         showlegend<span class="op">=</span><span class="va">True</span></span>
<span id="cb49-562"><a href="#cb49-562" aria-hidden="true" tabindex="-1"></a>                     ))</span>
<span id="cb49-563"><a href="#cb49-563" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb49-564"><a href="#cb49-564" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Add demand line (always show)</span></span>
<span id="cb49-565"><a href="#cb49-565" aria-hidden="true" tabindex="-1"></a>         fig.add_trace(go.Scatter(</span>
<span id="cb49-566"><a href="#cb49-566" aria-hidden="true" tabindex="-1"></a>             x<span class="op">=</span>load_series.index,</span>
<span id="cb49-567"><a href="#cb49-567" aria-hidden="true" tabindex="-1"></a>             y<span class="op">=</span>load_series,</span>
<span id="cb49-568"><a href="#cb49-568" aria-hidden="true" tabindex="-1"></a>             mode<span class="op">=</span><span class="st">'lines'</span>,</span>
<span id="cb49-569"><a href="#cb49-569" aria-hidden="true" tabindex="-1"></a>             line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'green'</span>, width<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb49-570"><a href="#cb49-570" aria-hidden="true" tabindex="-1"></a>             name<span class="op">=</span><span class="st">'Demand'</span>,</span>
<span id="cb49-571"><a href="#cb49-571" aria-hidden="true" tabindex="-1"></a>             hovertemplate<span class="op">=</span><span class="st">'&lt;b&gt;Demand&lt;/b&gt;&lt;br&gt;Power: %</span><span class="sc">{y:.2f}</span><span class="st"> GW&lt;extra&gt;&lt;/extra&gt;'</span>,</span>
<span id="cb49-572"><a href="#cb49-572" aria-hidden="true" tabindex="-1"></a>             showlegend<span class="op">=</span><span class="va">True</span></span>
<span id="cb49-573"><a href="#cb49-573" aria-hidden="true" tabindex="-1"></a>         ))</span>
<span id="cb49-574"><a href="#cb49-574" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb49-575"><a href="#cb49-575" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Add curtailment line if requested</span></span>
<span id="cb49-576"><a href="#cb49-576" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> show_curtailment <span class="kw">and</span> curtail <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb49-577"><a href="#cb49-577" aria-hidden="true" tabindex="-1"></a>             fig.add_trace(go.Scatter(</span>
<span id="cb49-578"><a href="#cb49-578" aria-hidden="true" tabindex="-1"></a>                 x<span class="op">=</span>curtail.index,</span>
<span id="cb49-579"><a href="#cb49-579" aria-hidden="true" tabindex="-1"></a>                 y<span class="op">=</span>curtail,</span>
<span id="cb49-580"><a href="#cb49-580" aria-hidden="true" tabindex="-1"></a>                 mode<span class="op">=</span><span class="st">'lines'</span>,</span>
<span id="cb49-581"><a href="#cb49-581" aria-hidden="true" tabindex="-1"></a>                 line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>, width<span class="op">=</span><span class="dv">2</span>, dash<span class="op">=</span><span class="st">'dash'</span>),</span>
<span id="cb49-582"><a href="#cb49-582" aria-hidden="true" tabindex="-1"></a>                 name<span class="op">=</span><span class="st">'Curtailment'</span>,</span>
<span id="cb49-583"><a href="#cb49-583" aria-hidden="true" tabindex="-1"></a>                 hovertemplate<span class="op">=</span><span class="st">'&lt;b&gt;Curtailment&lt;/b&gt;&lt;br&gt;Power: %</span><span class="sc">{y:.2f}</span><span class="st"> GW&lt;extra&gt;&lt;/extra&gt;'</span>,</span>
<span id="cb49-584"><a href="#cb49-584" aria-hidden="true" tabindex="-1"></a>                 showlegend<span class="op">=</span><span class="va">True</span></span>
<span id="cb49-585"><a href="#cb49-585" aria-hidden="true" tabindex="-1"></a>                 ))</span>
<span id="cb49-586"><a href="#cb49-586" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb49-587"><a href="#cb49-587" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Update layout</span></span>
<span id="cb49-588"><a href="#cb49-588" aria-hidden="true" tabindex="-1"></a>         fig.update_layout(</span>
<span id="cb49-589"><a href="#cb49-589" aria-hidden="true" tabindex="-1"></a>             title<span class="op">=</span>plot_title,</span>
<span id="cb49-590"><a href="#cb49-590" aria-hidden="true" tabindex="-1"></a>             xaxis_title<span class="op">=</span><span class="st">'Time'</span>,</span>
<span id="cb49-591"><a href="#cb49-591" aria-hidden="true" tabindex="-1"></a>             yaxis_title<span class="op">=</span><span class="st">'Power (GW)'</span>,</span>
<span id="cb49-592"><a href="#cb49-592" aria-hidden="true" tabindex="-1"></a>             hovermode<span class="op">=</span><span class="st">'x unified'</span>,</span>
<span id="cb49-593"><a href="#cb49-593" aria-hidden="true" tabindex="-1"></a>             hoverlabel<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb49-594"><a href="#cb49-594" aria-hidden="true" tabindex="-1"></a>                 bgcolor<span class="op">=</span><span class="st">"white"</span>,</span>
<span id="cb49-595"><a href="#cb49-595" aria-hidden="true" tabindex="-1"></a>                 bordercolor<span class="op">=</span><span class="st">"black"</span>,</span>
<span id="cb49-596"><a href="#cb49-596" aria-hidden="true" tabindex="-1"></a>                 font_size<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb49-597"><a href="#cb49-597" aria-hidden="true" tabindex="-1"></a>             ),</span>
<span id="cb49-598"><a href="#cb49-598" aria-hidden="true" tabindex="-1"></a>             legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb49-599"><a href="#cb49-599" aria-hidden="true" tabindex="-1"></a>                 x<span class="op">=</span><span class="fl">1.02</span>,</span>
<span id="cb49-600"><a href="#cb49-600" aria-hidden="true" tabindex="-1"></a>                 y<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb49-601"><a href="#cb49-601" aria-hidden="true" tabindex="-1"></a>                 bgcolor<span class="op">=</span><span class="st">'rgba(255,255,255,0.8)'</span>,</span>
<span id="cb49-602"><a href="#cb49-602" aria-hidden="true" tabindex="-1"></a>                 bordercolor<span class="op">=</span><span class="st">'rgba(0,0,0,0.2)'</span>,</span>
<span id="cb49-603"><a href="#cb49-603" aria-hidden="true" tabindex="-1"></a>                 borderwidth<span class="op">=</span><span class="dv">1</span></span>
<span id="cb49-604"><a href="#cb49-604" aria-hidden="true" tabindex="-1"></a>             ),</span>
<span id="cb49-605"><a href="#cb49-605" aria-hidden="true" tabindex="-1"></a>             width<span class="op">=</span><span class="dv">800</span>,</span>
<span id="cb49-606"><a href="#cb49-606" aria-hidden="true" tabindex="-1"></a>             height<span class="op">=</span><span class="dv">500</span></span>
<span id="cb49-607"><a href="#cb49-607" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb49-608"><a href="#cb49-608" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb49-609"><a href="#cb49-609" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Add scenario annotations</span></span>
<span id="cb49-610"><a href="#cb49-610" aria-hidden="true" tabindex="-1"></a>         annotations <span class="op">=</span> []</span>
<span id="cb49-611"><a href="#cb49-611" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> scenario_name:</span>
<span id="cb49-612"><a href="#cb49-612" aria-hidden="true" tabindex="-1"></a>             annotations.append(</span>
<span id="cb49-613"><a href="#cb49-613" aria-hidden="true" tabindex="-1"></a>                 <span class="bu">dict</span>(</span>
<span id="cb49-614"><a href="#cb49-614" aria-hidden="true" tabindex="-1"></a>                     x<span class="op">=</span><span class="fl">1.02</span>, y<span class="op">=-</span><span class="fl">0.05</span>,</span>
<span id="cb49-615"><a href="#cb49-615" aria-hidden="true" tabindex="-1"></a>                     xref<span class="op">=</span><span class="st">'paper'</span>, yref<span class="op">=</span><span class="st">'paper'</span>,</span>
<span id="cb49-616"><a href="#cb49-616" aria-hidden="true" tabindex="-1"></a>                     text<span class="op">=</span><span class="ss">f"Scenario: </span><span class="sc">{</span>scenario_name<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb49-617"><a href="#cb49-617" aria-hidden="true" tabindex="-1"></a>                     showarrow<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb49-618"><a href="#cb49-618" aria-hidden="true" tabindex="-1"></a>                     font<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">'gray'</span>),</span>
<span id="cb49-619"><a href="#cb49-619" aria-hidden="true" tabindex="-1"></a>                     xanchor<span class="op">=</span><span class="st">'center'</span>,</span>
<span id="cb49-620"><a href="#cb49-620" aria-hidden="true" tabindex="-1"></a>                     yanchor<span class="op">=</span><span class="st">'top'</span></span>
<span id="cb49-621"><a href="#cb49-621" aria-hidden="true" tabindex="-1"></a>                 )</span>
<span id="cb49-622"><a href="#cb49-622" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb49-623"><a href="#cb49-623" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb49-624"><a href="#cb49-624" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> annotations:</span>
<span id="cb49-625"><a href="#cb49-625" aria-hidden="true" tabindex="-1"></a>             fig.update_layout(annotations<span class="op">=</span>annotations)</span>
<span id="cb49-626"><a href="#cb49-626" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb49-627"><a href="#cb49-627" aria-hidden="true" tabindex="-1"></a>         fig.show()</span>
<span id="cb49-628"><a href="#cb49-628" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb49-629"><a href="#cb49-629" aria-hidden="true" tabindex="-1"></a>     <span class="cf">else</span>:</span>
<span id="cb49-630"><a href="#cb49-630" aria-hidden="true" tabindex="-1"></a>         <span class="co"># MATPLOTLIB STATIC PLOT </span></span>
<span id="cb49-631"><a href="#cb49-631" aria-hidden="true" tabindex="-1"></a>         fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="fl">8.4</span>, <span class="fl">6.5</span>)) <span class="co">#12,6.5</span></span>
<span id="cb49-632"><a href="#cb49-632" aria-hidden="true" tabindex="-1"></a>         cols <span class="op">=</span> p_slice.columns.<span class="bu">map</span>(<span class="kw">lambda</span> c: n.carriers.loc[c,<span class="st">'color'</span>])</span>
<span id="cb49-633"><a href="#cb49-633" aria-hidden="true" tabindex="-1"></a>         p_slice.where(p_slice<span class="op">&gt;</span><span class="dv">0</span>).plot.area(ax<span class="op">=</span>ax,linewidth<span class="op">=</span><span class="dv">0</span>,color<span class="op">=</span>cols)</span>
<span id="cb49-634"><a href="#cb49-634" aria-hidden="true" tabindex="-1"></a>         neg <span class="op">=</span> p_slice.where(p_slice<span class="op">&lt;</span><span class="dv">0</span>).dropna(how<span class="op">=</span><span class="st">'all'</span>,axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb49-635"><a href="#cb49-635" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> <span class="kw">not</span> neg.empty:</span>
<span id="cb49-636"><a href="#cb49-636" aria-hidden="true" tabindex="-1"></a>             neg_cols<span class="op">=</span>[n.carriers.loc[c,<span class="st">'color'</span>] <span class="cf">for</span> c <span class="kw">in</span> neg.columns]</span>
<span id="cb49-637"><a href="#cb49-637" aria-hidden="true" tabindex="-1"></a>             neg.plot.area(ax<span class="op">=</span>ax,linewidth<span class="op">=</span><span class="dv">0</span>,color<span class="op">=</span>neg_cols)</span>
<span id="cb49-638"><a href="#cb49-638" aria-hidden="true" tabindex="-1"></a>         load_series.plot(ax<span class="op">=</span>ax,color<span class="op">=</span><span class="st">'g'</span>,linewidth<span class="op">=</span><span class="fl">1.5</span>,label<span class="op">=</span><span class="st">'Demand'</span>)</span>
<span id="cb49-639"><a href="#cb49-639" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> show_curtailment <span class="kw">and</span> curtail <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb49-640"><a href="#cb49-640" aria-hidden="true" tabindex="-1"></a>             curtail.plot(ax<span class="op">=</span>ax,color<span class="op">=</span><span class="st">'k'</span>,linestyle<span class="op">=</span><span class="st">'--'</span>,linewidth<span class="op">=</span><span class="fl">1.2</span>,label<span class="op">=</span><span class="st">'Curtailment'</span>)</span>
<span id="cb49-641"><a href="#cb49-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-642"><a href="#cb49-642" aria-hidden="true" tabindex="-1"></a>         <span class="co"># limits &amp; legend</span></span>
<span id="cb49-643"><a href="#cb49-643" aria-hidden="true" tabindex="-1"></a>         up <span class="op">=</span> <span class="bu">max</span>(p_slice.where(p_slice<span class="op">&gt;</span><span class="dv">0</span>).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>).<span class="bu">max</span>(),</span>
<span id="cb49-644"><a href="#cb49-644" aria-hidden="true" tabindex="-1"></a>                  load_series.<span class="bu">max</span>(),</span>
<span id="cb49-645"><a href="#cb49-645" aria-hidden="true" tabindex="-1"></a>                  curtail.<span class="bu">max</span>() <span class="cf">if</span> curtail <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span> <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb49-646"><a href="#cb49-646" aria-hidden="true" tabindex="-1"></a>         dn <span class="op">=</span> <span class="bu">min</span>(p_slice.where(p_slice<span class="op">&lt;</span><span class="dv">0</span>).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>).<span class="bu">min</span>(), load_series.<span class="bu">min</span>())</span>
<span id="cb49-647"><a href="#cb49-647" aria-hidden="true" tabindex="-1"></a>         ax.set_ylim(dn <span class="cf">if</span> <span class="kw">not</span> np.isclose(up,dn) <span class="cf">else</span> dn<span class="op">-</span><span class="fl">0.1</span>, up)</span>
<span id="cb49-648"><a href="#cb49-648" aria-hidden="true" tabindex="-1"></a>        <span class="co">#  fig.patch.set_facecolor('#F0FFFF') </span></span>
<span id="cb49-649"><a href="#cb49-649" aria-hidden="true" tabindex="-1"></a>         ax.set_facecolor(<span class="st">'#F0FFFF'</span>)</span>
<span id="cb49-650"><a href="#cb49-650" aria-hidden="true" tabindex="-1"></a>         h,l <span class="op">=</span> ax.get_legend_handles_labels()</span>
<span id="cb49-651"><a href="#cb49-651" aria-hidden="true" tabindex="-1"></a>         seen<span class="op">=</span>{} <span class="op">;</span> fh,fl<span class="op">=</span>[],[]</span>
<span id="cb49-652"><a href="#cb49-652" aria-hidden="true" tabindex="-1"></a>         <span class="cf">for</span> hh,ll <span class="kw">in</span> <span class="bu">zip</span>(h,l):</span>
<span id="cb49-653"><a href="#cb49-653" aria-hidden="true" tabindex="-1"></a>             <span class="cf">if</span> ll <span class="kw">not</span> <span class="kw">in</span> seen: fh.append(hh)<span class="op">;</span>fl.append(ll)<span class="op">;</span>seen[ll]<span class="op">=</span><span class="va">True</span></span>
<span id="cb49-654"><a href="#cb49-654" aria-hidden="true" tabindex="-1"></a>         ax.legend(fh,fl,loc<span class="op">=</span>(<span class="fl">1.02</span>,<span class="fl">0.67</span>), fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb49-655"><a href="#cb49-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-656"><a href="#cb49-656" aria-hidden="true" tabindex="-1"></a>         <span class="co"># scenario text</span></span>
<span id="cb49-657"><a href="#cb49-657" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> scenario_objective:</span>
<span id="cb49-658"><a href="#cb49-658" aria-hidden="true" tabindex="-1"></a>             ax.text(<span class="fl">1.02</span>,<span class="fl">0.01</span>,<span class="ss">f"Objective:</span><span class="ch">\n</span><span class="sc">{</span>scenario_objective<span class="sc">}</span><span class="ss">"</span>,transform<span class="op">=</span>ax.transAxes,</span>
<span id="cb49-659"><a href="#cb49-659" aria-hidden="true" tabindex="-1"></a>                     fontsize<span class="op">=</span><span class="dv">8</span>,va<span class="op">=</span><span class="st">'bottom'</span>,ha<span class="op">=</span><span class="st">'left'</span>,bbox<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">'white'</span>,alpha<span class="op">=</span><span class="fl">0.7</span>,edgecolor<span class="op">=</span><span class="st">'none'</span>))</span>
<span id="cb49-660"><a href="#cb49-660" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> scenario_name:</span>
<span id="cb49-661"><a href="#cb49-661" aria-hidden="true" tabindex="-1"></a>             ax.text(<span class="fl">1.02</span>,<span class="op">-</span><span class="fl">0.05</span>,<span class="ss">f"Scenario: </span><span class="sc">{</span>scenario_name<span class="sc">}</span><span class="ss">"</span>,transform<span class="op">=</span>ax.transAxes,</span>
<span id="cb49-662"><a href="#cb49-662" aria-hidden="true" tabindex="-1"></a>                     fontsize<span class="op">=</span><span class="dv">9</span>,color<span class="op">=</span><span class="st">'gray'</span>,ha<span class="op">=</span><span class="st">'center'</span>,va<span class="op">=</span><span class="st">'top'</span>)</span>
<span id="cb49-663"><a href="#cb49-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-664"><a href="#cb49-664" aria-hidden="true" tabindex="-1"></a>         ax.set_ylabel(<span class="st">'GW'</span>)</span>
<span id="cb49-665"><a href="#cb49-665" aria-hidden="true" tabindex="-1"></a>         ax.set_title(plot_title)</span>
<span id="cb49-666"><a href="#cb49-666" aria-hidden="true" tabindex="-1"></a>         plt.tight_layout()</span>
<span id="cb49-667"><a href="#cb49-667" aria-hidden="true" tabindex="-1"></a>         plt.show()</span>
<span id="cb49-668"><a href="#cb49-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-669"><a href="#cb49-669" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-670"><a href="#cb49-670" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-671"><a href="#cb49-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-672"><a href="#cb49-672" aria-hidden="true" tabindex="-1"></a>Review dispatch for a 5-day period in NSW.</span>
<span id="cb49-673"><a href="#cb49-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-674"><a href="#cb49-674" aria-hidden="true" tabindex="-1"></a>Note here that very little gas is dispatched due to having a higher marginal price than black coal. In reality the ramping up and down of coal plants is smoother than this. The hourly resolution does not constrain the ramping much compared to actual five-minute dispatching in the NEM. For example, Eraring black coal units maximum ramp-up of 4MW/min, is 240MW per model snapshot (hourly).</span>
<span id="cb49-675"><a href="#cb49-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-678"><a href="#cb49-678" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-679"><a href="#cb49-679" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb49-680"><a href="#cb49-680" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_dispatch function example - static plot of NSW1 region for 3 days starting from 2024-07-01</span></span>
<span id="cb49-681"><a href="#cb49-681" aria-hidden="true" tabindex="-1"></a>plot_dispatch(n, time<span class="op">=</span><span class="st">"2024-07-01"</span>, days<span class="op">=</span><span class="dv">5</span>, regions<span class="op">=</span>[<span class="st">"NSW1"</span>], show_imports<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb49-682"><a href="#cb49-682" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-683"><a href="#cb49-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-684"><a href="#cb49-684" aria-hidden="true" tabindex="-1"></a>The interactive version is good for exploratory data analysis.</span>
<span id="cb49-685"><a href="#cb49-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-688"><a href="#cb49-688" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-689"><a href="#cb49-689" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_dispatch function example - interactive plot of VIC1 region for 10 days starting from 2024-01-19</span></span>
<span id="cb49-690"><a href="#cb49-690" aria-hidden="true" tabindex="-1"></a>plot_dispatch(n, time<span class="op">=</span><span class="st">"2024-01-10"</span>, days<span class="op">=</span><span class="dv">5</span>, regions<span class="op">=</span>[<span class="st">"VIC1"</span>], show_imports<span class="op">=</span><span class="va">True</span>, interactive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb49-691"><a href="#cb49-691" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-692"><a href="#cb49-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-693"><a href="#cb49-693" aria-hidden="true" tabindex="-1"></a>Review the 2024 baseline model generator capacities. </span>
<span id="cb49-694"><a href="#cb49-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-695"><a href="#cb49-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-698"><a href="#cb49-698" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-699"><a href="#cb49-699" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_generator_capacity_by_carrier(network):</span>
<span id="cb49-700"><a href="#cb49-700" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb49-701"><a href="#cb49-701" aria-hidden="true" tabindex="-1"></a><span class="co">    Plot total generator capacity by carrier for a given PyPSA network,</span></span>
<span id="cb49-702"><a href="#cb49-702" aria-hidden="true" tabindex="-1"></a><span class="co">    excluding carriers with zero total capacity, and colour bars by carrier colour.</span></span>
<span id="cb49-703"><a href="#cb49-703" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb49-704"><a href="#cb49-704" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1) sum and filter</span></span>
<span id="cb49-705"><a href="#cb49-705" aria-hidden="true" tabindex="-1"></a>    capacity_by_carrier <span class="op">=</span> (</span>
<span id="cb49-706"><a href="#cb49-706" aria-hidden="true" tabindex="-1"></a>        network.generators</span>
<span id="cb49-707"><a href="#cb49-707" aria-hidden="true" tabindex="-1"></a>               .groupby(<span class="st">"carrier"</span>)</span>
<span id="cb49-708"><a href="#cb49-708" aria-hidden="true" tabindex="-1"></a>               .p_nom_opt</span>
<span id="cb49-709"><a href="#cb49-709" aria-hidden="true" tabindex="-1"></a>               .<span class="bu">sum</span>()</span>
<span id="cb49-710"><a href="#cb49-710" aria-hidden="true" tabindex="-1"></a>               .div(<span class="fl">1e3</span>)</span>
<span id="cb49-711"><a href="#cb49-711" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-712"><a href="#cb49-712" aria-hidden="true" tabindex="-1"></a>    capacity_by_carrier <span class="op">=</span> capacity_by_carrier[capacity_by_carrier <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb49-713"><a href="#cb49-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-714"><a href="#cb49-714" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2) get colors</span></span>
<span id="cb49-715"><a href="#cb49-715" aria-hidden="true" tabindex="-1"></a>    colors <span class="op">=</span> [</span>
<span id="cb49-716"><a href="#cb49-716" aria-hidden="true" tabindex="-1"></a>        network.carriers.loc[c, <span class="st">'color'</span>]</span>
<span id="cb49-717"><a href="#cb49-717" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c <span class="kw">in</span> network.carriers.index <span class="kw">and</span> <span class="st">'color'</span> <span class="kw">in</span> network.carriers.columns</span>
<span id="cb49-718"><a href="#cb49-718" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="st">'gray'</span></span>
<span id="cb49-719"><a href="#cb49-719" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> c <span class="kw">in</span> capacity_by_carrier.index</span>
<span id="cb49-720"><a href="#cb49-720" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb49-721"><a href="#cb49-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-722"><a href="#cb49-722" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 3) create fig &amp; ax, set backgrounds</span></span>
<span id="cb49-723"><a href="#cb49-723" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb49-724"><a href="#cb49-724" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fig.patch.set_facecolor('#F0FFFF')    # full-figure bg</span></span>
<span id="cb49-725"><a href="#cb49-725" aria-hidden="true" tabindex="-1"></a>               <span class="co"># axes bg</span></span>
<span id="cb49-726"><a href="#cb49-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-727"><a href="#cb49-727" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 4) plot onto that ax</span></span>
<span id="cb49-728"><a href="#cb49-728" aria-hidden="true" tabindex="-1"></a>    capacity_by_carrier.plot.barh(ax<span class="op">=</span>ax, color<span class="op">=</span>colors)</span>
<span id="cb49-729"><a href="#cb49-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-730"><a href="#cb49-730" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 5) labels &amp; layout</span></span>
<span id="cb49-731"><a href="#cb49-731" aria-hidden="true" tabindex="-1"></a>    ax.set_facecolor(<span class="st">'#F0FFFF'</span>)</span>
<span id="cb49-732"><a href="#cb49-732" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"GW"</span>)</span>
<span id="cb49-733"><a href="#cb49-733" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="st">"Total Generator Capacity by Carrier"</span>)</span>
<span id="cb49-734"><a href="#cb49-734" aria-hidden="true" tabindex="-1"></a>    fig.tight_layout()</span>
<span id="cb49-735"><a href="#cb49-735" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb49-736"><a href="#cb49-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-737"><a href="#cb49-737" aria-hidden="true" tabindex="-1"></a>plot_generator_capacity_by_carrier(n)</span>
<span id="cb49-738"><a href="#cb49-738" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-739"><a href="#cb49-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-740"><a href="#cb49-740" aria-hidden="true" tabindex="-1"></a>According to the AEMO's ISP Step Change - all coal fired generation will be retired by 2038.</span>
<span id="cb49-741"><a href="#cb49-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-742"><a href="#cb49-742" aria-hidden="true" tabindex="-1"></a>&lt;div style="text-align: center;"&gt;</span>
<span id="cb49-743"><a href="#cb49-743" aria-hidden="true" tabindex="-1"></a><span class="al">![ISP Step Change Coal Retirements](images/step-change-coal-retirments.png)</span></span>
<span id="cb49-744"><a href="#cb49-744" aria-hidden="true" tabindex="-1"></a>&lt;/div&gt;</span>
<span id="cb49-745"><a href="#cb49-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-746"><a href="#cb49-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-747"><a href="#cb49-747" aria-hidden="true" tabindex="-1"></a>Plot peak demand vs installed generation capacity per bus/region.</span>
<span id="cb49-748"><a href="#cb49-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-751"><a href="#cb49-751" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-752"><a href="#cb49-752" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_peak_demand_vs_capacity(network, stack_carrier<span class="op">=</span><span class="va">False</span>, relative<span class="op">=</span><span class="va">False</span>, sort_by<span class="op">=</span><span class="st">"Max Demand"</span>):</span>
<span id="cb49-753"><a href="#cb49-753" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb49-754"><a href="#cb49-754" aria-hidden="true" tabindex="-1"></a><span class="co">    Plot peak demand vs installed generation capacity per bus, filtering out zero-capacity carriers.</span></span>
<span id="cb49-755"><a href="#cb49-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-756"><a href="#cb49-756" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb49-757"><a href="#cb49-757" aria-hidden="true" tabindex="-1"></a><span class="co">    -----------</span></span>
<span id="cb49-758"><a href="#cb49-758" aria-hidden="true" tabindex="-1"></a><span class="co">    network : pypsa.Network</span></span>
<span id="cb49-759"><a href="#cb49-759" aria-hidden="true" tabindex="-1"></a><span class="co">        The PyPSA network object.</span></span>
<span id="cb49-760"><a href="#cb49-760" aria-hidden="true" tabindex="-1"></a><span class="co">    stack_carrier : bool, default=False</span></span>
<span id="cb49-761"><a href="#cb49-761" aria-hidden="true" tabindex="-1"></a><span class="co">        Whether to stack capacity by carrier or plot total capacity.</span></span>
<span id="cb49-762"><a href="#cb49-762" aria-hidden="true" tabindex="-1"></a><span class="co">    relative : bool, default=False</span></span>
<span id="cb49-763"><a href="#cb49-763" aria-hidden="true" tabindex="-1"></a><span class="co">        If True, plot capacity as a percentage of peak demand.</span></span>
<span id="cb49-764"><a href="#cb49-764" aria-hidden="true" tabindex="-1"></a><span class="co">    sort_by : str, optional</span></span>
<span id="cb49-765"><a href="#cb49-765" aria-hidden="true" tabindex="-1"></a><span class="co">        Column to sort buses by on the x-axis. Options: "Max Demand", "Total Capacity", or None.</span></span>
<span id="cb49-766"><a href="#cb49-766" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb49-767"><a href="#cb49-767" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- 1) Max demand per bus ---</span></span>
<span id="cb49-768"><a href="#cb49-768" aria-hidden="true" tabindex="-1"></a>    max_demand <span class="op">=</span> network.loads_t.p_set.<span class="bu">max</span>()</span>
<span id="cb49-769"><a href="#cb49-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-770"><a href="#cb49-770" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- 2) Capacity per bus and carrier ---</span></span>
<span id="cb49-771"><a href="#cb49-771" aria-hidden="true" tabindex="-1"></a>    capacity_by_bus_carrier <span class="op">=</span> (</span>
<span id="cb49-772"><a href="#cb49-772" aria-hidden="true" tabindex="-1"></a>        network.generators.groupby([<span class="st">'bus'</span>, <span class="st">'carrier'</span>])</span>
<span id="cb49-773"><a href="#cb49-773" aria-hidden="true" tabindex="-1"></a>        .p_nom_opt.<span class="bu">sum</span>()</span>
<span id="cb49-774"><a href="#cb49-774" aria-hidden="true" tabindex="-1"></a>        .unstack(fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb49-775"><a href="#cb49-775" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-776"><a href="#cb49-776" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter out carriers with zero total capacity</span></span>
<span id="cb49-777"><a href="#cb49-777" aria-hidden="true" tabindex="-1"></a>    nonzero_carriers <span class="op">=</span> capacity_by_bus_carrier.columns[capacity_by_bus_carrier.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>) <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb49-778"><a href="#cb49-778" aria-hidden="true" tabindex="-1"></a>    capacity_by_bus_carrier <span class="op">=</span> capacity_by_bus_carrier[nonzero_carriers]</span>
<span id="cb49-779"><a href="#cb49-779" aria-hidden="true" tabindex="-1"></a>    total_capacity <span class="op">=</span> capacity_by_bus_carrier.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb49-780"><a href="#cb49-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-781"><a href="#cb49-781" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- 3) Combine DataFrame and filter out zero-demand &amp; zero-capacity buses ---</span></span>
<span id="cb49-782"><a href="#cb49-782" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.concat([max_demand.rename(<span class="st">"Max Demand"</span>),</span>
<span id="cb49-783"><a href="#cb49-783" aria-hidden="true" tabindex="-1"></a>                    total_capacity.rename(<span class="st">"Total Capacity"</span>)], axis<span class="op">=</span><span class="dv">1</span>).fillna(<span class="dv">0</span>)</span>
<span id="cb49-784"><a href="#cb49-784" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df[(df[<span class="st">"Max Demand"</span>] <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">|</span> (df[<span class="st">"Total Capacity"</span>] <span class="op">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb49-785"><a href="#cb49-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-786"><a href="#cb49-786" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- 4) Relative scaling if requested ---</span></span>
<span id="cb49-787"><a href="#cb49-787" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> relative:</span>
<span id="cb49-788"><a href="#cb49-788" aria-hidden="true" tabindex="-1"></a>        <span class="co"># avoid div-by-zero</span></span>
<span id="cb49-789"><a href="#cb49-789" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">"Max Demand"</span>] <span class="op">=</span> df[<span class="st">"Max Demand"</span>].replace(<span class="dv">0</span>, np.nan)</span>
<span id="cb49-790"><a href="#cb49-790" aria-hidden="true" tabindex="-1"></a>        relative_capacity <span class="op">=</span> capacity_by_bus_carrier.div(df[<span class="st">"Max Demand"</span>], axis<span class="op">=</span><span class="dv">0</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb49-791"><a href="#cb49-791" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">"Total Capacity"</span>] <span class="op">=</span> df[<span class="st">"Total Capacity"</span>] <span class="op">/</span> df[<span class="st">"Max Demand"</span>] <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb49-792"><a href="#cb49-792" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">"Max Demand"</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb49-793"><a href="#cb49-793" aria-hidden="true" tabindex="-1"></a>        ylabel <span class="op">=</span> <span class="st">"Capacity as </span><span class="sc">% o</span><span class="st">f Peak Demand"</span></span>
<span id="cb49-794"><a href="#cb49-794" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb49-795"><a href="#cb49-795" aria-hidden="true" tabindex="-1"></a>        <span class="co"># convert to GW</span></span>
<span id="cb49-796"><a href="#cb49-796" aria-hidden="true" tabindex="-1"></a>        df[[<span class="st">"Max Demand"</span>, <span class="st">"Total Capacity"</span>]] <span class="op">=</span> df[[<span class="st">"Max Demand"</span>, <span class="st">"Total Capacity"</span>]] <span class="op">/</span> <span class="fl">1e3</span></span>
<span id="cb49-797"><a href="#cb49-797" aria-hidden="true" tabindex="-1"></a>        relative_capacity <span class="op">=</span> capacity_by_bus_carrier <span class="op">/</span> <span class="fl">1e3</span></span>
<span id="cb49-798"><a href="#cb49-798" aria-hidden="true" tabindex="-1"></a>        ylabel <span class="op">=</span> <span class="st">"GW"</span></span>
<span id="cb49-799"><a href="#cb49-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-800"><a href="#cb49-800" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- 5) Sort if needed ---</span></span>
<span id="cb49-801"><a href="#cb49-801" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> sort_by <span class="kw">in</span> df.columns:</span>
<span id="cb49-802"><a href="#cb49-802" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> df.sort_values(by<span class="op">=</span>sort_by, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb49-803"><a href="#cb49-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-804"><a href="#cb49-804" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- 6) Plotting ---</span></span>
<span id="cb49-805"><a href="#cb49-805" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb49-806"><a href="#cb49-806" aria-hidden="true" tabindex="-1"></a>    bar_width <span class="op">=</span> <span class="fl">0.35</span></span>
<span id="cb49-807"><a href="#cb49-807" aria-hidden="true" tabindex="-1"></a>    bar_pos <span class="op">=</span> np.arange(<span class="bu">len</span>(df))</span>
<span id="cb49-808"><a href="#cb49-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-809"><a href="#cb49-809" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> stack_carrier:</span>
<span id="cb49-810"><a href="#cb49-810" aria-hidden="true" tabindex="-1"></a>        <span class="co"># stack each non-zero carrier</span></span>
<span id="cb49-811"><a href="#cb49-811" aria-hidden="true" tabindex="-1"></a>        bottom <span class="op">=</span> np.zeros(<span class="bu">len</span>(df))</span>
<span id="cb49-812"><a href="#cb49-812" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> carrier <span class="kw">in</span> capacity_by_bus_carrier.columns:</span>
<span id="cb49-813"><a href="#cb49-813" aria-hidden="true" tabindex="-1"></a>            vals <span class="op">=</span> relative_capacity[carrier].reindex(df.index).fillna(<span class="dv">0</span>).values</span>
<span id="cb49-814"><a href="#cb49-814" aria-hidden="true" tabindex="-1"></a>            color <span class="op">=</span> (network.carriers.loc[carrier, <span class="st">'color'</span>]</span>
<span id="cb49-815"><a href="#cb49-815" aria-hidden="true" tabindex="-1"></a>                     <span class="cf">if</span> <span class="st">'color'</span> <span class="kw">in</span> network.carriers.columns <span class="kw">and</span> carrier <span class="kw">in</span> network.carriers.index</span>
<span id="cb49-816"><a href="#cb49-816" aria-hidden="true" tabindex="-1"></a>                     <span class="cf">else</span> <span class="va">None</span>)</span>
<span id="cb49-817"><a href="#cb49-817" aria-hidden="true" tabindex="-1"></a>            ax.bar(bar_pos <span class="op">+</span> bar_width<span class="op">/</span><span class="dv">2</span>, vals, bar_width,</span>
<span id="cb49-818"><a href="#cb49-818" aria-hidden="true" tabindex="-1"></a>                   bottom<span class="op">=</span>bottom, label<span class="op">=</span>carrier, color<span class="op">=</span>color)</span>
<span id="cb49-819"><a href="#cb49-819" aria-hidden="true" tabindex="-1"></a>            bottom <span class="op">+=</span> vals</span>
<span id="cb49-820"><a href="#cb49-820" aria-hidden="true" tabindex="-1"></a>        <span class="co"># plot peak demand on left</span></span>
<span id="cb49-821"><a href="#cb49-821" aria-hidden="true" tabindex="-1"></a>        ax.bar(bar_pos <span class="op">-</span> bar_width<span class="op">/</span><span class="dv">2</span>, df[<span class="st">"Max Demand"</span>], bar_width,</span>
<span id="cb49-822"><a href="#cb49-822" aria-hidden="true" tabindex="-1"></a>               label<span class="op">=</span><span class="st">'Peak Demand'</span>, color<span class="op">=</span><span class="st">'gray'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb49-823"><a href="#cb49-823" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb49-824"><a href="#cb49-824" aria-hidden="true" tabindex="-1"></a>        ax.bar(bar_pos <span class="op">-</span> bar_width<span class="op">/</span><span class="dv">2</span>, df[<span class="st">"Max Demand"</span>], bar_width,</span>
<span id="cb49-825"><a href="#cb49-825" aria-hidden="true" tabindex="-1"></a>               label<span class="op">=</span><span class="st">'Peak Demand'</span>, color<span class="op">=</span><span class="st">'gray'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb49-826"><a href="#cb49-826" aria-hidden="true" tabindex="-1"></a>        ax.bar(bar_pos <span class="op">+</span> bar_width<span class="op">/</span><span class="dv">2</span>, df[<span class="st">"Total Capacity"</span>], bar_width,</span>
<span id="cb49-827"><a href="#cb49-827" aria-hidden="true" tabindex="-1"></a>               label<span class="op">=</span><span class="st">'Total Capacity'</span>, color<span class="op">=</span><span class="st">'tab:blue'</span>)</span>
<span id="cb49-828"><a href="#cb49-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-829"><a href="#cb49-829" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- 7) Labels and legend ---</span></span>
<span id="cb49-830"><a href="#cb49-830" aria-hidden="true" tabindex="-1"></a>    ax.set_xticks(bar_pos)</span>
<span id="cb49-831"><a href="#cb49-831" aria-hidden="true" tabindex="-1"></a>    ax.set_xticklabels(df.index, rotation<span class="op">=</span><span class="dv">0</span>, ha<span class="op">=</span><span class="st">'right'</span>, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb49-832"><a href="#cb49-832" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(ylabel)</span>
<span id="cb49-833"><a href="#cb49-833" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fig.patch.set_facecolor('#F0FFFF') </span></span>
<span id="cb49-834"><a href="#cb49-834" aria-hidden="true" tabindex="-1"></a>    ax.set_facecolor(<span class="st">'#F0FFFF'</span>)</span>
<span id="cb49-835"><a href="#cb49-835" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"Region/Bus"</span>)</span>
<span id="cb49-836"><a href="#cb49-836" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="st">"Peak Demand vs Generation Capacity per Region"</span> <span class="op">+</span> (<span class="st">" (Relative)"</span> <span class="cf">if</span> relative <span class="cf">else</span> <span class="st">""</span>))</span>
<span id="cb49-837"><a href="#cb49-837" aria-hidden="true" tabindex="-1"></a>    ax.grid(<span class="va">True</span>)</span>
<span id="cb49-838"><a href="#cb49-838" aria-hidden="true" tabindex="-1"></a>    <span class="co"># place legend outside</span></span>
<span id="cb49-839"><a href="#cb49-839" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ax.legend(loc='upper left', bbox_to_anchor=(1.01, 1.0))</span></span>
<span id="cb49-840"><a href="#cb49-840" aria-hidden="true" tabindex="-1"></a>    ax.legend(loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb49-841"><a href="#cb49-841" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb49-842"><a href="#cb49-842" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb49-843"><a href="#cb49-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-844"><a href="#cb49-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-845"><a href="#cb49-845" aria-hidden="true" tabindex="-1"></a>plot_peak_demand_vs_capacity(n, stack_carrier<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb49-846"><a href="#cb49-846" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-847"><a href="#cb49-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-848"><a href="#cb49-848" aria-hidden="true" tabindex="-1"></a>Plot total electricity demand vs generation per bus/region.</span>
<span id="cb49-849"><a href="#cb49-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-852"><a href="#cb49-852" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-853"><a href="#cb49-853" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_total_demand_vs_generation(network, stack_carrier<span class="op">=</span><span class="va">False</span>, relative<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb49-854"><a href="#cb49-854" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb49-855"><a href="#cb49-855" aria-hidden="true" tabindex="-1"></a><span class="co">    Plot total electricity demand vs generation per bus.</span></span>
<span id="cb49-856"><a href="#cb49-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-857"><a href="#cb49-857" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb49-858"><a href="#cb49-858" aria-hidden="true" tabindex="-1"></a><span class="co">    - network: PyPSA Network object</span></span>
<span id="cb49-859"><a href="#cb49-859" aria-hidden="true" tabindex="-1"></a><span class="co">    - stack_carrier: If True, stack generation by carrier (color-coded)</span></span>
<span id="cb49-860"><a href="#cb49-860" aria-hidden="true" tabindex="-1"></a><span class="co">    - relative: If True, show generation as % of total demand (demand = 100%)</span></span>
<span id="cb49-861"><a href="#cb49-861" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb49-862"><a href="#cb49-862" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total demand per bus in GWh</span></span>
<span id="cb49-863"><a href="#cb49-863" aria-hidden="true" tabindex="-1"></a>    total_demand_per_bus <span class="op">=</span> network.loads_t.p_set.<span class="bu">sum</span>().div(<span class="fl">1e3</span>)</span>
<span id="cb49-864"><a href="#cb49-864" aria-hidden="true" tabindex="-1"></a>    total_demand_per_bus.name <span class="op">=</span> <span class="st">"Total Demand"</span></span>
<span id="cb49-865"><a href="#cb49-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-866"><a href="#cb49-866" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total generation per generator in GWh</span></span>
<span id="cb49-867"><a href="#cb49-867" aria-hidden="true" tabindex="-1"></a>    gen_energy <span class="op">=</span> network.generators_t.p.<span class="bu">sum</span>().div(<span class="fl">1e3</span>)</span>
<span id="cb49-868"><a href="#cb49-868" aria-hidden="true" tabindex="-1"></a>    gen_info <span class="op">=</span> network.generators[[<span class="st">"bus"</span>, <span class="st">"carrier"</span>]]</span>
<span id="cb49-869"><a href="#cb49-869" aria-hidden="true" tabindex="-1"></a>    gen_energy_by_carrier <span class="op">=</span> (</span>
<span id="cb49-870"><a href="#cb49-870" aria-hidden="true" tabindex="-1"></a>        gen_info.assign(energy<span class="op">=</span>gen_energy)</span>
<span id="cb49-871"><a href="#cb49-871" aria-hidden="true" tabindex="-1"></a>        .groupby([<span class="st">"bus"</span>, <span class="st">"carrier"</span>])[<span class="st">"energy"</span>]</span>
<span id="cb49-872"><a href="#cb49-872" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">sum</span>()</span>
<span id="cb49-873"><a href="#cb49-873" aria-hidden="true" tabindex="-1"></a>        .unstack(fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb49-874"><a href="#cb49-874" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-875"><a href="#cb49-875" aria-hidden="true" tabindex="-1"></a>    total_generation_per_bus <span class="op">=</span> gen_energy_by_carrier.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb49-876"><a href="#cb49-876" aria-hidden="true" tabindex="-1"></a>    total_generation_per_bus.name <span class="op">=</span> <span class="st">"Total Generation"</span></span>
<span id="cb49-877"><a href="#cb49-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-878"><a href="#cb49-878" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Join and filter</span></span>
<span id="cb49-879"><a href="#cb49-879" aria-hidden="true" tabindex="-1"></a>    generation_vs_demand <span class="op">=</span> pd.concat([total_demand_per_bus, total_generation_per_bus], axis<span class="op">=</span><span class="dv">1</span>).fillna(<span class="dv">0</span>)</span>
<span id="cb49-880"><a href="#cb49-880" aria-hidden="true" tabindex="-1"></a>    generation_vs_demand <span class="op">=</span> generation_vs_demand.loc[</span>
<span id="cb49-881"><a href="#cb49-881" aria-hidden="true" tabindex="-1"></a>        (generation_vs_demand[<span class="st">"Total Demand"</span>] <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">|</span> (generation_vs_demand[<span class="st">"Total Generation"</span>] <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb49-882"><a href="#cb49-882" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb49-883"><a href="#cb49-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-884"><a href="#cb49-884" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> relative:</span>
<span id="cb49-885"><a href="#cb49-885" aria-hidden="true" tabindex="-1"></a>        generation_vs_demand[<span class="st">"Total Demand"</span>].replace(<span class="dv">0</span>, np.nan, inplace<span class="op">=</span><span class="va">True</span>)  <span class="co"># avoid div by 0</span></span>
<span id="cb49-886"><a href="#cb49-886" aria-hidden="true" tabindex="-1"></a>        generation_vs_demand.sort_values(by<span class="op">=</span><span class="st">"Total Demand"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb49-887"><a href="#cb49-887" aria-hidden="true" tabindex="-1"></a>        relative_generation <span class="op">=</span> gen_energy_by_carrier.div(generation_vs_demand[<span class="st">"Total Demand"</span>], axis<span class="op">=</span><span class="dv">0</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb49-888"><a href="#cb49-888" aria-hidden="true" tabindex="-1"></a>        generation_vs_demand[<span class="st">"Total Generation"</span>] <span class="op">=</span> (</span>
<span id="cb49-889"><a href="#cb49-889" aria-hidden="true" tabindex="-1"></a>            generation_vs_demand[<span class="st">"Total Generation"</span>] <span class="op">/</span> generation_vs_demand[<span class="st">"Total Demand"</span>] <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb49-890"><a href="#cb49-890" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb49-891"><a href="#cb49-891" aria-hidden="true" tabindex="-1"></a>        generation_vs_demand[<span class="st">"Total Demand"</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb49-892"><a href="#cb49-892" aria-hidden="true" tabindex="-1"></a>        ylabel <span class="op">=</span> <span class="st">"Generation vs Demand (%)"</span></span>
<span id="cb49-893"><a href="#cb49-893" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb49-894"><a href="#cb49-894" aria-hidden="true" tabindex="-1"></a>        relative_generation <span class="op">=</span> gen_energy_by_carrier</span>
<span id="cb49-895"><a href="#cb49-895" aria-hidden="true" tabindex="-1"></a>        ylabel <span class="op">=</span> <span class="st">"GWh"</span></span>
<span id="cb49-896"><a href="#cb49-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-897"><a href="#cb49-897" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sort by Total Demand (descending) and reindex    </span></span>
<span id="cb49-898"><a href="#cb49-898" aria-hidden="true" tabindex="-1"></a>    generation_vs_demand <span class="op">=</span> generation_vs_demand.sort_values(by<span class="op">=</span><span class="st">"Total Demand"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb49-899"><a href="#cb49-899" aria-hidden="true" tabindex="-1"></a>    relative_generation <span class="op">=</span> relative_generation.reindex(generation_vs_demand.index)</span>
<span id="cb49-900"><a href="#cb49-900" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-901"><a href="#cb49-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-902"><a href="#cb49-902" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot</span></span>
<span id="cb49-903"><a href="#cb49-903" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb49-904"><a href="#cb49-904" aria-hidden="true" tabindex="-1"></a>    bar_width <span class="op">=</span> <span class="fl">0.35</span></span>
<span id="cb49-905"><a href="#cb49-905" aria-hidden="true" tabindex="-1"></a>    bar_positions <span class="op">=</span> np.arange(<span class="bu">len</span>(generation_vs_demand))</span>
<span id="cb49-906"><a href="#cb49-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-907"><a href="#cb49-907" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> stack_carrier:</span>
<span id="cb49-908"><a href="#cb49-908" aria-hidden="true" tabindex="-1"></a>        bottom <span class="op">=</span> np.zeros(<span class="bu">len</span>(generation_vs_demand))</span>
<span id="cb49-909"><a href="#cb49-909" aria-hidden="true" tabindex="-1"></a>        carriers <span class="op">=</span> [</span>
<span id="cb49-910"><a href="#cb49-910" aria-hidden="true" tabindex="-1"></a>        c <span class="cf">for</span> c <span class="kw">in</span> relative_generation.columns</span>
<span id="cb49-911"><a href="#cb49-911" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (c <span class="kw">in</span> network.carriers.index) <span class="kw">and</span> (relative_generation.loc[generation_vs_demand.index, c].<span class="bu">sum</span>() <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb49-912"><a href="#cb49-912" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb49-913"><a href="#cb49-913" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> carrier <span class="kw">in</span> carriers:</span>
<span id="cb49-914"><a href="#cb49-914" aria-hidden="true" tabindex="-1"></a>            values <span class="op">=</span> relative_generation.get(carrier, pd.Series(<span class="dv">0</span>, index<span class="op">=</span>generation_vs_demand.index))</span>
<span id="cb49-915"><a href="#cb49-915" aria-hidden="true" tabindex="-1"></a>            color <span class="op">=</span> network.carriers.loc[carrier, <span class="st">'color'</span>] <span class="cf">if</span> <span class="st">'color'</span> <span class="kw">in</span> network.carriers.columns <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb49-916"><a href="#cb49-916" aria-hidden="true" tabindex="-1"></a>            ax.bar(</span>
<span id="cb49-917"><a href="#cb49-917" aria-hidden="true" tabindex="-1"></a>                bar_positions <span class="op">+</span> bar_width <span class="op">/</span> <span class="dv">2</span>, values, bar_width,</span>
<span id="cb49-918"><a href="#cb49-918" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="ss">f'Generation (</span><span class="sc">{</span>carrier<span class="sc">}</span><span class="ss">)'</span>, bottom<span class="op">=</span>bottom, color<span class="op">=</span>color</span>
<span id="cb49-919"><a href="#cb49-919" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb49-920"><a href="#cb49-920" aria-hidden="true" tabindex="-1"></a>            bottom <span class="op">+=</span> values.values</span>
<span id="cb49-921"><a href="#cb49-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-922"><a href="#cb49-922" aria-hidden="true" tabindex="-1"></a>        ax.bar(</span>
<span id="cb49-923"><a href="#cb49-923" aria-hidden="true" tabindex="-1"></a>            bar_positions <span class="op">-</span> bar_width <span class="op">/</span> <span class="dv">2</span>,</span>
<span id="cb49-924"><a href="#cb49-924" aria-hidden="true" tabindex="-1"></a>            generation_vs_demand[<span class="st">"Total Demand"</span>],</span>
<span id="cb49-925"><a href="#cb49-925" aria-hidden="true" tabindex="-1"></a>            bar_width,</span>
<span id="cb49-926"><a href="#cb49-926" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">"Total Demand"</span>,</span>
<span id="cb49-927"><a href="#cb49-927" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span><span class="st">"gray"</span>, alpha<span class="op">=</span><span class="fl">0.7</span></span>
<span id="cb49-928"><a href="#cb49-928" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb49-929"><a href="#cb49-929" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb49-930"><a href="#cb49-930" aria-hidden="true" tabindex="-1"></a>        ax.bar(</span>
<span id="cb49-931"><a href="#cb49-931" aria-hidden="true" tabindex="-1"></a>            bar_positions <span class="op">-</span> bar_width <span class="op">/</span> <span class="dv">2</span>,</span>
<span id="cb49-932"><a href="#cb49-932" aria-hidden="true" tabindex="-1"></a>            generation_vs_demand[<span class="st">"Total Demand"</span>],</span>
<span id="cb49-933"><a href="#cb49-933" aria-hidden="true" tabindex="-1"></a>            bar_width,</span>
<span id="cb49-934"><a href="#cb49-934" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">"Total Demand"</span>,</span>
<span id="cb49-935"><a href="#cb49-935" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span><span class="st">"gray"</span>, alpha<span class="op">=</span><span class="fl">0.7</span></span>
<span id="cb49-936"><a href="#cb49-936" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb49-937"><a href="#cb49-937" aria-hidden="true" tabindex="-1"></a>        ax.bar(</span>
<span id="cb49-938"><a href="#cb49-938" aria-hidden="true" tabindex="-1"></a>            bar_positions <span class="op">+</span> bar_width <span class="op">/</span> <span class="dv">2</span>,</span>
<span id="cb49-939"><a href="#cb49-939" aria-hidden="true" tabindex="-1"></a>            generation_vs_demand[<span class="st">"Total Generation"</span>],</span>
<span id="cb49-940"><a href="#cb49-940" aria-hidden="true" tabindex="-1"></a>            bar_width,</span>
<span id="cb49-941"><a href="#cb49-941" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">"Total Generation"</span>,</span>
<span id="cb49-942"><a href="#cb49-942" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span><span class="st">"tab:blue"</span></span>
<span id="cb49-943"><a href="#cb49-943" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb49-944"><a href="#cb49-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-945"><a href="#cb49-945" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-946"><a href="#cb49-946" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"Region/Bus"</span>)</span>
<span id="cb49-947"><a href="#cb49-947" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(ylabel)</span>
<span id="cb49-948"><a href="#cb49-948" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="st">"Total Demand vs Total Generation per Region"</span> <span class="op">+</span> (<span class="st">" (Relative)"</span> <span class="cf">if</span> relative <span class="cf">else</span> <span class="st">""</span>))</span>
<span id="cb49-949"><a href="#cb49-949" aria-hidden="true" tabindex="-1"></a>    ax.set_xticks(bar_positions)</span>
<span id="cb49-950"><a href="#cb49-950" aria-hidden="true" tabindex="-1"></a>    ax.set_xticklabels(generation_vs_demand.index, rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">"right"</span>)</span>
<span id="cb49-951"><a href="#cb49-951" aria-hidden="true" tabindex="-1"></a>    ax.set_facecolor(<span class="st">'#F0FFFF'</span>)</span>
<span id="cb49-952"><a href="#cb49-952" aria-hidden="true" tabindex="-1"></a>    ax.legend(loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb49-953"><a href="#cb49-953" aria-hidden="true" tabindex="-1"></a>    ax.grid(<span class="va">True</span>)</span>
<span id="cb49-954"><a href="#cb49-954" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb49-955"><a href="#cb49-955" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb49-956"><a href="#cb49-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-957"><a href="#cb49-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-958"><a href="#cb49-958" aria-hidden="true" tabindex="-1"></a>plot_total_demand_vs_generation(n, stack_carrier<span class="op">=</span><span class="va">True</span>, relative<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb49-959"><a href="#cb49-959" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-960"><a href="#cb49-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-961"><a href="#cb49-961" aria-hidden="true" tabindex="-1"></a>Load previously generated scenario data.</span>
<span id="cb49-962"><a href="#cb49-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-963"><a href="#cb49-963" aria-hidden="true" tabindex="-1"></a>The <span class="in">`0_2024_baseline`</span> scenario is the baseline and hence scale-up factor is 1. The 19 others are scaled up from the baseline model according to the Objective column.</span>
<span id="cb49-964"><a href="#cb49-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-965"><a href="#cb49-965" aria-hidden="true" tabindex="-1"></a>Note: some of the scenarios have unserved energy, which tends to show up in NSW and VIC before other regions.</span>
<span id="cb49-966"><a href="#cb49-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-969"><a href="#cb49-969" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-970"><a href="#cb49-970" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: asis</span></span>
<span id="cb49-971"><a href="#cb49-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-972"><a href="#cb49-972" aria-hidden="true" tabindex="-1"></a><span class="co"># Previously saved results generated from the generate_scenarios function in the Appendix</span></span>
<span id="cb49-973"><a href="#cb49-973" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: 0_2024_baseline is the baseline scenario and is equivalent to 'high-level_nem'.</span></span>
<span id="cb49-974"><a href="#cb49-974" aria-hidden="true" tabindex="-1"></a>df_results <span class="op">=</span> pd.read_csv(<span class="st">"results/scenarios/scenarios_summary_20250711_1007.csv"</span>)</span>
<span id="cb49-975"><a href="#cb49-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-976"><a href="#cb49-976" aria-hidden="true" tabindex="-1"></a><span class="co"># Format in a more user-friendly format for HTML</span></span>
<span id="cb49-977"><a href="#cb49-977" aria-hidden="true" tabindex="-1"></a>results_tbl <span class="op">=</span> df_results.copy()</span>
<span id="cb49-978"><a href="#cb49-978" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> df_results.select_dtypes(include<span class="op">=</span>[<span class="st">'object'</span>]).columns:</span>
<span id="cb49-979"><a href="#cb49-979" aria-hidden="true" tabindex="-1"></a>    results_tbl[col] <span class="op">=</span> results_tbl[col].<span class="bu">str</span>.replace(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>, <span class="st">'&lt;br&gt;'</span>, regex<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb49-980"><a href="#cb49-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-981"><a href="#cb49-981" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop to make more space.</span></span>
<span id="cb49-982"><a href="#cb49-982" aria-hidden="true" tabindex="-1"></a>results_tbl <span class="op">=</span> results_tbl.drop([<span class="st">'Unserved Energy (GWh)'</span>, <span class="st">'Battery Capacity (GW)'</span>, <span class="st">'Wind &amp; Solar Curtailment (GWh)'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb49-983"><a href="#cb49-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-984"><a href="#cb49-984" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the last column name</span></span>
<span id="cb49-985"><a href="#cb49-985" aria-hidden="true" tabindex="-1"></a>last_col <span class="op">=</span> results_tbl.columns[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb49-986"><a href="#cb49-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-987"><a href="#cb49-987" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply conditional formatting to the last column (which contains dictionary-like data)</span></span>
<span id="cb49-988"><a href="#cb49-988" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_last_column(val):</span>
<span id="cb49-989"><a href="#cb49-989" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pd.isna(val) <span class="kw">or</span> val <span class="op">==</span> <span class="st">''</span>:</span>
<span id="cb49-990"><a href="#cb49-990" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">str</span>(val)</span>
<span id="cb49-991"><a href="#cb49-991" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-992"><a href="#cb49-992" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> re</span>
<span id="cb49-993"><a href="#cb49-993" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-994"><a href="#cb49-994" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use regex to find all key: value patterns</span></span>
<span id="cb49-995"><a href="#cb49-995" aria-hidden="true" tabindex="-1"></a>    pattern <span class="op">=</span> <span class="vs">r'(\w+\d*): ([\d.-]+)'</span></span>
<span id="cb49-996"><a href="#cb49-996" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-997"><a href="#cb49-997" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> replace_positive_values(match):</span>
<span id="cb49-998"><a href="#cb49-998" aria-hidden="true" tabindex="-1"></a>        key <span class="op">=</span> match.group(<span class="dv">1</span>)</span>
<span id="cb49-999"><a href="#cb49-999" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> match.group(<span class="dv">2</span>)</span>
<span id="cb49-1000"><a href="#cb49-1000" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb49-1001"><a href="#cb49-1001" aria-hidden="true" tabindex="-1"></a>            num_val <span class="op">=</span> <span class="bu">float</span>(value)</span>
<span id="cb49-1002"><a href="#cb49-1002" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> num_val <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb49-1003"><a href="#cb49-1003" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="ss">f'</span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">: &lt;span style="color: red; font-weight: bold;"&gt;</span><span class="sc">{</span>value<span class="sc">}</span><span class="ss">&lt;/span&gt;'</span></span>
<span id="cb49-1004"><a href="#cb49-1004" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb49-1005"><a href="#cb49-1005" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="ss">f'</span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb49-1006"><a href="#cb49-1006" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> (<span class="pp">ValueError</span>, <span class="pp">TypeError</span>):</span>
<span id="cb49-1007"><a href="#cb49-1007" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="ss">f'</span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb49-1008"><a href="#cb49-1008" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-1009"><a href="#cb49-1009" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Replace all matches with formatted versions</span></span>
<span id="cb49-1010"><a href="#cb49-1010" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> re.sub(pattern, replace_positive_values, <span class="bu">str</span>(val))</span>
<span id="cb49-1011"><a href="#cb49-1011" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb49-1012"><a href="#cb49-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1013"><a href="#cb49-1013" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply formatting to the last column</span></span>
<span id="cb49-1014"><a href="#cb49-1014" aria-hidden="true" tabindex="-1"></a>results_tbl[last_col] <span class="op">=</span> results_tbl[last_col].<span class="bu">apply</span>(format_last_column)</span>
<span id="cb49-1015"><a href="#cb49-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1016"><a href="#cb49-1016" aria-hidden="true" tabindex="-1"></a>html_table <span class="op">=</span> results_tbl.to_html(escape<span class="op">=</span><span class="va">False</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb49-1017"><a href="#cb49-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1018"><a href="#cb49-1018" aria-hidden="true" tabindex="-1"></a><span class="co"># Add container div with fixed height and scrolling</span></span>
<span id="cb49-1019"><a href="#cb49-1019" aria-hidden="true" tabindex="-1"></a>html_table <span class="op">=</span> <span class="ss">f'''</span></span>
<span id="cb49-1020"><a href="#cb49-1020" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;div style="height: 600px; overflow-y: auto; border: 1px solid #ddd;"&gt;</span></span>
<span id="cb49-1021"><a href="#cb49-1021" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span>html_table<span class="sc">}</span></span>
<span id="cb49-1022"><a href="#cb49-1022" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/div&gt;</span></span>
<span id="cb49-1023"><a href="#cb49-1023" aria-hidden="true" tabindex="-1"></a><span class="ss">'''</span></span>
<span id="cb49-1024"><a href="#cb49-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1025"><a href="#cb49-1025" aria-hidden="true" tabindex="-1"></a><span class="co"># Style the table with sticky header</span></span>
<span id="cb49-1026"><a href="#cb49-1026" aria-hidden="true" tabindex="-1"></a>html_table <span class="op">=</span> html_table.replace(<span class="st">'&lt;table'</span>, </span>
<span id="cb49-1027"><a href="#cb49-1027" aria-hidden="true" tabindex="-1"></a>    <span class="st">'&lt;table style="width: 100%; table-layout: fixed; font-size: 11px; font-family: monospace; border-collapse: collapse;"'</span>)</span>
<span id="cb49-1028"><a href="#cb49-1028" aria-hidden="true" tabindex="-1"></a>html_table <span class="op">=</span> html_table.replace(<span class="st">'&lt;th'</span>, </span>
<span id="cb49-1029"><a href="#cb49-1029" aria-hidden="true" tabindex="-1"></a>    <span class="st">'&lt;th style="position: sticky; top: 0; background-color: #f5f5f5; border: 1px solid #ddd; padding: 8px; z-index: 10;"'</span>)</span>
<span id="cb49-1030"><a href="#cb49-1030" aria-hidden="true" tabindex="-1"></a>html_table <span class="op">=</span> html_table.replace(<span class="st">'&lt;td'</span>, </span>
<span id="cb49-1031"><a href="#cb49-1031" aria-hidden="true" tabindex="-1"></a>    <span class="st">'&lt;td style="min-width: 250px; word-wrap: break-word; padding: 4px; border: 1px solid #eee;"'</span>)</span>
<span id="cb49-1032"><a href="#cb49-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1033"><a href="#cb49-1033" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(html_table)</span>
<span id="cb49-1034"><a href="#cb49-1034" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1035"><a href="#cb49-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1036"><a href="#cb49-1036" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-1037"><a href="#cb49-1037" aria-hidden="true" tabindex="-1"></a>In the <span class="in">`0_2024_baseline`</span> scenario above, Gas Generation (GWh) is much lower than in reality because I've set the marginal cost of gas higher than coal and there are no other influencing constraints such as carbon emissions. PyPSA is solving based on least-cost optimisation of power plant and storage dispatch within network constraints. This is much simpler than in real life, which involves a bid stack and many more constraints.  </span>
<span id="cb49-1038"><a href="#cb49-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1039"><a href="#cb49-1039" aria-hidden="true" tabindex="-1"></a>It is worth adding a comparison column to compare more realistic gas generation from <span class="co">[</span><span class="ot">Open Electricity</span><span class="co">](https://explore.openelectricity.org.au/energy/nem/?range=1y&amp;interval=1w&amp;view=discrete-time&amp;group=Simplified)</span> to the high VRE scenario that I'm interested in: <span class="in">`8.2.1_6xVreCurtailReview`</span> . This scenario has zero coal generation and an 83% reduction in gas generation.</span>
<span id="cb49-1040"><a href="#cb49-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1041"><a href="#cb49-1041" aria-hidden="true" tabindex="-1"></a>The <span class="in">`8.2.1_6xVreCurtailReview`</span> is one of the more plausible scenarios found by scaling up VRE and storage from the baseline model using a csv import file with different scale-up factors.</span>
<span id="cb49-1042"><a href="#cb49-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1043"><a href="#cb49-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1046"><a href="#cb49-1046" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-1047"><a href="#cb49-1047" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: asis</span></span>
<span id="cb49-1048"><a href="#cb49-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1049"><a href="#cb49-1049" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Filter scenario</span></span>
<span id="cb49-1050"><a href="#cb49-1050" aria-hidden="true" tabindex="-1"></a>df_filt <span class="op">=</span> results_tbl[results_tbl[<span class="st">"Scenario"</span>] <span class="op">==</span> <span class="st">"8.2.1_6xVreCurtailReview"</span>].copy()</span>
<span id="cb49-1051"><a href="#cb49-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1052"><a href="#cb49-1052" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Compute the % change vs 10,919 GWh. Source: Open Electricity Data (this value will change regularly because it is a rolling 12-month period)</span></span>
<span id="cb49-1053"><a href="#cb49-1053" aria-hidden="true" tabindex="-1"></a>base <span class="op">=</span> <span class="dv">10919</span></span>
<span id="cb49-1054"><a href="#cb49-1054" aria-hidden="true" tabindex="-1"></a>df_filt[<span class="st">"Gas Δ% vs 10919GWh"</span>] <span class="op">=</span> (df_filt[<span class="st">"Gas Generation (GWh)"</span>] <span class="op">-</span> base) <span class="op">/</span> base <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb49-1055"><a href="#cb49-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1056"><a href="#cb49-1056" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Insert the new column right after “Gas Generation (GWh)”</span></span>
<span id="cb49-1057"><a href="#cb49-1057" aria-hidden="true" tabindex="-1"></a>col_idx <span class="op">=</span> df_filt.columns.get_loc(<span class="st">"Gas Generation (GWh)"</span>)</span>
<span id="cb49-1058"><a href="#cb49-1058" aria-hidden="true" tabindex="-1"></a>df_filt.insert(col_idx<span class="op">+</span><span class="dv">1</span>, <span class="st">"Gas Δ% vs 10919GWh"</span>, df_filt.pop(<span class="st">"Gas Δ% vs 10919GWh"</span>))</span>
<span id="cb49-1059"><a href="#cb49-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1060"><a href="#cb49-1060" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect</span></span>
<span id="cb49-1061"><a href="#cb49-1061" aria-hidden="true" tabindex="-1"></a>html_subset_table <span class="op">=</span> df_filt.iloc[:, :<span class="dv">5</span>].to_html(escape<span class="op">=</span><span class="va">False</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb49-1062"><a href="#cb49-1062" aria-hidden="true" tabindex="-1"></a>html_subset_table <span class="op">=</span> html_subset_table.replace(<span class="st">'&lt;table'</span>, </span>
<span id="cb49-1063"><a href="#cb49-1063" aria-hidden="true" tabindex="-1"></a>    <span class="st">'&lt;table style="width: 100%; table-layout: fixed; font-size: 11px; font-family: monospace;"'</span>)</span>
<span id="cb49-1064"><a href="#cb49-1064" aria-hidden="true" tabindex="-1"></a>html_subset_table <span class="op">=</span> html_subset_table.replace(<span class="st">'&lt;td'</span>, </span>
<span id="cb49-1065"><a href="#cb49-1065" aria-hidden="true" tabindex="-1"></a>    <span class="st">'&lt;td style="min-width: 250px; word-wrap: break-word; padding: 4px;"'</span>)</span>
<span id="cb49-1066"><a href="#cb49-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1067"><a href="#cb49-1067" aria-hidden="true" tabindex="-1"></a>html_subset_table</span>
<span id="cb49-1068"><a href="#cb49-1068" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1069"><a href="#cb49-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1070"><a href="#cb49-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1071"><a href="#cb49-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1072"><a href="#cb49-1072" aria-hidden="true" tabindex="-1"></a>Load the <span class="in">`8.2.1_6xVreCurtailReview`</span> network.</span>
<span id="cb49-1073"><a href="#cb49-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1076"><a href="#cb49-1076" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-1077"><a href="#cb49-1077" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the network for the specific scenario</span></span>
<span id="cb49-1078"><a href="#cb49-1078" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> pypsa.Network(<span class="st">"results/scenarios/scenario_8.2.1_6xVreCurtailReview.nc"</span>)</span>
<span id="cb49-1079"><a href="#cb49-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1080"><a href="#cb49-1080" aria-hidden="true" tabindex="-1"></a><span class="co"># Metadata to provide as arguments to the plot_dispatch() function.</span></span>
<span id="cb49-1081"><a href="#cb49-1081" aria-hidden="true" tabindex="-1"></a>scenario <span class="op">=</span> <span class="st">"8.2.1_6xVreCurtailReview"</span></span>
<span id="cb49-1082"><a href="#cb49-1082" aria-hidden="true" tabindex="-1"></a>objective_text <span class="op">=</span> df_results.loc[df_results[<span class="st">"Scenario"</span>] <span class="op">==</span> scenario, <span class="st">"Objective"</span>].values[<span class="dv">0</span>]</span>
<span id="cb49-1083"><a href="#cb49-1083" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1084"><a href="#cb49-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1085"><a href="#cb49-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1086"><a href="#cb49-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1089"><a href="#cb49-1089" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-1090"><a href="#cb49-1090" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb49-1091"><a href="#cb49-1091" aria-hidden="true" tabindex="-1"></a>plot_dispatch(n, time<span class="op">=</span><span class="st">"2024-05-18"</span>, days<span class="op">=</span><span class="dv">10</span>, regions<span class="op">=</span>[<span class="st">"VIC1"</span>], show_imports<span class="op">=</span><span class="va">True</span>, scenario_name<span class="op">=</span>scenario, scenario_objective<span class="op">=</span>objective_text, interactive<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb49-1092"><a href="#cb49-1092" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1093"><a href="#cb49-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1094"><a href="#cb49-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1095"><a href="#cb49-1095" aria-hidden="true" tabindex="-1"></a>In the above snapshot there is minimal gas dispatch due to high levels of renewable energy. The trade-off is curtailment, the middle of the day on the 19th of May is a good example, where almost all solar is curtailed.</span>
<span id="cb49-1096"><a href="#cb49-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1099"><a href="#cb49-1099" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-1100"><a href="#cb49-1100" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb49-1101"><a href="#cb49-1101" aria-hidden="true" tabindex="-1"></a>plot_dispatch(n, time<span class="op">=</span><span class="st">"2024-09-20"</span>, days<span class="op">=</span><span class="dv">10</span>, regions<span class="op">=</span>[<span class="st">"SA1"</span>], show_imports<span class="op">=</span><span class="va">True</span>, scenario_name<span class="op">=</span>scenario, scenario_objective<span class="op">=</span>objective_text, interactive<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb49-1102"><a href="#cb49-1102" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1103"><a href="#cb49-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1104"><a href="#cb49-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1105"><a href="#cb49-1105" aria-hidden="true" tabindex="-1"></a>As anticipated, curtailment increases dramatically during the shoulder season, as shown above for South Australia.</span>
<span id="cb49-1106"><a href="#cb49-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1109"><a href="#cb49-1109" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-1110"><a href="#cb49-1110" aria-hidden="true" tabindex="-1"></a>plot_generator_capacity_by_carrier(n)</span>
<span id="cb49-1111"><a href="#cb49-1111" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1112"><a href="#cb49-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1113"><a href="#cb49-1113" aria-hidden="true" tabindex="-1"></a>In this scenario, the wind generation capacity closely matches the 2049-50 ISP Step Change forecast, while solar capacity is lower as a result of my efforts to minimize curtailment.</span>
<span id="cb49-1114"><a href="#cb49-1114" aria-hidden="true" tabindex="-1"></a>Coal has been reduced to zero and there is only a small amount of Gas. There are no changes to diesel.</span>
<span id="cb49-1115"><a href="#cb49-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1116"><a href="#cb49-1116" aria-hidden="true" tabindex="-1"></a>&lt;div style="text-align: center;"&gt;</span>
<span id="cb49-1117"><a href="#cb49-1117" aria-hidden="true" tabindex="-1"></a><span class="al">![ISP Step Change Onshore wind ~69GW)](images/isp-nem-capacity-forecast.png)</span></span>
<span id="cb49-1118"><a href="#cb49-1118" aria-hidden="true" tabindex="-1"></a>&lt;/div&gt;</span>
<span id="cb49-1119"><a href="#cb49-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1120"><a href="#cb49-1120" aria-hidden="true" tabindex="-1"></a>Assessing peak demand alongside installed generation capacity for each region in the <span class="in">`8.2.1_6xVreCurtailReview`</span> network clearly illustrates the substantial overbuilding of renewable energy relative to demand.</span>
<span id="cb49-1121"><a href="#cb49-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1124"><a href="#cb49-1124" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-1125"><a href="#cb49-1125" aria-hidden="true" tabindex="-1"></a>plot_peak_demand_vs_capacity(n, stack_carrier<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb49-1126"><a href="#cb49-1126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1127"><a href="#cb49-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1128"><a href="#cb49-1128" aria-hidden="true" tabindex="-1"></a>Total generation per region also highlights the over-generation required compared to baseline.</span>
<span id="cb49-1129"><a href="#cb49-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1132"><a href="#cb49-1132" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-1133"><a href="#cb49-1133" aria-hidden="true" tabindex="-1"></a>plot_total_demand_vs_generation(n, stack_carrier<span class="op">=</span><span class="va">True</span>, relative<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb49-1134"><a href="#cb49-1134" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1135"><a href="#cb49-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1138"><a href="#cb49-1138" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-1139"><a href="#cb49-1139" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: bus and region are synonymous in this context.</span></span>
<span id="cb49-1140"><a href="#cb49-1140" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> curtailment_region_carrier(n, carriers<span class="op">=</span>[<span class="st">'Rooftop Solar'</span>, <span class="st">'Solar'</span>, <span class="st">'Wind'</span>]):</span>
<span id="cb49-1141"><a href="#cb49-1141" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb49-1142"><a href="#cb49-1142" aria-hidden="true" tabindex="-1"></a><span class="co">    Calculate curtailment % by bus and carrier (excluding Hydro) and pivot carriers wide.</span></span>
<span id="cb49-1143"><a href="#cb49-1143" aria-hidden="true" tabindex="-1"></a><span class="co">    Adds one monthly curtailed TWh string column per carrier named</span></span>
<span id="cb49-1144"><a href="#cb49-1144" aria-hidden="true" tabindex="-1"></a><span class="co">    'monthly_curtailment_&lt;carrier&gt;_twh_str'.</span></span>
<span id="cb49-1145"><a href="#cb49-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1146"><a href="#cb49-1146" aria-hidden="true" tabindex="-1"></a><span class="co">    Fixed so that 'month' in the intermediate DataFrame is a Timestamp,</span></span>
<span id="cb49-1147"><a href="#cb49-1147" aria-hidden="true" tabindex="-1"></a><span class="co">    which lets us do .to_period('M') later without error.</span></span>
<span id="cb49-1148"><a href="#cb49-1148" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb49-1149"><a href="#cb49-1149" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-1150"><a href="#cb49-1150" aria-hidden="true" tabindex="-1"></a>    records <span class="op">=</span> []</span>
<span id="cb49-1151"><a href="#cb49-1151" aria-hidden="true" tabindex="-1"></a>    monthly_data <span class="op">=</span> {carrier: [] <span class="cf">for</span> carrier <span class="kw">in</span> carriers}</span>
<span id="cb49-1152"><a href="#cb49-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1153"><a href="#cb49-1153" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create a PeriodIndex of each snapshot’s month</span></span>
<span id="cb49-1154"><a href="#cb49-1154" aria-hidden="true" tabindex="-1"></a>    snapshot_month <span class="op">=</span> n.snapshots.to_series().dt.to_period(<span class="st">'M'</span>)</span>
<span id="cb49-1155"><a href="#cb49-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1156"><a href="#cb49-1156" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> carrier <span class="kw">in</span> carriers:</span>
<span id="cb49-1157"><a href="#cb49-1157" aria-hidden="true" tabindex="-1"></a>        mask <span class="op">=</span> n.generators.carrier <span class="op">==</span> carrier</span>
<span id="cb49-1158"><a href="#cb49-1158" aria-hidden="true" tabindex="-1"></a>        gens <span class="op">=</span> n.generators[mask]</span>
<span id="cb49-1159"><a href="#cb49-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1160"><a href="#cb49-1160" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> bus, gens_in_bus <span class="kw">in</span> gens.groupby(<span class="st">'bus'</span>):</span>
<span id="cb49-1161"><a href="#cb49-1161" aria-hidden="true" tabindex="-1"></a>            idx <span class="op">=</span> gens_in_bus.index.intersection(n.generators_t.p_max_pu.columns)</span>
<span id="cb49-1162"><a href="#cb49-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1163"><a href="#cb49-1163" aria-hidden="true" tabindex="-1"></a>            <span class="co"># overall curtailment % per bus/carrier</span></span>
<span id="cb49-1164"><a href="#cb49-1164" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(idx) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb49-1165"><a href="#cb49-1165" aria-hidden="true" tabindex="-1"></a>                pct <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb49-1166"><a href="#cb49-1166" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb49-1167"><a href="#cb49-1167" aria-hidden="true" tabindex="-1"></a>                pot <span class="op">=</span> (n.generators_t.p_max_pu[idx]</span>
<span id="cb49-1168"><a href="#cb49-1168" aria-hidden="true" tabindex="-1"></a>                       .multiply(n.generators.loc[idx, <span class="st">'p_nom'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb49-1169"><a href="#cb49-1169" aria-hidden="true" tabindex="-1"></a>                      ).<span class="bu">sum</span>().<span class="bu">sum</span>()</span>
<span id="cb49-1170"><a href="#cb49-1170" aria-hidden="true" tabindex="-1"></a>                act <span class="op">=</span> n.generators_t.p[idx].<span class="bu">sum</span>().<span class="bu">sum</span>()</span>
<span id="cb49-1171"><a href="#cb49-1171" aria-hidden="true" tabindex="-1"></a>                curtailed <span class="op">=</span> pot <span class="op">-</span> act</span>
<span id="cb49-1172"><a href="#cb49-1172" aria-hidden="true" tabindex="-1"></a>                pct <span class="op">=</span> <span class="dv">100</span> <span class="op">*</span> curtailed <span class="op">/</span> pot <span class="cf">if</span> pot <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="fl">0.0</span></span>
<span id="cb49-1173"><a href="#cb49-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1174"><a href="#cb49-1174" aria-hidden="true" tabindex="-1"></a>            records.append({<span class="st">'bus'</span>: bus, <span class="st">'carrier'</span>: carrier, <span class="st">'curtailment_pct'</span>: <span class="bu">round</span>(pct, <span class="dv">3</span>)})</span>
<span id="cb49-1175"><a href="#cb49-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1176"><a href="#cb49-1176" aria-hidden="true" tabindex="-1"></a>            <span class="co"># monthly curtailed MWh per bus/carrier</span></span>
<span id="cb49-1177"><a href="#cb49-1177" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(idx) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb49-1178"><a href="#cb49-1178" aria-hidden="true" tabindex="-1"></a>                pot_m <span class="op">=</span> (n.generators_t.p_max_pu[idx]</span>
<span id="cb49-1179"><a href="#cb49-1179" aria-hidden="true" tabindex="-1"></a>                         .multiply(n.generators.loc[idx, <span class="st">'p_nom'</span>], axis<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb49-1180"><a href="#cb49-1180" aria-hidden="true" tabindex="-1"></a>                act_m <span class="op">=</span> n.generators_t.p[idx]</span>
<span id="cb49-1181"><a href="#cb49-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1182"><a href="#cb49-1182" aria-hidden="true" tabindex="-1"></a>                pot_mon <span class="op">=</span> pot_m.groupby(snapshot_month).<span class="bu">sum</span>().<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb49-1183"><a href="#cb49-1183" aria-hidden="true" tabindex="-1"></a>                act_mon <span class="op">=</span> act_m.groupby(snapshot_month).<span class="bu">sum</span>().<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb49-1184"><a href="#cb49-1184" aria-hidden="true" tabindex="-1"></a>                curtailed_mon <span class="op">=</span> pot_mon <span class="op">-</span> act_mon</span>
<span id="cb49-1185"><a href="#cb49-1185" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb49-1186"><a href="#cb49-1186" aria-hidden="true" tabindex="-1"></a>                <span class="co"># build a zero‐series indexed by each unique period</span></span>
<span id="cb49-1187"><a href="#cb49-1187" aria-hidden="true" tabindex="-1"></a>                curtailed_mon <span class="op">=</span> pd.Series(<span class="fl">0.0</span>, index<span class="op">=</span>snapshot_month.unique())</span>
<span id="cb49-1188"><a href="#cb49-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1189"><a href="#cb49-1189" aria-hidden="true" tabindex="-1"></a>            <span class="co"># *** store month as a Timestamp, not Period ***</span></span>
<span id="cb49-1190"><a href="#cb49-1190" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> period, val <span class="kw">in</span> curtailed_mon.items():</span>
<span id="cb49-1191"><a href="#cb49-1191" aria-hidden="true" tabindex="-1"></a>                monthly_data[carrier].append({</span>
<span id="cb49-1192"><a href="#cb49-1192" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'month'</span>: period.to_timestamp(),  <span class="co"># &lt;- convert here</span></span>
<span id="cb49-1193"><a href="#cb49-1193" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'bus'</span>: bus,</span>
<span id="cb49-1194"><a href="#cb49-1194" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'curtailed_mwh'</span>: val</span>
<span id="cb49-1195"><a href="#cb49-1195" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb49-1196"><a href="#cb49-1196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1197"><a href="#cb49-1197" aria-hidden="true" tabindex="-1"></a>    <span class="co"># build the bus × carrier % pivot</span></span>
<span id="cb49-1198"><a href="#cb49-1198" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame(records)</span>
<span id="cb49-1199"><a href="#cb49-1199" aria-hidden="true" tabindex="-1"></a>    pivot_df <span class="op">=</span> df.pivot(index<span class="op">=</span><span class="st">'bus'</span>, columns<span class="op">=</span><span class="st">'carrier'</span>, values<span class="op">=</span><span class="st">'curtailment_pct'</span>).fillna(<span class="fl">0.0</span>)</span>
<span id="cb49-1200"><a href="#cb49-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1201"><a href="#cb49-1201" aria-hidden="true" tabindex="-1"></a>    <span class="co"># for each carrier, build its monthly TWh‐string column</span></span>
<span id="cb49-1202"><a href="#cb49-1202" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> carrier <span class="kw">in</span> carriers:</span>
<span id="cb49-1203"><a href="#cb49-1203" aria-hidden="true" tabindex="-1"></a>        mon_df <span class="op">=</span> pd.DataFrame(monthly_data[carrier])</span>
<span id="cb49-1204"><a href="#cb49-1204" aria-hidden="true" tabindex="-1"></a>        summed <span class="op">=</span> (mon_df.groupby([<span class="st">'bus'</span>, <span class="st">'month'</span>])[<span class="st">'curtailed_mwh'</span>]</span>
<span id="cb49-1205"><a href="#cb49-1205" aria-hidden="true" tabindex="-1"></a>                     .<span class="bu">sum</span>()</span>
<span id="cb49-1206"><a href="#cb49-1206" aria-hidden="true" tabindex="-1"></a>                     .reset_index())</span>
<span id="cb49-1207"><a href="#cb49-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1208"><a href="#cb49-1208" aria-hidden="true" tabindex="-1"></a>        <span class="co"># now month is Timestamp, so this works:</span></span>
<span id="cb49-1209"><a href="#cb49-1209" aria-hidden="true" tabindex="-1"></a>        start <span class="op">=</span> summed[<span class="st">'month'</span>].<span class="bu">min</span>().to_period(<span class="st">'M'</span>)</span>
<span id="cb49-1210"><a href="#cb49-1210" aria-hidden="true" tabindex="-1"></a>        end   <span class="op">=</span> summed[<span class="st">'month'</span>].<span class="bu">max</span>().to_period(<span class="st">'M'</span>)</span>
<span id="cb49-1211"><a href="#cb49-1211" aria-hidden="true" tabindex="-1"></a>        months_sorted <span class="op">=</span> pd.period_range(start, end, freq<span class="op">=</span><span class="st">'M'</span>).to_timestamp()</span>
<span id="cb49-1212"><a href="#cb49-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1213"><a href="#cb49-1213" aria-hidden="true" tabindex="-1"></a>        ser <span class="op">=</span> {}</span>
<span id="cb49-1214"><a href="#cb49-1214" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> bus <span class="kw">in</span> pivot_df.index:</span>
<span id="cb49-1215"><a href="#cb49-1215" aria-hidden="true" tabindex="-1"></a>            subset <span class="op">=</span> summed[summed[<span class="st">'bus'</span>] <span class="op">==</span> bus].set_index(<span class="st">'month'</span>)[<span class="st">'curtailed_mwh'</span>].to_dict()</span>
<span id="cb49-1216"><a href="#cb49-1216" aria-hidden="true" tabindex="-1"></a>            arr <span class="op">=</span> np.array([<span class="bu">round</span>(subset.get(m, <span class="fl">0.0</span>), <span class="dv">3</span>) <span class="cf">for</span> m <span class="kw">in</span> months_sorted])</span>
<span id="cb49-1217"><a href="#cb49-1217" aria-hidden="true" tabindex="-1"></a>            twh <span class="op">=</span> arr <span class="op">/</span> <span class="fl">1e6</span> <span class="co"># convert MWh to TWh</span></span>
<span id="cb49-1218"><a href="#cb49-1218" aria-hidden="true" tabindex="-1"></a>            ser[bus] <span class="op">=</span> <span class="st">' '</span>.join(<span class="ss">f'</span><span class="sc">{</span>x<span class="sc">:.3f}</span><span class="ss">'</span> <span class="cf">for</span> x <span class="kw">in</span> twh)</span>
<span id="cb49-1219"><a href="#cb49-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1220"><a href="#cb49-1220" aria-hidden="true" tabindex="-1"></a>        col <span class="op">=</span> <span class="ss">f'monthly_curtailment_</span><span class="sc">{</span>carrier<span class="sc">.</span>lower()<span class="sc">.</span>replace(<span class="st">" "</span>, <span class="st">"_"</span>)<span class="sc">}</span><span class="ss">_twh_str'</span></span>
<span id="cb49-1221"><a href="#cb49-1221" aria-hidden="true" tabindex="-1"></a>        pivot_df[col] <span class="op">=</span> pivot_df.index.<span class="bu">map</span>(ser)</span>
<span id="cb49-1222"><a href="#cb49-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1223"><a href="#cb49-1223" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pivot_df</span>
<span id="cb49-1224"><a href="#cb49-1224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1225"><a href="#cb49-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1226"><a href="#cb49-1226" aria-hidden="true" tabindex="-1"></a>Leverage the <span class="co">[</span><span class="ot">great_tables</span><span class="co">](https://posit-dev.github.io/great-tables/articles/intro.html)</span> python library to highlight curtailment data returned in the <span class="in">`curtailment_region_carrier`</span> function above.</span>
<span id="cb49-1227"><a href="#cb49-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1230"><a href="#cb49-1230" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-1231"><a href="#cb49-1231" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb49-1232"><a href="#cb49-1232" aria-hidden="true" tabindex="-1"></a>pivot_df <span class="op">=</span> curtailment_region_carrier(n)</span>
<span id="cb49-1233"><a href="#cb49-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1234"><a href="#cb49-1234" aria-hidden="true" tabindex="-1"></a><span class="co"># from great_tables import GT, md, system_fonts, nanoplot_options</span></span>
<span id="cb49-1235"><a href="#cb49-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1236"><a href="#cb49-1236" aria-hidden="true" tabindex="-1"></a>curtailment_tbl <span class="op">=</span> GT(data<span class="op">=</span>pivot_df <span class="op">\</span></span>
<span id="cb49-1237"><a href="#cb49-1237" aria-hidden="true" tabindex="-1"></a>    .reset_index() <span class="op">\</span></span>
<span id="cb49-1238"><a href="#cb49-1238" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">round</span>(<span class="dv">2</span>) <span class="op">\</span></span>
<span id="cb49-1239"><a href="#cb49-1239" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">'bus'</span>: <span class="st">'Region'</span>,</span>
<span id="cb49-1240"><a href="#cb49-1240" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'Solar'</span>: <span class="st">'Utility Solar'</span>,   </span>
<span id="cb49-1241"><a href="#cb49-1241" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'monthly_curtailment_rooftop_solar_twh_str'</span>: <span class="st">'Rooftop Solar Curtailment'</span>,</span>
<span id="cb49-1242"><a href="#cb49-1242" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'monthly_curtailment_solar_twh_str'</span>: <span class="st">'Utility Solar Curtailment'</span>,</span>
<span id="cb49-1243"><a href="#cb49-1243" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'monthly_curtailment_wind_twh_str'</span>: <span class="st">'Wind Curtailment'</span></span>
<span id="cb49-1244"><a href="#cb49-1244" aria-hidden="true" tabindex="-1"></a>                     })</span>
<span id="cb49-1245"><a href="#cb49-1245" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-1246"><a href="#cb49-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1247"><a href="#cb49-1247" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate great table for curtailment by region and carrier</span></span>
<span id="cb49-1248"><a href="#cb49-1248" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: Scale-up objective is hardcoded in the source note.</span></span>
<span id="cb49-1249"><a href="#cb49-1249" aria-hidden="true" tabindex="-1"></a><span class="co"># objective_text.replace('\n', ', ') </span></span>
<span id="cb49-1250"><a href="#cb49-1250" aria-hidden="true" tabindex="-1"></a>curtailment_gt <span class="op">=</span> curtailment_tbl.tab_header(</span>
<span id="cb49-1251"><a href="#cb49-1251" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">"NEM Variable Renewable Energy Curtailment by Region"</span></span>
<span id="cb49-1252"><a href="#cb49-1252" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb49-1253"><a href="#cb49-1253" aria-hidden="true" tabindex="-1"></a>        .tab_spanner(</span>
<span id="cb49-1254"><a href="#cb49-1254" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">"Curtailment (%)"</span>,</span>
<span id="cb49-1255"><a href="#cb49-1255" aria-hidden="true" tabindex="-1"></a>        columns<span class="op">=</span>[<span class="st">'Rooftop Solar'</span>, <span class="st">'Utility Solar'</span>, <span class="st">'Wind'</span>]</span>
<span id="cb49-1256"><a href="#cb49-1256" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb49-1257"><a href="#cb49-1257" aria-hidden="true" tabindex="-1"></a>        .tab_spanner(</span>
<span id="cb49-1258"><a href="#cb49-1258" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">"Monthly Curtailment Profiles (TWh)"</span>,</span>
<span id="cb49-1259"><a href="#cb49-1259" aria-hidden="true" tabindex="-1"></a>            columns<span class="op">=</span>[<span class="st">'Rooftop Solar Curtailment'</span>,</span>
<span id="cb49-1260"><a href="#cb49-1260" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'Utility Solar Curtailment'</span>,</span>
<span id="cb49-1261"><a href="#cb49-1261" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'Wind Curtailment'</span>]</span>
<span id="cb49-1262"><a href="#cb49-1262" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb49-1263"><a href="#cb49-1263" aria-hidden="true" tabindex="-1"></a>        .data_color(</span>
<span id="cb49-1264"><a href="#cb49-1264" aria-hidden="true" tabindex="-1"></a>        columns<span class="op">=</span>[<span class="st">'Rooftop Solar'</span>, <span class="st">'Utility Solar'</span>, <span class="st">'Wind'</span>],</span>
<span id="cb49-1265"><a href="#cb49-1265" aria-hidden="true" tabindex="-1"></a>        palette<span class="op">=</span>[</span>
<span id="cb49-1266"><a href="#cb49-1266" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#31a354"</span>, <span class="st">"#78c679"</span>, <span class="st">"#ffffcc"</span>,</span>
<span id="cb49-1267"><a href="#cb49-1267" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#fafa8c"</span>, <span class="st">"#f4cd1e"</span>, <span class="st">"#f8910b"</span>],</span>
<span id="cb49-1268"><a href="#cb49-1268" aria-hidden="true" tabindex="-1"></a>        domain<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">100</span>]</span>
<span id="cb49-1269"><a href="#cb49-1269" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb49-1270"><a href="#cb49-1270" aria-hidden="true" tabindex="-1"></a>        .cols_width(</span>
<span id="cb49-1271"><a href="#cb49-1271" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Wind'</span>: <span class="st">'120px'</span>, <span class="st">'Utility Solar'</span>: <span class="st">'120px'</span>, <span class="st">'Rooftop Solar'</span>: <span class="st">'120px'</span>}</span>
<span id="cb49-1272"><a href="#cb49-1272" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb49-1273"><a href="#cb49-1273" aria-hidden="true" tabindex="-1"></a>        .cols_align(    </span>
<span id="cb49-1274"><a href="#cb49-1274" aria-hidden="true" tabindex="-1"></a>             align<span class="op">=</span><span class="st">'center'</span></span>
<span id="cb49-1275"><a href="#cb49-1275" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb49-1276"><a href="#cb49-1276" aria-hidden="true" tabindex="-1"></a>        .tab_source_note(</span>
<span id="cb49-1277"><a href="#cb49-1277" aria-hidden="true" tabindex="-1"></a>            source_note<span class="op">=</span>md(</span>
<span id="cb49-1278"><a href="#cb49-1278" aria-hidden="true" tabindex="-1"></a>                <span class="st">"**Calculation**: Curtailment = (Potential energy - Actual energy) / Potential energy * 100."</span></span>
<span id="cb49-1279"><a href="#cb49-1279" aria-hidden="true" tabindex="-1"></a>                                           </span>
<span id="cb49-1280"><a href="#cb49-1280" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb49-1281"><a href="#cb49-1281" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb49-1282"><a href="#cb49-1282" aria-hidden="true" tabindex="-1"></a>        .tab_source_note(</span>
<span id="cb49-1283"><a href="#cb49-1283" aria-hidden="true" tabindex="-1"></a>            source_note<span class="op">=</span>md(</span>
<span id="cb49-1284"><a href="#cb49-1284" aria-hidden="true" tabindex="-1"></a>                <span class="st">"**Note**: there are currently no listed utility scale solar in the TAS1 [Open Electricity Facilities](https://explore.openelectricity.org.au/facilities/tas1/?tech=solar_utility&amp;status=operating,committed)"</span></span>
<span id="cb49-1285"><a href="#cb49-1285" aria-hidden="true" tabindex="-1"></a>                                           </span>
<span id="cb49-1286"><a href="#cb49-1286" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb49-1287"><a href="#cb49-1287" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb49-1288"><a href="#cb49-1288" aria-hidden="true" tabindex="-1"></a>        .tab_source_note(</span>
<span id="cb49-1289"><a href="#cb49-1289" aria-hidden="true" tabindex="-1"></a>            source_note<span class="op">=</span>md(<span class="st">"**Scenario**: 8.2.1_6xVreCurtailReview (Zero coal &amp; 83</span><span class="sc">% r</span><span class="st">eduction in GPG).&lt;br&gt;&lt;br&gt; **Scale-up objective from 2024 baseline**: *NSW1-Black Coal: x0.0, NSW1-Gas: x0.5, NSW1-Rooftop Solar: x3.0, NSW1-Solar: x3.0, NSW1-Wind: x6.0, NSW1-Battery: x8.0, QLD1-Black Coal: x0.0, QLD1-Gas: x0.5, QLD1-Rooftop Solar: x3.0, QLD1-Solar: x3.0, QLD1-Wind: x6.0, QLD1-Battery: x6.0, SA1-Gas: x0.5, SA1-Rooftop Solar: x2.0, SA1-Solar: x3.0, SA1-Wind: x2.0, SA1-Battery: x6.0, TAS1-Gas: x0.5, TAS1-Rooftop Solar: x3.0, TAS1-Wind: x5.0, TAS1-Battery: x8.0, VIC1-Gas: x0.5, VIC1-Brown Coal: x0.0, VIC1-Rooftop Solar: x4.0, VIC1-Solar: x4.0, VIC1-Wind: x4.0, VIC1-Battery: x8.0*"</span>)</span>
<span id="cb49-1290"><a href="#cb49-1290" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb49-1291"><a href="#cb49-1291" aria-hidden="true" tabindex="-1"></a>        .fmt_nanoplot(<span class="st">"Rooftop Solar Curtailment"</span>,</span>
<span id="cb49-1292"><a href="#cb49-1292" aria-hidden="true" tabindex="-1"></a>                      plot_type<span class="op">=</span><span class="st">"bar"</span>,</span>
<span id="cb49-1293"><a href="#cb49-1293" aria-hidden="true" tabindex="-1"></a>                      options<span class="op">=</span>nanoplot_options(</span>
<span id="cb49-1294"><a href="#cb49-1294" aria-hidden="true" tabindex="-1"></a>                          data_bar_fill_color<span class="op">=</span><span class="st">"#FFE066"</span>,</span>
<span id="cb49-1295"><a href="#cb49-1295" aria-hidden="true" tabindex="-1"></a>                          y_ref_line_fmt_fn<span class="op">=</span><span class="st">"GWh"</span>,</span>
<span id="cb49-1296"><a href="#cb49-1296" aria-hidden="true" tabindex="-1"></a>                          )</span>
<span id="cb49-1297"><a href="#cb49-1297" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb49-1298"><a href="#cb49-1298" aria-hidden="true" tabindex="-1"></a>        .fmt_nanoplot(<span class="st">"Utility Solar Curtailment"</span>,</span>
<span id="cb49-1299"><a href="#cb49-1299" aria-hidden="true" tabindex="-1"></a>                      plot_type<span class="op">=</span><span class="st">"bar"</span>,</span>
<span id="cb49-1300"><a href="#cb49-1300" aria-hidden="true" tabindex="-1"></a>                      options<span class="op">=</span>nanoplot_options(</span>
<span id="cb49-1301"><a href="#cb49-1301" aria-hidden="true" tabindex="-1"></a>                          data_bar_fill_color<span class="op">=</span><span class="st">"#FDB324"</span>,</span>
<span id="cb49-1302"><a href="#cb49-1302" aria-hidden="true" tabindex="-1"></a>                          y_ref_line_fmt_fn<span class="op">=</span><span class="st">"GWh"</span>,</span>
<span id="cb49-1303"><a href="#cb49-1303" aria-hidden="true" tabindex="-1"></a>                          )</span>
<span id="cb49-1304"><a href="#cb49-1304" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb49-1305"><a href="#cb49-1305" aria-hidden="true" tabindex="-1"></a>        .fmt_nanoplot(<span class="st">"Wind Curtailment"</span>,</span>
<span id="cb49-1306"><a href="#cb49-1306" aria-hidden="true" tabindex="-1"></a>                      plot_type<span class="op">=</span><span class="st">"bar"</span>,</span>
<span id="cb49-1307"><a href="#cb49-1307" aria-hidden="true" tabindex="-1"></a>                      options<span class="op">=</span>nanoplot_options(</span>
<span id="cb49-1308"><a href="#cb49-1308" aria-hidden="true" tabindex="-1"></a>                          data_bar_fill_color<span class="op">=</span><span class="st">"#3BBFE5"</span>,</span>
<span id="cb49-1309"><a href="#cb49-1309" aria-hidden="true" tabindex="-1"></a>                          y_ref_line_fmt_fn<span class="op">=</span><span class="st">"GWh"</span>,</span>
<span id="cb49-1310"><a href="#cb49-1310" aria-hidden="true" tabindex="-1"></a>                          )</span>
<span id="cb49-1311"><a href="#cb49-1311" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb49-1312"><a href="#cb49-1312" aria-hidden="true" tabindex="-1"></a>        .tab_options(</span>
<span id="cb49-1313"><a href="#cb49-1313" aria-hidden="true" tabindex="-1"></a>            source_notes_font_size<span class="op">=</span><span class="st">'x-small'</span>,</span>
<span id="cb49-1314"><a href="#cb49-1314" aria-hidden="true" tabindex="-1"></a>            source_notes_padding<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb49-1315"><a href="#cb49-1315" aria-hidden="true" tabindex="-1"></a>            heading_subtitle_font_size<span class="op">=</span><span class="st">'small'</span>,</span>
<span id="cb49-1316"><a href="#cb49-1316" aria-hidden="true" tabindex="-1"></a>            table_font_names<span class="op">=</span>system_fonts(<span class="st">"humanist"</span>),</span>
<span id="cb49-1317"><a href="#cb49-1317" aria-hidden="true" tabindex="-1"></a>            data_row_padding<span class="op">=</span><span class="st">'1px'</span>,</span>
<span id="cb49-1318"><a href="#cb49-1318" aria-hidden="true" tabindex="-1"></a>            heading_background_color<span class="op">=</span><span class="st">'#F0FFFF'</span>,</span>
<span id="cb49-1319"><a href="#cb49-1319" aria-hidden="true" tabindex="-1"></a>            source_notes_background_color<span class="op">=</span><span class="st">'#F0FFF0'</span>,</span>
<span id="cb49-1320"><a href="#cb49-1320" aria-hidden="true" tabindex="-1"></a>            column_labels_background_color<span class="op">=</span><span class="st">'#F0FFF0'</span>,</span>
<span id="cb49-1321"><a href="#cb49-1321" aria-hidden="true" tabindex="-1"></a>            table_background_color<span class="op">=</span><span class="st">'snow'</span>,</span>
<span id="cb49-1322"><a href="#cb49-1322" aria-hidden="true" tabindex="-1"></a>            data_row_padding_horizontal<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb49-1323"><a href="#cb49-1323" aria-hidden="true" tabindex="-1"></a>            column_labels_padding_horizontal<span class="op">=</span><span class="dv">58</span></span>
<span id="cb49-1324"><a href="#cb49-1324" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb49-1325"><a href="#cb49-1325" aria-hidden="true" tabindex="-1"></a>            .opt_table_outline()</span>
<span id="cb49-1326"><a href="#cb49-1326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1327"><a href="#cb49-1327" aria-hidden="true" tabindex="-1"></a>curtailment_gt</span>
<span id="cb49-1328"><a href="#cb49-1328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1329"><a href="#cb49-1329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1330"><a href="#cb49-1330" aria-hidden="true" tabindex="-1"></a>The model applies relatively harsh curtailment to rooftop solar. This is a result of curtailment already being incorporated into utility-scale solar availability (capacity) factors, which I've sourced and then calculated from AEMO’s NEMWEB dispatch data. </span>
<span id="cb49-1331"><a href="#cb49-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1332"><a href="#cb49-1332" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Almost every large solar farm in Australia’s southeastern states will be forced to switch off at least one-third of the power they generate by 2027 as delays to critical energy transition projects cause major bottlenecks on the electricity grid. - Ryan Cropp, Australian Financial Review, Jul 10, 2025 [</span><span class="co">[</span><span class="ot">link</span><span class="co">]</span><span class="at">](https://www.afr.com/policy/energy-and-climate/solar-farms-forced-to-switch-off-due-to-energy-grid-logjam-20250710-p5mdw5). </span></span>
<span id="cb49-1333"><a href="#cb49-1333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1334"><a href="#cb49-1334" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Large-scale solar is fast and cost-effective to build, but it’s also the most exposed to curtailment, especially when system security limits or negative prices hit in the middle of a sunny day. - Chris O'Keefe, Clean Energy Council. </span></span>
<span id="cb49-1335"><a href="#cb49-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1336"><a href="#cb49-1336" aria-hidden="true" tabindex="-1"></a>The built-in curtailment would likely, at least partially explain why AEMO uses solar and wind traces, rather than solely relying on historical data, in its ISP modelling.</span>
<span id="cb49-1337"><a href="#cb49-1337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1338"><a href="#cb49-1338" aria-hidden="true" tabindex="-1"></a>Comparing rooftop solar with utility solar availability (capacity) factors in our network will help clarify this:</span>
<span id="cb49-1339"><a href="#cb49-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1340"><a href="#cb49-1340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1343"><a href="#cb49-1343" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-1344"><a href="#cb49-1344" aria-hidden="true" tabindex="-1"></a>solar_cf <span class="op">=</span> n.generators_t.p_max_pu[[<span class="st">'SA1-SOLAR'</span>, <span class="st">'SA1-ROOFTOP-SOLAR'</span>,</span>
<span id="cb49-1345"><a href="#cb49-1345" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'VIC1-SOLAR'</span>, <span class="st">'VIC1-ROOFTOP-SOLAR'</span>,</span>
<span id="cb49-1346"><a href="#cb49-1346" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'QLD1-SOLAR'</span>, <span class="st">'QLD1-ROOFTOP-SOLAR'</span>,</span>
<span id="cb49-1347"><a href="#cb49-1347" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'NSW1-SOLAR'</span>, <span class="st">'NSW1-ROOFTOP-SOLAR'</span>]].reset_index()</span>
<span id="cb49-1348"><a href="#cb49-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1349"><a href="#cb49-1349" aria-hidden="true" tabindex="-1"></a>solar_cf[<span class="st">'hour'</span>] <span class="op">=</span> solar_cf[<span class="st">'snapshot'</span>].dt.hour</span>
<span id="cb49-1350"><a href="#cb49-1350" aria-hidden="true" tabindex="-1"></a>hours <span class="op">=</span> <span class="bu">sorted</span>(solar_cf[<span class="st">'hour'</span>].unique())</span>
<span id="cb49-1351"><a href="#cb49-1351" aria-hidden="true" tabindex="-1"></a>even_hours <span class="op">=</span> [h <span class="cf">for</span> h <span class="kw">in</span> hours <span class="cf">if</span> h <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>]</span>
<span id="cb49-1352"><a href="#cb49-1352" aria-hidden="true" tabindex="-1"></a>even_positions <span class="op">=</span> [hours.index(h) <span class="cf">for</span> h <span class="kw">in</span> even_hours]</span>
<span id="cb49-1353"><a href="#cb49-1353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1354"><a href="#cb49-1354" aria-hidden="true" tabindex="-1"></a>combos <span class="op">=</span> [</span>
<span id="cb49-1355"><a href="#cb49-1355" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'SA1-SOLAR'</span>, <span class="st">'SA1-ROOFTOP-SOLAR'</span>],</span>
<span id="cb49-1356"><a href="#cb49-1356" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'VIC1-SOLAR'</span>, <span class="st">'VIC1-ROOFTOP-SOLAR'</span>],</span>
<span id="cb49-1357"><a href="#cb49-1357" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'QLD1-SOLAR'</span>, <span class="st">'QLD1-ROOFTOP-SOLAR'</span>],</span>
<span id="cb49-1358"><a href="#cb49-1358" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'NSW1-SOLAR'</span>, <span class="st">'NSW1-ROOFTOP-SOLAR'</span>]</span>
<span id="cb49-1359"><a href="#cb49-1359" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb49-1360"><a href="#cb49-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1361"><a href="#cb49-1361" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(</span>
<span id="cb49-1362"><a href="#cb49-1362" aria-hidden="true" tabindex="-1"></a>    nrows<span class="op">=</span><span class="dv">2</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>),</span>
<span id="cb49-1363"><a href="#cb49-1363" aria-hidden="true" tabindex="-1"></a>    sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span>   <span class="co"># share y for common scale</span></span>
<span id="cb49-1364"><a href="#cb49-1364" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-1365"><a href="#cb49-1365" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()</span>
<span id="cb49-1366"><a href="#cb49-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1367"><a href="#cb49-1367" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.35</span></span>
<span id="cb49-1368"><a href="#cb49-1368" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="bu">len</span>(hours))</span>
<span id="cb49-1369"><a href="#cb49-1369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1370"><a href="#cb49-1370" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax, (sol_col, rt_col) <span class="kw">in</span> <span class="bu">zip</span>(axes, combos):</span>
<span id="cb49-1371"><a href="#cb49-1371" aria-hidden="true" tabindex="-1"></a>    sol_data <span class="op">=</span> [solar_cf[solar_cf[<span class="st">'hour'</span>]<span class="op">==</span>h][sol_col].dropna().values <span class="cf">for</span> h <span class="kw">in</span> hours]</span>
<span id="cb49-1372"><a href="#cb49-1372" aria-hidden="true" tabindex="-1"></a>    rt_data  <span class="op">=</span> [solar_cf[solar_cf[<span class="st">'hour'</span>]<span class="op">==</span>h][rt_col].dropna().values <span class="cf">for</span> h <span class="kw">in</span> hours]</span>
<span id="cb49-1373"><a href="#cb49-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1374"><a href="#cb49-1374" aria-hidden="true" tabindex="-1"></a>    bp1 <span class="op">=</span> ax.boxplot(</span>
<span id="cb49-1375"><a href="#cb49-1375" aria-hidden="true" tabindex="-1"></a>        sol_data,</span>
<span id="cb49-1376"><a href="#cb49-1376" aria-hidden="true" tabindex="-1"></a>        positions<span class="op">=</span>x <span class="op">-</span> width<span class="op">/</span><span class="dv">2</span>, widths<span class="op">=</span>width, patch_artist<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb49-1377"><a href="#cb49-1377" aria-hidden="true" tabindex="-1"></a>        boxprops<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">'#FDB324'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb49-1378"><a href="#cb49-1378" aria-hidden="true" tabindex="-1"></a>        medianprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'blue'</span>),</span>
<span id="cb49-1379"><a href="#cb49-1379" aria-hidden="true" tabindex="-1"></a>        whiskerprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb49-1380"><a href="#cb49-1380" aria-hidden="true" tabindex="-1"></a>        capprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb49-1381"><a href="#cb49-1381" aria-hidden="true" tabindex="-1"></a>        flierprops<span class="op">=</span><span class="bu">dict</span>(markeredgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb49-1382"><a href="#cb49-1382" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-1383"><a href="#cb49-1383" aria-hidden="true" tabindex="-1"></a>    bp2 <span class="op">=</span> ax.boxplot(</span>
<span id="cb49-1384"><a href="#cb49-1384" aria-hidden="true" tabindex="-1"></a>        rt_data,</span>
<span id="cb49-1385"><a href="#cb49-1385" aria-hidden="true" tabindex="-1"></a>        positions<span class="op">=</span>x <span class="op">+</span> width<span class="op">/</span><span class="dv">2</span>, widths<span class="op">=</span>width, patch_artist<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb49-1386"><a href="#cb49-1386" aria-hidden="true" tabindex="-1"></a>        boxprops<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">'#FFE066'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb49-1387"><a href="#cb49-1387" aria-hidden="true" tabindex="-1"></a>        medianprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'green'</span>),</span>
<span id="cb49-1388"><a href="#cb49-1388" aria-hidden="true" tabindex="-1"></a>        whiskerprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb49-1389"><a href="#cb49-1389" aria-hidden="true" tabindex="-1"></a>        capprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb49-1390"><a href="#cb49-1390" aria-hidden="true" tabindex="-1"></a>        flierprops<span class="op">=</span><span class="bu">dict</span>(markeredgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb49-1391"><a href="#cb49-1391" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-1392"><a href="#cb49-1392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1393"><a href="#cb49-1393" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f"</span><span class="sc">{</span>sol_col<span class="sc">}</span><span class="ss"> vs </span><span class="sc">{</span>rt_col<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb49-1394"><a href="#cb49-1394" aria-hidden="true" tabindex="-1"></a>    ax.set_xticks(even_positions)</span>
<span id="cb49-1395"><a href="#cb49-1395" aria-hidden="true" tabindex="-1"></a>    ax.set_xticklabels(even_hours)</span>
<span id="cb49-1396"><a href="#cb49-1396" aria-hidden="true" tabindex="-1"></a>    ax.set_facecolor(<span class="st">'#F0FFFF'</span>)</span>
<span id="cb49-1397"><a href="#cb49-1397" aria-hidden="true" tabindex="-1"></a>    <span class="co"># no individual ylabel here</span></span>
<span id="cb49-1398"><a href="#cb49-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1399"><a href="#cb49-1399" aria-hidden="true" tabindex="-1"></a><span class="co"># shared legend</span></span>
<span id="cb49-1400"><a href="#cb49-1400" aria-hidden="true" tabindex="-1"></a>handles <span class="op">=</span> [bp1[<span class="st">"boxes"</span>][<span class="dv">0</span>], bp2[<span class="st">"boxes"</span>][<span class="dv">0</span>]]</span>
<span id="cb49-1401"><a href="#cb49-1401" aria-hidden="true" tabindex="-1"></a>labels  <span class="op">=</span> [<span class="st">'Utility-scale Solar'</span>, <span class="st">'Rooftop Solar'</span>]</span>
<span id="cb49-1402"><a href="#cb49-1402" aria-hidden="true" tabindex="-1"></a>fig.legend(handles, labels, loc<span class="op">=</span><span class="st">'upper center'</span>, ncol<span class="op">=</span><span class="dv">2</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">0.5</span>, <span class="fl">0.98</span>))</span>
<span id="cb49-1403"><a href="#cb49-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1404"><a href="#cb49-1404" aria-hidden="true" tabindex="-1"></a><span class="co"># one common y-axis label</span></span>
<span id="cb49-1405"><a href="#cb49-1405" aria-hidden="true" tabindex="-1"></a>fig.supxlabel(<span class="st">'Hour of Day (2024)'</span>)</span>
<span id="cb49-1406"><a href="#cb49-1406" aria-hidden="true" tabindex="-1"></a>fig.supylabel(<span class="st">'Capacity Factor'</span>)</span>
<span id="cb49-1407"><a href="#cb49-1407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1408"><a href="#cb49-1408" aria-hidden="true" tabindex="-1"></a>fig.tight_layout(rect<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.95</span>])</span>
<span id="cb49-1409"><a href="#cb49-1409" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb49-1410"><a href="#cb49-1410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1411"><a href="#cb49-1411" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1412"><a href="#cb49-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1413"><a href="#cb49-1413" aria-hidden="true" tabindex="-1"></a>There is a clear midday **plateau** in utility solar output (orange boxplots), likely resulting from either **negative market prices** or **network constraints** such as congestion.</span>
<span id="cb49-1414"><a href="#cb49-1414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1415"><a href="#cb49-1415" aria-hidden="true" tabindex="-1"></a>In Victoria, the curtailment plateau is especially pronounced. This is likely due to utility-scale solar farms being situated in parts of the network that experience congestion. Congestion arises when the network’s ability to transmit electricity is constrained, requiring operators to curtail solar generation despite sufficient solar resources being available.</span>
<span id="cb49-1416"><a href="#cb49-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1417"><a href="#cb49-1417" aria-hidden="true" tabindex="-1"></a>&lt;div style="text-align: center;"&gt;</span>
<span id="cb49-1418"><a href="#cb49-1418" aria-hidden="true" tabindex="-1"></a><span class="al">![Operating utility solar in Victoria (Open Electricity)](images/vic1-solar-operating.png)</span></span>
<span id="cb49-1419"><a href="#cb49-1419" aria-hidden="true" tabindex="-1"></a>&lt;/div&gt;</span>
<span id="cb49-1420"><a href="#cb49-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1421"><a href="#cb49-1421" aria-hidden="true" tabindex="-1"></a> <span class="at">&gt; Under near-term operating conditions, connection points in Victoria have on average close to 50% curtailment for solar and 30% curtailment for wind. - AEMO, 2025 Enhanced Locational Information (ELI) Report [</span><span class="co">[</span><span class="ot">link</span><span class="co">]</span><span class="at">](https://aemo.com.au/-/media/files/electricity/nem/planning_and_forecasting/enhanced-locational-information/2025/2025-enhanced-locational-information-report.pdf?la=en)</span></span>
<span id="cb49-1422"><a href="#cb49-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1423"><a href="#cb49-1423" aria-hidden="true" tabindex="-1"></a> <span class="at">&gt; Further congestion is noted to impact the curtailment at north-west Victoria, due to local transmission network limitations and existing high level of renewable energy generation. - AEMO, 2025 ELI Report</span></span>
<span id="cb49-1424"><a href="#cb49-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1425"><a href="#cb49-1425" aria-hidden="true" tabindex="-1"></a>In contrast, **rooftop solar** is far more challenging to curtail in real-world conditions. Although mechanisms exist (such as the capability to remotely disconnect rooftop PV via regulations like South Australia's Smarter Homes program), these are described as a "tool of last resort" and invoked only in extreme security conditions. The technical ability to enforce widespread, routine curtailment of rooftop systems is currently limited; implementing it more broadly would risk significant **social license erosion** unless there is a *massive uptake* of consumer energy resources such as batteries and electric vehicles, allowing households to store their own surplus solar for later use.</span>
<span id="cb49-1426"><a href="#cb49-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1427"><a href="#cb49-1427" aria-hidden="true" tabindex="-1"></a>A similar dynamic is evident with wind output. The dip in wind is too pronounced to be natural drop-off in wind speed during the middle of the day.</span>
<span id="cb49-1428"><a href="#cb49-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1431"><a href="#cb49-1431" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-1432"><a href="#cb49-1432" aria-hidden="true" tabindex="-1"></a>wind_cf <span class="op">=</span> n.generators_t.p_max_pu[[<span class="st">'SA1-WIND'</span>, <span class="st">'SA1-ROOFTOP-SOLAR'</span>,</span>
<span id="cb49-1433"><a href="#cb49-1433" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'VIC1-WIND'</span>, <span class="st">'VIC1-ROOFTOP-SOLAR'</span>,</span>
<span id="cb49-1434"><a href="#cb49-1434" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'QLD1-WIND'</span>, <span class="st">'QLD1-ROOFTOP-SOLAR'</span>,</span>
<span id="cb49-1435"><a href="#cb49-1435" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'NSW1-WIND'</span>, <span class="st">'NSW1-ROOFTOP-SOLAR'</span>]].reset_index()</span>
<span id="cb49-1436"><a href="#cb49-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1437"><a href="#cb49-1437" aria-hidden="true" tabindex="-1"></a>wind_cf[<span class="st">'hour'</span>] <span class="op">=</span> wind_cf[<span class="st">'snapshot'</span>].dt.hour</span>
<span id="cb49-1438"><a href="#cb49-1438" aria-hidden="true" tabindex="-1"></a>hours <span class="op">=</span> <span class="bu">sorted</span>(wind_cf[<span class="st">'hour'</span>].unique())</span>
<span id="cb49-1439"><a href="#cb49-1439" aria-hidden="true" tabindex="-1"></a>even_hours <span class="op">=</span> [h <span class="cf">for</span> h <span class="kw">in</span> hours <span class="cf">if</span> h <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>]</span>
<span id="cb49-1440"><a href="#cb49-1440" aria-hidden="true" tabindex="-1"></a>even_positions <span class="op">=</span> [hours.index(h) <span class="cf">for</span> h <span class="kw">in</span> even_hours]</span>
<span id="cb49-1441"><a href="#cb49-1441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1442"><a href="#cb49-1442" aria-hidden="true" tabindex="-1"></a>combos <span class="op">=</span> [</span>
<span id="cb49-1443"><a href="#cb49-1443" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'SA1-WIND'</span>, <span class="st">'SA1-ROOFTOP-SOLAR'</span>],</span>
<span id="cb49-1444"><a href="#cb49-1444" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'VIC1-WIND'</span>, <span class="st">'VIC1-ROOFTOP-SOLAR'</span>],</span>
<span id="cb49-1445"><a href="#cb49-1445" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'QLD1-WIND'</span>, <span class="st">'QLD1-ROOFTOP-SOLAR'</span>],</span>
<span id="cb49-1446"><a href="#cb49-1446" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'NSW1-WIND'</span>, <span class="st">'NSW1-ROOFTOP-SOLAR'</span>]</span>
<span id="cb49-1447"><a href="#cb49-1447" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb49-1448"><a href="#cb49-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1449"><a href="#cb49-1449" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(</span>
<span id="cb49-1450"><a href="#cb49-1450" aria-hidden="true" tabindex="-1"></a>    nrows<span class="op">=</span><span class="dv">2</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>),</span>
<span id="cb49-1451"><a href="#cb49-1451" aria-hidden="true" tabindex="-1"></a>    sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span>   <span class="co"># share y for common scale</span></span>
<span id="cb49-1452"><a href="#cb49-1452" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-1453"><a href="#cb49-1453" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()</span>
<span id="cb49-1454"><a href="#cb49-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1455"><a href="#cb49-1455" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.35</span></span>
<span id="cb49-1456"><a href="#cb49-1456" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="bu">len</span>(hours))</span>
<span id="cb49-1457"><a href="#cb49-1457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1458"><a href="#cb49-1458" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax, (sol_col, rt_col) <span class="kw">in</span> <span class="bu">zip</span>(axes, combos):</span>
<span id="cb49-1459"><a href="#cb49-1459" aria-hidden="true" tabindex="-1"></a>    wind_data <span class="op">=</span> [wind_cf[wind_cf[<span class="st">'hour'</span>]<span class="op">==</span>h][sol_col].dropna().values <span class="cf">for</span> h <span class="kw">in</span> hours]</span>
<span id="cb49-1460"><a href="#cb49-1460" aria-hidden="true" tabindex="-1"></a>    rt_data  <span class="op">=</span> [wind_cf[wind_cf[<span class="st">'hour'</span>]<span class="op">==</span>h][rt_col].dropna().values <span class="cf">for</span> h <span class="kw">in</span> hours]</span>
<span id="cb49-1461"><a href="#cb49-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1462"><a href="#cb49-1462" aria-hidden="true" tabindex="-1"></a>    bp1 <span class="op">=</span> ax.boxplot(</span>
<span id="cb49-1463"><a href="#cb49-1463" aria-hidden="true" tabindex="-1"></a>        wind_data,</span>
<span id="cb49-1464"><a href="#cb49-1464" aria-hidden="true" tabindex="-1"></a>        positions<span class="op">=</span>x <span class="op">-</span> width<span class="op">/</span><span class="dv">2</span>, widths<span class="op">=</span>width, patch_artist<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb49-1465"><a href="#cb49-1465" aria-hidden="true" tabindex="-1"></a>        boxprops<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">'#3BBFE5'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb49-1466"><a href="#cb49-1466" aria-hidden="true" tabindex="-1"></a>        medianprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'blue'</span>),</span>
<span id="cb49-1467"><a href="#cb49-1467" aria-hidden="true" tabindex="-1"></a>        whiskerprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb49-1468"><a href="#cb49-1468" aria-hidden="true" tabindex="-1"></a>        capprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb49-1469"><a href="#cb49-1469" aria-hidden="true" tabindex="-1"></a>        flierprops<span class="op">=</span><span class="bu">dict</span>(markeredgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb49-1470"><a href="#cb49-1470" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-1471"><a href="#cb49-1471" aria-hidden="true" tabindex="-1"></a>    bp2 <span class="op">=</span> ax.boxplot(</span>
<span id="cb49-1472"><a href="#cb49-1472" aria-hidden="true" tabindex="-1"></a>        rt_data,</span>
<span id="cb49-1473"><a href="#cb49-1473" aria-hidden="true" tabindex="-1"></a>        positions<span class="op">=</span>x <span class="op">+</span> width<span class="op">/</span><span class="dv">2</span>, widths<span class="op">=</span>width, patch_artist<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb49-1474"><a href="#cb49-1474" aria-hidden="true" tabindex="-1"></a>        boxprops<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">'#FFE066'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb49-1475"><a href="#cb49-1475" aria-hidden="true" tabindex="-1"></a>        medianprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'green'</span>),</span>
<span id="cb49-1476"><a href="#cb49-1476" aria-hidden="true" tabindex="-1"></a>        whiskerprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb49-1477"><a href="#cb49-1477" aria-hidden="true" tabindex="-1"></a>        capprops<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb49-1478"><a href="#cb49-1478" aria-hidden="true" tabindex="-1"></a>        flierprops<span class="op">=</span><span class="bu">dict</span>(markeredgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb49-1479"><a href="#cb49-1479" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-1480"><a href="#cb49-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1481"><a href="#cb49-1481" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f"</span><span class="sc">{</span>sol_col<span class="sc">}</span><span class="ss"> vs </span><span class="sc">{</span>rt_col<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb49-1482"><a href="#cb49-1482" aria-hidden="true" tabindex="-1"></a>    ax.set_xticks(even_positions)</span>
<span id="cb49-1483"><a href="#cb49-1483" aria-hidden="true" tabindex="-1"></a>    ax.set_xticklabels(even_hours)</span>
<span id="cb49-1484"><a href="#cb49-1484" aria-hidden="true" tabindex="-1"></a>    ax.set_facecolor(<span class="st">'#F0FFFF'</span>)</span>
<span id="cb49-1485"><a href="#cb49-1485" aria-hidden="true" tabindex="-1"></a>    <span class="co"># no individual ylabel here</span></span>
<span id="cb49-1486"><a href="#cb49-1486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1487"><a href="#cb49-1487" aria-hidden="true" tabindex="-1"></a><span class="co"># shared legend</span></span>
<span id="cb49-1488"><a href="#cb49-1488" aria-hidden="true" tabindex="-1"></a>handles <span class="op">=</span> [bp1[<span class="st">"boxes"</span>][<span class="dv">0</span>], bp2[<span class="st">"boxes"</span>][<span class="dv">0</span>]]</span>
<span id="cb49-1489"><a href="#cb49-1489" aria-hidden="true" tabindex="-1"></a>labels  <span class="op">=</span> [<span class="st">'Wind'</span>, <span class="st">'Rooftop Solar'</span>]</span>
<span id="cb49-1490"><a href="#cb49-1490" aria-hidden="true" tabindex="-1"></a>fig.legend(handles, labels, loc<span class="op">=</span><span class="st">'upper center'</span>, ncol<span class="op">=</span><span class="dv">2</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">0.5</span>, <span class="fl">0.98</span>))</span>
<span id="cb49-1491"><a href="#cb49-1491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1492"><a href="#cb49-1492" aria-hidden="true" tabindex="-1"></a><span class="co"># one common y-axis label</span></span>
<span id="cb49-1493"><a href="#cb49-1493" aria-hidden="true" tabindex="-1"></a>fig.supxlabel(<span class="st">'Hour of Day (2024)'</span>)</span>
<span id="cb49-1494"><a href="#cb49-1494" aria-hidden="true" tabindex="-1"></a>fig.supylabel(<span class="st">'Capacity Factor'</span>)</span>
<span id="cb49-1495"><a href="#cb49-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1496"><a href="#cb49-1496" aria-hidden="true" tabindex="-1"></a>fig.tight_layout(rect<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.95</span>])</span>
<span id="cb49-1497"><a href="#cb49-1497" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb49-1498"><a href="#cb49-1498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1499"><a href="#cb49-1499" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1500"><a href="#cb49-1500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1501"><a href="#cb49-1501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1502"><a href="#cb49-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1503"><a href="#cb49-1503" aria-hidden="true" tabindex="-1"></a><span class="fu">### 05 Conclusion and Next Steps</span></span>
<span id="cb49-1504"><a href="#cb49-1504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1505"><a href="#cb49-1505" aria-hidden="true" tabindex="-1"></a>This simple model demonstrates that achieving a high-penetration renewable energy grid is possible. However, there is an inherent trade-off between deploying large amounts of variable renewable energy and managing increased curtailment. The model focuses solely on power flow analysis and does not account for costs beyond assigning marginal costs to generators to enable least-cost dispatch. Additionally, I’ve assigned a very small negative marginal cost to storage units, encouraging batteries to charge earlier rather than at the last possible moment - an approach enabled by the model’s assumption of perfect foresight.</span>
<span id="cb49-1506"><a href="#cb49-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1507"><a href="#cb49-1507" aria-hidden="true" tabindex="-1"></a>It is also important to note that there is no assurance the system would operate in a **secure state** within the <span class="in">`8.2.1_6xVreCurtailReview`</span> scenario/network. Incorporating the necessary constraints to ensure secure system operation would introduce significant complexity and is reserved for future analysis. Additionally, this scenario is highly sensitive to increases in demand - a 5% rise, for instance, leads to unserved energy. This highlights the need for substantial overbuilding to create an adequate reserve buffer, which, in turn, further increases curtailment.</span>
<span id="cb49-1508"><a href="#cb49-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1509"><a href="#cb49-1509" aria-hidden="true" tabindex="-1"></a>During the development of the <span class="in">`8.2.1_6xVreCurtailReview`</span> scenario, several scenarios with aggressive coal reduction - such as <span class="in">`2_BalancedAggressiveTransition`</span> - led to a doubling of gas-powered generation (GPG). This occurred because GPG was required to compensate for the loss of 75% of baseload capacity previously provided by coal. Further details can be found in the Appendix.</span>
<span id="cb49-1510"><a href="#cb49-1510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1511"><a href="#cb49-1511" aria-hidden="true" tabindex="-1"></a>The high penetration VRE scenarios are also under-utilising hydro. Some of this can be explained by setting a small marginal price ($8.58) as per 2024 ISP Inputs and Assumptions workbook. An example of this marginal price sensitivity can be found in the Appendix. 2024 was a dry year, which also contributed to Hydro underperformance.</span>
<span id="cb49-1512"><a href="#cb49-1512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1513"><a href="#cb49-1513" aria-hidden="true" tabindex="-1"></a>Potential future analysis would also incorporate:  </span>
<span id="cb49-1514"><a href="#cb49-1514" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>increased transmission (lines/links currently stacked on top of each other as they join the same bus)</span>
<span id="cb49-1515"><a href="#cb49-1515" aria-hidden="true" tabindex="-1"></a><span class="ss">  -  </span>accurate geospatial resolution  </span>
<span id="cb49-1516"><a href="#cb49-1516" aria-hidden="true" tabindex="-1"></a><span class="ss">  -  </span>more detailed costs, including capital costs, and  </span>
<span id="cb49-1517"><a href="#cb49-1517" aria-hidden="true" tabindex="-1"></a><span class="ss">  -  </span>carbon emissions.</span>
<span id="cb49-1518"><a href="#cb49-1518" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-1519"><a href="#cb49-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1520"><a href="#cb49-1520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1521"><a href="#cb49-1521" aria-hidden="true" tabindex="-1"></a><span class="fu">### 06 Appendix</span></span>
<span id="cb49-1522"><a href="#cb49-1522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1523"><a href="#cb49-1523" aria-hidden="true" tabindex="-1"></a>As mentioned in the conclusion, there is no certainty around whether or not the <span class="in">`8.2.1_6xVreCurtailReview`</span> network could operate in a secure state.</span>
<span id="cb49-1524"><a href="#cb49-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1525"><a href="#cb49-1525" aria-hidden="true" tabindex="-1"></a>It is possible to determine in rough terms, how often for example the network would be issued Lack of Reserve (LOR) notices by the system operator. Here we'll use the per region thresholds published by AEMO.</span>
<span id="cb49-1526"><a href="#cb49-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1527"><a href="#cb49-1527" aria-hidden="true" tabindex="-1"></a>It is worth noting that these reserve requirements are dynamic and always changing, see example below of a recent LOR notice from AEMO in reference to the South Australian region:</span>
<span id="cb49-1528"><a href="#cb49-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1529"><a href="#cb49-1529" aria-hidden="true" tabindex="-1"></a>&lt;div style="text-align: center;"&gt;</span>
<span id="cb49-1530"><a href="#cb49-1530" aria-hidden="true" tabindex="-1"></a><span class="al">![LOR notice example showing dynamic reserve requirements](images/lor-notice-example.png)</span></span>
<span id="cb49-1531"><a href="#cb49-1531" aria-hidden="true" tabindex="-1"></a>&lt;/div&gt;</span>
<span id="cb49-1532"><a href="#cb49-1532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1535"><a href="#cb49-1535" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-1536"><a href="#cb49-1536" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_reserve_breaches_df(n, threshold_mw<span class="op">=</span><span class="dv">850</span>):</span>
<span id="cb49-1537"><a href="#cb49-1537" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb49-1538"><a href="#cb49-1538" aria-hidden="true" tabindex="-1"></a><span class="co">    Count how many hours in 2024 the reserve margin</span></span>
<span id="cb49-1539"><a href="#cb49-1539" aria-hidden="true" tabindex="-1"></a><span class="co">    (available capacity minus load) at each bus dips below threshold_mw.</span></span>
<span id="cb49-1540"><a href="#cb49-1540" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns a DataFrame with breach counts and breach ratios.</span></span>
<span id="cb49-1541"><a href="#cb49-1541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1542"><a href="#cb49-1542" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb49-1543"><a href="#cb49-1543" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb49-1544"><a href="#cb49-1544" aria-hidden="true" tabindex="-1"></a><span class="co">    n : pypsa.Network</span></span>
<span id="cb49-1545"><a href="#cb49-1545" aria-hidden="true" tabindex="-1"></a><span class="co">        A solved PyPSA network.</span></span>
<span id="cb49-1546"><a href="#cb49-1546" aria-hidden="true" tabindex="-1"></a><span class="co">    threshold_mw : float or dict</span></span>
<span id="cb49-1547"><a href="#cb49-1547" aria-hidden="true" tabindex="-1"></a><span class="co">        If float, same threshold (in MW) for every bus.</span></span>
<span id="cb49-1548"><a href="#cb49-1548" aria-hidden="true" tabindex="-1"></a><span class="co">        If dict, keys are bus names and values are thresholds for those buses;</span></span>
<span id="cb49-1549"><a href="#cb49-1549" aria-hidden="true" tabindex="-1"></a><span class="co">        any bus not in the dict uses the global default (if provided) or 0.</span></span>
<span id="cb49-1550"><a href="#cb49-1550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1551"><a href="#cb49-1551" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb49-1552"><a href="#cb49-1552" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb49-1553"><a href="#cb49-1553" aria-hidden="true" tabindex="-1"></a><span class="co">    pd.DataFrame</span></span>
<span id="cb49-1554"><a href="#cb49-1554" aria-hidden="true" tabindex="-1"></a><span class="co">        DataFrame with columns:</span></span>
<span id="cb49-1555"><a href="#cb49-1555" aria-hidden="true" tabindex="-1"></a><span class="co">          'breach_hours': number of hours below threshold</span></span>
<span id="cb49-1556"><a href="#cb49-1556" aria-hidden="true" tabindex="-1"></a><span class="co">          'breach_ratio': breach_hours / total_snapshots</span></span>
<span id="cb49-1557"><a href="#cb49-1557" aria-hidden="true" tabindex="-1"></a><span class="co">        Index is bus name.</span></span>
<span id="cb49-1558"><a href="#cb49-1558" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb49-1559"><a href="#cb49-1559" aria-hidden="true" tabindex="-1"></a>    avail <span class="op">=</span> n.generators_t.p_max_pu.multiply(n.generators.p_nom, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb49-1560"><a href="#cb49-1560" aria-hidden="true" tabindex="-1"></a>    avail_by_bus <span class="op">=</span> avail.T.groupby(n.generators.bus).<span class="bu">sum</span>().T</span>
<span id="cb49-1561"><a href="#cb49-1561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1562"><a href="#cb49-1562" aria-hidden="true" tabindex="-1"></a>    loads <span class="op">=</span> n.loads_t.p_set</span>
<span id="cb49-1563"><a href="#cb49-1563" aria-hidden="true" tabindex="-1"></a>    load_by_bus <span class="op">=</span> loads.T.groupby(n.loads.bus).<span class="bu">sum</span>().T</span>
<span id="cb49-1564"><a href="#cb49-1564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1565"><a href="#cb49-1565" aria-hidden="true" tabindex="-1"></a>    all_buses <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>(avail_by_bus.columns) <span class="op">|</span> <span class="bu">set</span>(load_by_bus.columns))</span>
<span id="cb49-1566"><a href="#cb49-1566" aria-hidden="true" tabindex="-1"></a>    avail_by_bus <span class="op">=</span> avail_by_bus.reindex(columns<span class="op">=</span>all_buses, fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb49-1567"><a href="#cb49-1567" aria-hidden="true" tabindex="-1"></a>    load_by_bus  <span class="op">=</span> load_by_bus.reindex(columns<span class="op">=</span>all_buses, fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb49-1568"><a href="#cb49-1568" aria-hidden="true" tabindex="-1"></a>    avail_by_bus <span class="op">=</span> avail_by_bus.reindex(index<span class="op">=</span>load_by_bus.index, fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb49-1569"><a href="#cb49-1569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1570"><a href="#cb49-1570" aria-hidden="true" tabindex="-1"></a>    reserve <span class="op">=</span> avail_by_bus.subtract(load_by_bus, fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb49-1571"><a href="#cb49-1571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1572"><a href="#cb49-1572" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(threshold_mw, <span class="bu">dict</span>):</span>
<span id="cb49-1573"><a href="#cb49-1573" aria-hidden="true" tabindex="-1"></a>        thresh <span class="op">=</span> pd.Series({bus: threshold_mw.get(bus, <span class="fl">0.0</span>) <span class="cf">for</span> bus <span class="kw">in</span> all_buses})</span>
<span id="cb49-1574"><a href="#cb49-1574" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb49-1575"><a href="#cb49-1575" aria-hidden="true" tabindex="-1"></a>        thresh <span class="op">=</span> pd.Series(threshold_mw, index<span class="op">=</span>all_buses)</span>
<span id="cb49-1576"><a href="#cb49-1576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1577"><a href="#cb49-1577" aria-hidden="true" tabindex="-1"></a>    breaches <span class="op">=</span> (reserve.lt(thresh, axis<span class="op">=</span><span class="dv">1</span>)).<span class="bu">sum</span>()</span>
<span id="cb49-1578"><a href="#cb49-1578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1579"><a href="#cb49-1579" aria-hidden="true" tabindex="-1"></a>    total_snapshots <span class="op">=</span> reserve.shape[<span class="dv">0</span>]</span>
<span id="cb49-1580"><a href="#cb49-1580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1581"><a href="#cb49-1581" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb49-1582"><a href="#cb49-1582" aria-hidden="true" tabindex="-1"></a>        <span class="st">'breach_hours'</span>: breaches,</span>
<span id="cb49-1583"><a href="#cb49-1583" aria-hidden="true" tabindex="-1"></a>        <span class="st">'breach_ratio'</span>: breaches <span class="op">/</span> total_snapshots</span>
<span id="cb49-1584"><a href="#cb49-1584" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb49-1585"><a href="#cb49-1585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1586"><a href="#cb49-1586" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb49-1587"><a href="#cb49-1587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1588"><a href="#cb49-1588" aria-hidden="true" tabindex="-1"></a><span class="co"># For per-region thresholds</span></span>
<span id="cb49-1589"><a href="#cb49-1589" aria-hidden="true" tabindex="-1"></a><span class="co"># Source: 2024 ISP Inputs and Assumptions workbook.xlsx (sheet: Reserves)</span></span>
<span id="cb49-1590"><a href="#cb49-1590" aria-hidden="true" tabindex="-1"></a>per_region <span class="op">=</span> {<span class="st">"NSW1"</span>:<span class="dv">705</span>, <span class="st">"VIC1"</span>:<span class="dv">550</span>, <span class="st">"QLD1"</span>:<span class="dv">710</span>, <span class="st">"SA1"</span>:<span class="dv">195</span>, <span class="st">"TAS1"</span>:<span class="dv">140</span>}</span>
<span id="cb49-1591"><a href="#cb49-1591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1592"><a href="#cb49-1592" aria-hidden="true" tabindex="-1"></a>count_reserve_breaches_df(n, threshold_mw<span class="op">=</span>per_region)</span>
<span id="cb49-1593"><a href="#cb49-1593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1594"><a href="#cb49-1594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1595"><a href="#cb49-1595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1596"><a href="#cb49-1596" aria-hidden="true" tabindex="-1"></a>New South Wales is attracting the most breaches at just over one third of hours breached.</span>
<span id="cb49-1597"><a href="#cb49-1597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1598"><a href="#cb49-1598" aria-hidden="true" tabindex="-1"></a>We can take a quick look at the gas generation coverage.</span>
<span id="cb49-1599"><a href="#cb49-1599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1602"><a href="#cb49-1602" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-1603"><a href="#cb49-1603" aria-hidden="true" tabindex="-1"></a>gas <span class="op">=</span> (</span>
<span id="cb49-1604"><a href="#cb49-1604" aria-hidden="true" tabindex="-1"></a>    n.generators</span>
<span id="cb49-1605"><a href="#cb49-1605" aria-hidden="true" tabindex="-1"></a>     .query(<span class="st">"carrier == 'Gas'"</span>)</span>
<span id="cb49-1606"><a href="#cb49-1606" aria-hidden="true" tabindex="-1"></a>     .<span class="bu">filter</span>([<span class="st">'bus'</span>,<span class="st">'p_nom'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb49-1607"><a href="#cb49-1607" aria-hidden="true" tabindex="-1"></a>     .reset_index()</span>
<span id="cb49-1608"><a href="#cb49-1608" aria-hidden="true" tabindex="-1"></a>     .rename(columns<span class="op">=</span>{<span class="st">'index'</span>:<span class="st">'name'</span>})</span>
<span id="cb49-1609"><a href="#cb49-1609" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb49-1610"><a href="#cb49-1610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1611"><a href="#cb49-1611" aria-hidden="true" tabindex="-1"></a><span class="co"># add per-region lookup</span></span>
<span id="cb49-1612"><a href="#cb49-1612" aria-hidden="true" tabindex="-1"></a>gas[<span class="st">'reserve'</span>] <span class="op">=</span> gas[<span class="st">'bus'</span>].<span class="bu">map</span>(per_region)</span>
<span id="cb49-1613"><a href="#cb49-1613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1614"><a href="#cb49-1614" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb49-1615"><a href="#cb49-1615" aria-hidden="true" tabindex="-1"></a>gas <span class="op">=</span> gas[[<span class="st">'bus'</span>, <span class="st">'p_nom'</span>, <span class="st">'reserve'</span>]]</span>
<span id="cb49-1616"><a href="#cb49-1616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1617"><a href="#cb49-1617" aria-hidden="true" tabindex="-1"></a>gas</span>
<span id="cb49-1618"><a href="#cb49-1618" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1619"><a href="#cb49-1619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1620"><a href="#cb49-1620" aria-hidden="true" tabindex="-1"></a>There is enough reserve of gas capacity, however the model will operate under this on many occasions (as highlighted above), unless a custom constraint is added, which will increase solver run times.</span>
<span id="cb49-1621"><a href="#cb49-1621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1622"><a href="#cb49-1622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1623"><a href="#cb49-1623" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Generator Sensitivity to Marginal Costs</span></span>
<span id="cb49-1624"><a href="#cb49-1624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1625"><a href="#cb49-1625" aria-hidden="true" tabindex="-1"></a>Review potential vs dispatch of Hydro in the current network. This example highlights how changing one input assumption can make a big difference to the dispatch result.</span>
<span id="cb49-1626"><a href="#cb49-1626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1627"><a href="#cb49-1627" aria-hidden="true" tabindex="-1"></a>When the marginal price is set to $8.58 Hydro is seldomly dispatched - mainly in the winter months.</span>
<span id="cb49-1628"><a href="#cb49-1628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1631"><a href="#cb49-1631" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-1632"><a href="#cb49-1632" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot hydro dispatch vs potential</span></span>
<span id="cb49-1633"><a href="#cb49-1633" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_hydro_dispatch_vs_potential(n):</span>
<span id="cb49-1634"><a href="#cb49-1634" aria-hidden="true" tabindex="-1"></a>    hydro_gens  <span class="op">=</span> n.generators.index[n.generators.carrier <span class="op">==</span> <span class="st">'Hydro'</span>]</span>
<span id="cb49-1635"><a href="#cb49-1635" aria-hidden="true" tabindex="-1"></a>    hydro_cols  <span class="op">=</span> hydro_gens.intersection(n.generators_t.p_max_pu.columns)</span>
<span id="cb49-1636"><a href="#cb49-1636" aria-hidden="true" tabindex="-1"></a>    n_hydro     <span class="op">=</span> <span class="bu">len</span>(hydro_cols)</span>
<span id="cb49-1637"><a href="#cb49-1637" aria-hidden="true" tabindex="-1"></a>    ncols       <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb49-1638"><a href="#cb49-1638" aria-hidden="true" tabindex="-1"></a>    nrows       <span class="op">=</span> (n_hydro <span class="op">+</span> ncols <span class="op">-</span> <span class="dv">1</span>) <span class="op">//</span> ncols</span>
<span id="cb49-1639"><a href="#cb49-1639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1640"><a href="#cb49-1640" aria-hidden="true" tabindex="-1"></a>    <span class="co"># set up the date locator/formatter once</span></span>
<span id="cb49-1641"><a href="#cb49-1641" aria-hidden="true" tabindex="-1"></a>    locator   <span class="op">=</span> AutoDateLocator()</span>
<span id="cb49-1642"><a href="#cb49-1642" aria-hidden="true" tabindex="-1"></a>    formatter <span class="op">=</span> ConciseDateFormatter(locator)</span>
<span id="cb49-1643"><a href="#cb49-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1644"><a href="#cb49-1644" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(</span>
<span id="cb49-1645"><a href="#cb49-1645" aria-hidden="true" tabindex="-1"></a>        nrows<span class="op">=</span>nrows, ncols<span class="op">=</span>ncols,</span>
<span id="cb49-1646"><a href="#cb49-1646" aria-hidden="true" tabindex="-1"></a>        figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">4</span><span class="op">*</span>nrows),</span>
<span id="cb49-1647"><a href="#cb49-1647" aria-hidden="true" tabindex="-1"></a>        sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span></span>
<span id="cb49-1648"><a href="#cb49-1648" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-1649"><a href="#cb49-1649" aria-hidden="true" tabindex="-1"></a>    axes <span class="op">=</span> axes.flatten()</span>
<span id="cb49-1650"><a href="#cb49-1650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1651"><a href="#cb49-1651" aria-hidden="true" tabindex="-1"></a>    legend_handles, legend_labels <span class="op">=</span> [], []</span>
<span id="cb49-1652"><a href="#cb49-1652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1653"><a href="#cb49-1653" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, gen <span class="kw">in</span> <span class="bu">enumerate</span>(hydro_cols):</span>
<span id="cb49-1654"><a href="#cb49-1654" aria-hidden="true" tabindex="-1"></a>        ax <span class="op">=</span> axes[i]</span>
<span id="cb49-1655"><a href="#cb49-1655" aria-hidden="true" tabindex="-1"></a>        potential <span class="op">=</span> n.generators_t.p_max_pu[gen] <span class="op">*</span> n.generators.loc[gen, <span class="st">'p_nom'</span>]</span>
<span id="cb49-1656"><a href="#cb49-1656" aria-hidden="true" tabindex="-1"></a>        dispatch  <span class="op">=</span> n.generators_t.p[gen]</span>
<span id="cb49-1657"><a href="#cb49-1657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1658"><a href="#cb49-1658" aria-hidden="true" tabindex="-1"></a>        ln1 <span class="op">=</span> ax.plot(</span>
<span id="cb49-1659"><a href="#cb49-1659" aria-hidden="true" tabindex="-1"></a>            n.snapshots, potential,</span>
<span id="cb49-1660"><a href="#cb49-1660" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">'Potential'</span>, linestyle<span class="op">=</span><span class="st">':'</span>, color<span class="op">=</span><span class="st">'orange'</span>, alpha<span class="op">=</span><span class="fl">0.6</span></span>
<span id="cb49-1661"><a href="#cb49-1661" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb49-1662"><a href="#cb49-1662" aria-hidden="true" tabindex="-1"></a>        ln2 <span class="op">=</span> ax.plot(</span>
<span id="cb49-1663"><a href="#cb49-1663" aria-hidden="true" tabindex="-1"></a>            n.snapshots, dispatch,</span>
<span id="cb49-1664"><a href="#cb49-1664" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">'Dispatch'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, color<span class="op">=</span><span class="st">'#1E81D4'</span></span>
<span id="cb49-1665"><a href="#cb49-1665" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb49-1666"><a href="#cb49-1666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1667"><a href="#cb49-1667" aria-hidden="true" tabindex="-1"></a>        <span class="co"># apply concise date formatting</span></span>
<span id="cb49-1668"><a href="#cb49-1668" aria-hidden="true" tabindex="-1"></a>        ax.xaxis.set_major_locator(locator)</span>
<span id="cb49-1669"><a href="#cb49-1669" aria-hidden="true" tabindex="-1"></a>        ax.xaxis.set_major_formatter(formatter)</span>
<span id="cb49-1670"><a href="#cb49-1670" aria-hidden="true" tabindex="-1"></a>        ax.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelrotation<span class="op">=</span><span class="dv">0</span>, labelsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb49-1671"><a href="#cb49-1671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1672"><a href="#cb49-1672" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="ss">f'Hydro Gen: </span><span class="sc">{</span>gen<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb49-1673"><a href="#cb49-1673" aria-hidden="true" tabindex="-1"></a>        ax.set_facecolor(<span class="st">'#F0FFFF'</span>)</span>
<span id="cb49-1674"><a href="#cb49-1674" aria-hidden="true" tabindex="-1"></a>        ax.grid(<span class="va">True</span>)</span>
<span id="cb49-1675"><a href="#cb49-1675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1676"><a href="#cb49-1676" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb49-1677"><a href="#cb49-1677" aria-hidden="true" tabindex="-1"></a>            legend_handles <span class="op">=</span> ln1 <span class="op">+</span> ln2</span>
<span id="cb49-1678"><a href="#cb49-1678" aria-hidden="true" tabindex="-1"></a>            legend_labels  <span class="op">=</span> [<span class="st">'Potential'</span>, <span class="st">'Dispatch'</span>]</span>
<span id="cb49-1679"><a href="#cb49-1679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1680"><a href="#cb49-1680" aria-hidden="true" tabindex="-1"></a>    <span class="co"># drop any empty subplots</span></span>
<span id="cb49-1681"><a href="#cb49-1681" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i<span class="op">+</span><span class="dv">1</span>, <span class="bu">len</span>(axes)):</span>
<span id="cb49-1682"><a href="#cb49-1682" aria-hidden="true" tabindex="-1"></a>        fig.delaxes(axes[j])</span>
<span id="cb49-1683"><a href="#cb49-1683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1684"><a href="#cb49-1684" aria-hidden="true" tabindex="-1"></a>    <span class="co"># one shared legend &amp; axis labels</span></span>
<span id="cb49-1685"><a href="#cb49-1685" aria-hidden="true" tabindex="-1"></a>    fig.legend(legend_handles, legend_labels,</span>
<span id="cb49-1686"><a href="#cb49-1686" aria-hidden="true" tabindex="-1"></a>               loc<span class="op">=</span><span class="st">'upper center'</span>, ncol<span class="op">=</span><span class="dv">2</span>, frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb49-1687"><a href="#cb49-1687" aria-hidden="true" tabindex="-1"></a>    fig.supxlabel(<span class="st">'Time'</span>)</span>
<span id="cb49-1688"><a href="#cb49-1688" aria-hidden="true" tabindex="-1"></a>    fig.supylabel(<span class="st">'Power (MW)'</span>)</span>
<span id="cb49-1689"><a href="#cb49-1689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1690"><a href="#cb49-1690" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout(rect<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.95</span>])</span>
<span id="cb49-1691"><a href="#cb49-1691" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb49-1692"><a href="#cb49-1692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1693"><a href="#cb49-1693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1694"><a href="#cb49-1694" aria-hidden="true" tabindex="-1"></a>plot_hydro_dispatch_vs_potential(n)</span>
<span id="cb49-1695"><a href="#cb49-1695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1696"><a href="#cb49-1696" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1697"><a href="#cb49-1697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1698"><a href="#cb49-1698" aria-hidden="true" tabindex="-1"></a>Now set marginal cost of Hydro generators to zero.</span>
<span id="cb49-1699"><a href="#cb49-1699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1700"><a href="#cb49-1700" aria-hidden="true" tabindex="-1"></a>Optimize the network.</span>
<span id="cb49-1701"><a href="#cb49-1701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1704"><a href="#cb49-1704" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-1705"><a href="#cb49-1705" aria-hidden="true" tabindex="-1"></a><span class="co"># Ilustrate sensitivity of Hydro generation to marginal cost setting</span></span>
<span id="cb49-1706"><a href="#cb49-1706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1707"><a href="#cb49-1707" aria-hidden="true" tabindex="-1"></a><span class="co"># Get indices of Hydro generators</span></span>
<span id="cb49-1708"><a href="#cb49-1708" aria-hidden="true" tabindex="-1"></a>hydro_gens <span class="op">=</span> n.generators.index[n.generators.carrier <span class="op">==</span> <span class="st">'Hydro'</span>]</span>
<span id="cb49-1709"><a href="#cb49-1709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1710"><a href="#cb49-1710" aria-hidden="true" tabindex="-1"></a><span class="co"># Set marginal_cost to zero &amp; optimise</span></span>
<span id="cb49-1711"><a href="#cb49-1711" aria-hidden="true" tabindex="-1"></a>n.generators.loc[hydro_gens, <span class="st">'marginal_cost'</span>] <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb49-1712"><a href="#cb49-1712" aria-hidden="true" tabindex="-1"></a>n.optimize()</span>
<span id="cb49-1713"><a href="#cb49-1713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1714"><a href="#cb49-1714" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1715"><a href="#cb49-1715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1716"><a href="#cb49-1716" aria-hidden="true" tabindex="-1"></a>Run the same function again to compare the difference.</span>
<span id="cb49-1717"><a href="#cb49-1717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1720"><a href="#cb49-1720" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-1721"><a href="#cb49-1721" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-run function</span></span>
<span id="cb49-1722"><a href="#cb49-1722" aria-hidden="true" tabindex="-1"></a>plot_hydro_dispatch_vs_potential(n)</span>
<span id="cb49-1723"><a href="#cb49-1723" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1724"><a href="#cb49-1724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1725"><a href="#cb49-1725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1726"><a href="#cb49-1726" aria-hidden="true" tabindex="-1"></a><span class="fu">##### GPG in 2_BalancedAggressiveTransition</span></span>
<span id="cb49-1727"><a href="#cb49-1727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1728"><a href="#cb49-1728" aria-hidden="true" tabindex="-1"></a>The <span class="in">`2_BalancedAggressiveTransition`</span> scenario has a 75% reduction in coal and only a mild increase in renewables and storage (see table below).</span>
<span id="cb49-1729"><a href="#cb49-1729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1730"><a href="#cb49-1730" aria-hidden="true" tabindex="-1"></a>This indicates that without rapidly expanding renewables and storage, phasing out coal will strain gas generators and related infrastructure, as this scenario sees gas-powered generation rise by 107% compared to Open Electricity consumption over a recent 12 month period.</span>
<span id="cb49-1731"><a href="#cb49-1731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1734"><a href="#cb49-1734" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-1735"><a href="#cb49-1735" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: asis</span></span>
<span id="cb49-1736"><a href="#cb49-1736" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb49-1737"><a href="#cb49-1737" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Filter scenario</span></span>
<span id="cb49-1738"><a href="#cb49-1738" aria-hidden="true" tabindex="-1"></a>df_bat <span class="op">=</span> results_tbl[results_tbl[<span class="st">"Scenario"</span>] <span class="op">==</span> <span class="st">"2_BalancedAggressiveTransition"</span>].copy()</span>
<span id="cb49-1739"><a href="#cb49-1739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1740"><a href="#cb49-1740" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Compute the % change vs 10,919 GWh. Source: Open Electricity Data (note this will change regularly because it is a rolling 12-month period)</span></span>
<span id="cb49-1741"><a href="#cb49-1741" aria-hidden="true" tabindex="-1"></a>base <span class="op">=</span> <span class="dv">10919</span></span>
<span id="cb49-1742"><a href="#cb49-1742" aria-hidden="true" tabindex="-1"></a>df_bat[<span class="st">"Gas Δ% vs 10919GWh"</span>] <span class="op">=</span> (df_bat[<span class="st">"Gas Generation (GWh)"</span>] <span class="op">-</span> base) <span class="op">/</span> base <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb49-1743"><a href="#cb49-1743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1744"><a href="#cb49-1744" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Insert the new column right after “Gas Generation (GWh)”</span></span>
<span id="cb49-1745"><a href="#cb49-1745" aria-hidden="true" tabindex="-1"></a>col_idx <span class="op">=</span> df_bat.columns.get_loc(<span class="st">"Gas Generation (GWh)"</span>)</span>
<span id="cb49-1746"><a href="#cb49-1746" aria-hidden="true" tabindex="-1"></a>df_bat.insert(col_idx<span class="op">+</span><span class="dv">1</span>, <span class="st">"Gas Δ% vs 10919GWh"</span>, df_bat.pop(<span class="st">"Gas Δ% vs 10919GWh"</span>))</span>
<span id="cb49-1747"><a href="#cb49-1747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1748"><a href="#cb49-1748" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect</span></span>
<span id="cb49-1749"><a href="#cb49-1749" aria-hidden="true" tabindex="-1"></a>html_bat_table <span class="op">=</span> df_bat.iloc[:, :<span class="dv">5</span>].to_html(escape<span class="op">=</span><span class="va">False</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb49-1750"><a href="#cb49-1750" aria-hidden="true" tabindex="-1"></a>html_bat_table <span class="op">=</span> html_bat_table.replace(<span class="st">'&lt;table'</span>, </span>
<span id="cb49-1751"><a href="#cb49-1751" aria-hidden="true" tabindex="-1"></a>    <span class="st">'&lt;table style="width: 100%; table-layout: fixed; font-size: 11px; font-family: monospace;"'</span>)</span>
<span id="cb49-1752"><a href="#cb49-1752" aria-hidden="true" tabindex="-1"></a>html_bat_table <span class="op">=</span> html_bat_table.replace(<span class="st">'&lt;td'</span>, </span>
<span id="cb49-1753"><a href="#cb49-1753" aria-hidden="true" tabindex="-1"></a>    <span class="st">'&lt;td style="min-width: 250px; word-wrap: break-word; padding: 4px;"'</span>)</span>
<span id="cb49-1754"><a href="#cb49-1754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1755"><a href="#cb49-1755" aria-hidden="true" tabindex="-1"></a>html_bat_table</span>
<span id="cb49-1756"><a href="#cb49-1756" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1757"><a href="#cb49-1757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1758"><a href="#cb49-1758" aria-hidden="true" tabindex="-1"></a>Load the <span class="in">`2_BalancedAggressiveTransition`</span> network. This scenario has a 75% reduction in coal and a limited increase in renewables and storage.</span>
<span id="cb49-1759"><a href="#cb49-1759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1762"><a href="#cb49-1762" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-1763"><a href="#cb49-1763" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the network for the specific scenario</span></span>
<span id="cb49-1764"><a href="#cb49-1764" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> pypsa.Network(<span class="st">"results/scenarios/scenario_2_BalancedAggressiveTransition.nc"</span>)</span>
<span id="cb49-1765"><a href="#cb49-1765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1766"><a href="#cb49-1766" aria-hidden="true" tabindex="-1"></a><span class="co"># Metadata to provide as arguments to the plot_dispatch() function.</span></span>
<span id="cb49-1767"><a href="#cb49-1767" aria-hidden="true" tabindex="-1"></a>scenario <span class="op">=</span> <span class="st">"2_BalancedAggressiveTransition"</span></span>
<span id="cb49-1768"><a href="#cb49-1768" aria-hidden="true" tabindex="-1"></a>objective_text <span class="op">=</span> df_results.loc[df_results[<span class="st">"Scenario"</span>] <span class="op">==</span> scenario, <span class="st">"Objective"</span>].values[<span class="dv">0</span>]</span>
<span id="cb49-1769"><a href="#cb49-1769" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1770"><a href="#cb49-1770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1771"><a href="#cb49-1771" aria-hidden="true" tabindex="-1"></a>Review a previous dispatch period over 10 days in Victoria.</span>
<span id="cb49-1772"><a href="#cb49-1772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1775"><a href="#cb49-1775" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-1776"><a href="#cb49-1776" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb49-1777"><a href="#cb49-1777" aria-hidden="true" tabindex="-1"></a>plot_dispatch(n, time<span class="op">=</span><span class="st">"2024-05-18"</span>, days<span class="op">=</span><span class="dv">10</span>, regions<span class="op">=</span>[<span class="st">"VIC1"</span>], show_imports<span class="op">=</span><span class="va">True</span>, scenario_name<span class="op">=</span>scenario, scenario_objective<span class="op">=</span>objective_text)</span>
<span id="cb49-1778"><a href="#cb49-1778" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1779"><a href="#cb49-1779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1780"><a href="#cb49-1780" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Generate Scenarios Function</span></span>
<span id="cb49-1781"><a href="#cb49-1781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1782"><a href="#cb49-1782" aria-hidden="true" tabindex="-1"></a>Below is the function for generating scenarios from a CSV file.</span>
<span id="cb49-1783"><a href="#cb49-1783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1784"><a href="#cb49-1784" aria-hidden="true" tabindex="-1"></a>Ensure any amendments are updated in the the input assumptions file and stored in <span class="in">`data/inputs/tech_assumptions.csv`</span> before execution.</span>
<span id="cb49-1785"><a href="#cb49-1785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1788"><a href="#cb49-1788" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-1789"><a href="#cb49-1789" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb49-1790"><a href="#cb49-1790" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb49-1791"><a href="#cb49-1791" aria-hidden="true" tabindex="-1"></a><span class="co"># Script to generate a simplified sensitivity analysis template</span></span>
<span id="cb49-1792"><a href="#cb49-1792" aria-hidden="true" tabindex="-1"></a><span class="co"># that can be plugged into a PyPSA workflow.</span></span>
<span id="cb49-1793"><a href="#cb49-1793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1794"><a href="#cb49-1794" aria-hidden="true" tabindex="-1"></a><span class="co">###--- GENERATE SCENARIOS ---####</span></span>
<span id="cb49-1795"><a href="#cb49-1795" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb49-1796"><a href="#cb49-1796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1797"><a href="#cb49-1797" aria-hidden="true" tabindex="-1"></a><span class="co"># Intergrate csv input assumptions for tech - this better documents scenarios</span></span>
<span id="cb49-1798"><a href="#cb49-1798" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dict_to_multiline_string(d):</span>
<span id="cb49-1799"><a href="#cb49-1799" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(<span class="ss">f"</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>v<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> k, v <span class="kw">in</span> d.items()) <span class="cf">if</span> d <span class="cf">else</span> <span class="st">""</span></span>
<span id="cb49-1800"><a href="#cb49-1800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1801"><a href="#cb49-1801" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_scenarios(</span>
<span id="cb49-1802"><a href="#cb49-1802" aria-hidden="true" tabindex="-1"></a>        network,</span>
<span id="cb49-1803"><a href="#cb49-1803" aria-hidden="true" tabindex="-1"></a>        tech_assumptions_path,</span>
<span id="cb49-1804"><a href="#cb49-1804" aria-hidden="true" tabindex="-1"></a>        export_dir<span class="op">=</span><span class="st">"results/scenarios"</span></span>
<span id="cb49-1805"><a href="#cb49-1805" aria-hidden="true" tabindex="-1"></a>    ):</span>
<span id="cb49-1806"><a href="#cb49-1806" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb49-1807"><a href="#cb49-1807" aria-hidden="true" tabindex="-1"></a><span class="co">    Apply scaling from a technology-assumptions CSV, solve each scenario, export</span></span>
<span id="cb49-1808"><a href="#cb49-1808" aria-hidden="true" tabindex="-1"></a><span class="co">    the solved network, and return a summary DataFrame.</span></span>
<span id="cb49-1809"><a href="#cb49-1809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1810"><a href="#cb49-1810" aria-hidden="true" tabindex="-1"></a><span class="co">    Extra metrics collected:</span></span>
<span id="cb49-1811"><a href="#cb49-1811" aria-hidden="true" tabindex="-1"></a><span class="co">    • **Unserved Energy (GWh)** - total unserved energy across the system.</span></span>
<span id="cb49-1812"><a href="#cb49-1812" aria-hidden="true" tabindex="-1"></a><span class="co">    • **Generator Capacity (GW)** - total generator capacity by carrier.</span></span>
<span id="cb49-1813"><a href="#cb49-1813" aria-hidden="true" tabindex="-1"></a><span class="co">      (built-in `n.generators.p_nom`)</span></span>
<span id="cb49-1814"><a href="#cb49-1814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1815"><a href="#cb49-1815" aria-hidden="true" tabindex="-1"></a><span class="co">    • **Gas Generation (GWh)** - total dispatched energy from carrier 'Gas'.</span></span>
<span id="cb49-1816"><a href="#cb49-1816" aria-hidden="true" tabindex="-1"></a><span class="co">    • **Wind and Solar Curtailment (GWh)** - renewable curtailment across the whole</span></span>
<span id="cb49-1817"><a href="#cb49-1817" aria-hidden="true" tabindex="-1"></a><span class="co">      system (built-in `n.statistics.curtailment`).</span></span>
<span id="cb49-1818"><a href="#cb49-1818" aria-hidden="true" tabindex="-1"></a><span class="co">    • **Battery Capacity (GW)** - total battery storage capacity in the system.</span></span>
<span id="cb49-1819"><a href="#cb49-1819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1820"><a href="#cb49-1820" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb49-1821"><a href="#cb49-1821" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb49-1822"><a href="#cb49-1822" aria-hidden="true" tabindex="-1"></a><span class="co">    network : pypsa.Network</span></span>
<span id="cb49-1823"><a href="#cb49-1823" aria-hidden="true" tabindex="-1"></a><span class="co">        The base PyPSA network object to scale up/down.</span></span>
<span id="cb49-1824"><a href="#cb49-1824" aria-hidden="true" tabindex="-1"></a><span class="co">    tech_assumptions_path : str</span></span>
<span id="cb49-1825"><a href="#cb49-1825" aria-hidden="true" tabindex="-1"></a><span class="co">        Path to CSV file with scaling assumptions for generators/storage.</span></span>
<span id="cb49-1826"><a href="#cb49-1826" aria-hidden="true" tabindex="-1"></a><span class="co">    export_dir : str, default "results/scenarios"</span></span>
<span id="cb49-1827"><a href="#cb49-1827" aria-hidden="true" tabindex="-1"></a><span class="co">        Directory path to export .nc and CSV results.</span></span>
<span id="cb49-1828"><a href="#cb49-1828" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb49-1829"><a href="#cb49-1829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1830"><a href="#cb49-1830" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb49-1831"><a href="#cb49-1831" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb49-1832"><a href="#cb49-1832" aria-hidden="true" tabindex="-1"></a><span class="co">    pandas.DataFrame</span></span>
<span id="cb49-1833"><a href="#cb49-1833" aria-hidden="true" tabindex="-1"></a><span class="co">        Scenario metrics including battery capacity (GW), generator capacity (GW), curtailment (GWh), unserved energy (GWh) and gas generation (GWh).</span></span>
<span id="cb49-1834"><a href="#cb49-1834" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb49-1835"><a href="#cb49-1835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1836"><a href="#cb49-1836" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-1837"><a href="#cb49-1837" aria-hidden="true" tabindex="-1"></a>    os.makedirs(export_dir, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb49-1838"><a href="#cb49-1838" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb49-1839"><a href="#cb49-1839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1840"><a href="#cb49-1840" aria-hidden="true" tabindex="-1"></a>    tech_df <span class="op">=</span> pd.read_csv(tech_assumptions_path)</span>
<span id="cb49-1841"><a href="#cb49-1841" aria-hidden="true" tabindex="-1"></a>    scenario_names <span class="op">=</span> tech_df[<span class="st">"scenario"</span>].unique()</span>
<span id="cb49-1842"><a href="#cb49-1842" aria-hidden="true" tabindex="-1"></a>    timer_all <span class="op">=</span> perf_counter()</span>
<span id="cb49-1843"><a href="#cb49-1843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1844"><a href="#cb49-1844" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> scenario <span class="kw">in</span> scenario_names:</span>
<span id="cb49-1845"><a href="#cb49-1845" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\u2192</span><span class="ss"> Scenario: </span><span class="sc">{</span>scenario<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb49-1846"><a href="#cb49-1846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1847"><a href="#cb49-1847" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ── copy network ───────────────────────────────────────────────</span></span>
<span id="cb49-1848"><a href="#cb49-1848" aria-hidden="true" tabindex="-1"></a>        n <span class="op">=</span> network.copy(snapshots<span class="op">=</span>network.snapshots)</span>
<span id="cb49-1849"><a href="#cb49-1849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1850"><a href="#cb49-1850" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ── apply scaling from CSV ────────────────────────────────────</span></span>
<span id="cb49-1851"><a href="#cb49-1851" aria-hidden="true" tabindex="-1"></a>        df_s <span class="op">=</span> tech_df[tech_df[<span class="st">"scenario"</span>] <span class="op">==</span> scenario]</span>
<span id="cb49-1852"><a href="#cb49-1852" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _, row <span class="kw">in</span> df_s.iterrows():</span>
<span id="cb49-1853"><a href="#cb49-1853" aria-hidden="true" tabindex="-1"></a>            component, bus, carrier, scale <span class="op">=</span> (</span>
<span id="cb49-1854"><a href="#cb49-1854" aria-hidden="true" tabindex="-1"></a>                row[<span class="st">"component"</span>], row[<span class="st">"bus"</span>], row[<span class="st">"carrier"</span>], row[<span class="st">"scale_factor"</span>]</span>
<span id="cb49-1855"><a href="#cb49-1855" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb49-1856"><a href="#cb49-1856" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> component <span class="op">==</span> <span class="st">"generator"</span>:</span>
<span id="cb49-1857"><a href="#cb49-1857" aria-hidden="true" tabindex="-1"></a>                mask <span class="op">=</span> (n.generators.bus <span class="op">==</span> bus) <span class="op">&amp;</span> (n.generators.carrier <span class="op">==</span> carrier)</span>
<span id="cb49-1858"><a href="#cb49-1858" aria-hidden="true" tabindex="-1"></a>                n.generators.loc[mask, <span class="st">"p_nom"</span>] <span class="op">*=</span> scale</span>
<span id="cb49-1859"><a href="#cb49-1859" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">"p_nom_max"</span> <span class="kw">in</span> n.generators.columns:</span>
<span id="cb49-1860"><a href="#cb49-1860" aria-hidden="true" tabindex="-1"></a>                    n.generators.loc[mask, <span class="st">"p_nom_max"</span>] <span class="op">*=</span> scale</span>
<span id="cb49-1861"><a href="#cb49-1861" aria-hidden="true" tabindex="-1"></a>                n.generators.loc[mask, <span class="st">"p_nom_extendable"</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb49-1862"><a href="#cb49-1862" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> component <span class="op">==</span> <span class="st">"storage_unit"</span>:</span>
<span id="cb49-1863"><a href="#cb49-1863" aria-hidden="true" tabindex="-1"></a>                mask <span class="op">=</span> (n.storage_units.bus <span class="op">==</span> bus) <span class="op">&amp;</span> (n.storage_units.carrier <span class="op">==</span> carrier)</span>
<span id="cb49-1864"><a href="#cb49-1864" aria-hidden="true" tabindex="-1"></a>                n.storage_units.loc[mask, <span class="st">"p_nom"</span>] <span class="op">*=</span> scale</span>
<span id="cb49-1865"><a href="#cb49-1865" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">"p_nom_max"</span> <span class="kw">in</span> n.storage_units.columns:</span>
<span id="cb49-1866"><a href="#cb49-1866" aria-hidden="true" tabindex="-1"></a>                    n.storage_units.loc[mask, <span class="st">"p_nom_max"</span>] <span class="op">*=</span> scale</span>
<span id="cb49-1867"><a href="#cb49-1867" aria-hidden="true" tabindex="-1"></a>                n.storage_units.loc[mask, <span class="st">"p_nom_extendable"</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb49-1868"><a href="#cb49-1868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1869"><a href="#cb49-1869" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ── solve ──────────────────────────────────────────────────────</span></span>
<span id="cb49-1870"><a href="#cb49-1870" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Change to open source solver if required, default is HiGHS</span></span>
<span id="cb49-1871"><a href="#cb49-1871" aria-hidden="true" tabindex="-1"></a>        n.optimize()</span>
<span id="cb49-1872"><a href="#cb49-1872" aria-hidden="true" tabindex="-1"></a>        <span class="co"># n.optimize(solver_name="gurobi")</span></span>
<span id="cb49-1873"><a href="#cb49-1873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1874"><a href="#cb49-1874" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ── unserved energy ───────────────────────────────────────────</span></span>
<span id="cb49-1875"><a href="#cb49-1875" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"Unserved Energy"</span> <span class="kw">in</span> n.generators.carrier.values:</span>
<span id="cb49-1876"><a href="#cb49-1876" aria-hidden="true" tabindex="-1"></a>            ue_cols <span class="op">=</span> n.generators[n.generators.carrier <span class="op">==</span> <span class="st">"Unserved Energy"</span>].index</span>
<span id="cb49-1877"><a href="#cb49-1877" aria-hidden="true" tabindex="-1"></a>            ue_df <span class="op">=</span> n.generators_t.p[ue_cols]</span>
<span id="cb49-1878"><a href="#cb49-1878" aria-hidden="true" tabindex="-1"></a>            ue_GWh <span class="op">=</span> ue_df.<span class="bu">sum</span>().<span class="bu">sum</span>() <span class="op">/</span> <span class="fl">1e3</span></span>
<span id="cb49-1879"><a href="#cb49-1879" aria-hidden="true" tabindex="-1"></a>            ue_by_bus <span class="op">=</span> (</span>
<span id="cb49-1880"><a href="#cb49-1880" aria-hidden="true" tabindex="-1"></a>                ue_df.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb49-1881"><a href="#cb49-1881" aria-hidden="true" tabindex="-1"></a>                .groupby(n.generators.loc[ue_cols, <span class="st">"bus"</span>]).<span class="bu">sum</span>() <span class="op">/</span> <span class="fl">1e3</span></span>
<span id="cb49-1882"><a href="#cb49-1882" aria-hidden="true" tabindex="-1"></a>            ).<span class="bu">round</span>(<span class="dv">3</span>).to_dict()</span>
<span id="cb49-1883"><a href="#cb49-1883" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb49-1884"><a href="#cb49-1884" aria-hidden="true" tabindex="-1"></a>            ue_GWh, ue_by_bus <span class="op">=</span> <span class="fl">0.0</span>, {}</span>
<span id="cb49-1885"><a href="#cb49-1885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1886"><a href="#cb49-1886" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ── gas energy ────────────────────────────────────────────────</span></span>
<span id="cb49-1887"><a href="#cb49-1887" aria-hidden="true" tabindex="-1"></a>        gas_idx <span class="op">=</span> n.generators.index[n.generators.carrier <span class="op">==</span> <span class="st">"Gas"</span>]</span>
<span id="cb49-1888"><a href="#cb49-1888" aria-hidden="true" tabindex="-1"></a>        gas_GWh <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb49-1889"><a href="#cb49-1889" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(gas_idx):</span>
<span id="cb49-1890"><a href="#cb49-1890" aria-hidden="true" tabindex="-1"></a>            gas_GWh <span class="op">=</span> n.generators_t.p[gas_idx].<span class="bu">sum</span>().<span class="bu">sum</span>() <span class="op">/</span> <span class="fl">1e3</span>  <span class="co"># to GWh</span></span>
<span id="cb49-1891"><a href="#cb49-1891" aria-hidden="true" tabindex="-1"></a>        gas_GWh <span class="op">=</span> <span class="bu">round</span>(gas_GWh, <span class="dv">3</span>)</span>
<span id="cb49-1892"><a href="#cb49-1892" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb49-1893"><a href="#cb49-1893" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ── curtailment (built‑in helper) ─────────────────────────</span></span>
<span id="cb49-1894"><a href="#cb49-1894" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">hasattr</span>(n, <span class="st">"statistics"</span>) <span class="kw">and</span> <span class="bu">hasattr</span>(n.statistics, <span class="st">"curtailment"</span>):</span>
<span id="cb49-1895"><a href="#cb49-1895" aria-hidden="true" tabindex="-1"></a>            curtailment_df <span class="op">=</span> n.statistics.curtailment()</span>
<span id="cb49-1896"><a href="#cb49-1896" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb49-1897"><a href="#cb49-1897" aria-hidden="true" tabindex="-1"></a>            existing_carriers <span class="op">=</span> curtailment_df.index.get_level_values(<span class="dv">1</span>).unique()</span>
<span id="cb49-1898"><a href="#cb49-1898" aria-hidden="true" tabindex="-1"></a>            wanted_carriers <span class="op">=</span> [<span class="st">'Wind'</span>, <span class="st">'Solar'</span>, <span class="st">'Rooftop Solar'</span>]</span>
<span id="cb49-1899"><a href="#cb49-1899" aria-hidden="true" tabindex="-1"></a>            valid_carriers <span class="op">=</span> [c <span class="cf">for</span> c <span class="kw">in</span> wanted_carriers <span class="cf">if</span> c <span class="kw">in</span> existing_carriers]</span>
<span id="cb49-1900"><a href="#cb49-1900" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid_carriers:</span>
<span id="cb49-1901"><a href="#cb49-1901" aria-hidden="true" tabindex="-1"></a>                vre_curt_GWh <span class="op">=</span> curtailment_df.loc[(<span class="bu">slice</span>(<span class="va">None</span>), valid_carriers)].<span class="bu">sum</span>() <span class="op">/</span> <span class="fl">1e3</span></span>
<span id="cb49-1902"><a href="#cb49-1902" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb49-1903"><a href="#cb49-1903" aria-hidden="true" tabindex="-1"></a>                vre_curt_GWh <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb49-1904"><a href="#cb49-1904" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb49-1905"><a href="#cb49-1905" aria-hidden="true" tabindex="-1"></a>            vre_curt_GWh <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb49-1906"><a href="#cb49-1906" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb49-1907"><a href="#cb49-1907" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ── Battery Capacity ─────────────────────────</span></span>
<span id="cb49-1908"><a href="#cb49-1908" aria-hidden="true" tabindex="-1"></a>        battery_carrier <span class="op">=</span> <span class="st">"Battery"</span>  <span class="co"># adjust as needed</span></span>
<span id="cb49-1909"><a href="#cb49-1909" aria-hidden="true" tabindex="-1"></a>        battery_mask <span class="op">=</span> n.storage_units.carrier <span class="op">==</span> battery_carrier</span>
<span id="cb49-1910"><a href="#cb49-1910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1911"><a href="#cb49-1911" aria-hidden="true" tabindex="-1"></a>        battery_capacity_GW <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb49-1912"><a href="#cb49-1912" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> battery_mask.<span class="bu">any</span>():</span>
<span id="cb49-1913"><a href="#cb49-1913" aria-hidden="true" tabindex="-1"></a>            battery_capacity_GW <span class="op">=</span> n.storage_units.loc[battery_mask, <span class="st">"p_nom"</span>].<span class="bu">sum</span>() <span class="op">/</span> <span class="fl">1e3</span>  <span class="co"># MW to GW</span></span>
<span id="cb49-1914"><a href="#cb49-1914" aria-hidden="true" tabindex="-1"></a>            battery_capacity_GW <span class="op">=</span> <span class="bu">round</span>(battery_capacity_GW, <span class="dv">3</span>)</span>
<span id="cb49-1915"><a href="#cb49-1915" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb49-1916"><a href="#cb49-1916" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ── Generator capacity by carrier ─────────────────────────</span></span>
<span id="cb49-1917"><a href="#cb49-1917" aria-hidden="true" tabindex="-1"></a>        capacity_by_carrier <span class="op">=</span> (</span>
<span id="cb49-1918"><a href="#cb49-1918" aria-hidden="true" tabindex="-1"></a>            n.generators[n.generators.carrier <span class="op">!=</span> <span class="st">'Unserved Energy'</span>]</span>
<span id="cb49-1919"><a href="#cb49-1919" aria-hidden="true" tabindex="-1"></a>            .groupby(<span class="st">"carrier"</span>)[<span class="st">"p_nom"</span>]</span>
<span id="cb49-1920"><a href="#cb49-1920" aria-hidden="true" tabindex="-1"></a>            .<span class="bu">sum</span>()</span>
<span id="cb49-1921"><a href="#cb49-1921" aria-hidden="true" tabindex="-1"></a>            .<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb49-1922"><a href="#cb49-1922" aria-hidden="true" tabindex="-1"></a>            .to_dict()</span>
<span id="cb49-1923"><a href="#cb49-1923" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb49-1924"><a href="#cb49-1924" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb49-1925"><a href="#cb49-1925" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ── collect metrics ───────────────────────────────────────────</span></span>
<span id="cb49-1926"><a href="#cb49-1926" aria-hidden="true" tabindex="-1"></a>        results.append({</span>
<span id="cb49-1927"><a href="#cb49-1927" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Scenario"</span>: scenario,</span>
<span id="cb49-1928"><a href="#cb49-1928" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Objective"</span>: <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(</span>
<span id="cb49-1929"><a href="#cb49-1929" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f"</span><span class="sc">{</span>r[<span class="st">'bus'</span>]<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>r[<span class="st">'carrier'</span>]<span class="sc">}</span><span class="ss">: x</span><span class="sc">{</span>r[<span class="st">'scale_factor'</span>]<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> _, r <span class="kw">in</span> df_s.iterrows()</span>
<span id="cb49-1930"><a href="#cb49-1930" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb49-1931"><a href="#cb49-1931" aria-hidden="true" tabindex="-1"></a>            <span class="co"># "Total System Cost (B$)": round(n.objective / 1e9, 3),</span></span>
<span id="cb49-1932"><a href="#cb49-1932" aria-hidden="true" tabindex="-1"></a>            <span class="co"># "Total New Capacity (GW)": round(n.generators.p_nom_opt.sum() / 1e3, 3),</span></span>
<span id="cb49-1933"><a href="#cb49-1933" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Gas Generation (GWh)"</span>: gas_GWh,</span>
<span id="cb49-1934"><a href="#cb49-1934" aria-hidden="true" tabindex="-1"></a>            <span class="co"># "Total Curtailment (GWh)": round(curt_GWh, 3),</span></span>
<span id="cb49-1935"><a href="#cb49-1935" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Battery Capacity (GW)"</span>: battery_capacity_GW,</span>
<span id="cb49-1936"><a href="#cb49-1936" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Generator Capacity (GW)"</span>: dict_to_multiline_string(capacity_by_carrier),</span>
<span id="cb49-1937"><a href="#cb49-1937" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Wind &amp; Solar Curtailment (GWh)"</span>: <span class="bu">round</span>(vre_curt_GWh, <span class="dv">3</span>),</span>
<span id="cb49-1938"><a href="#cb49-1938" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Unserved Energy (GWh)"</span>: <span class="bu">round</span>(ue_GWh, <span class="dv">3</span>),</span>
<span id="cb49-1939"><a href="#cb49-1939" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Unserved by Region (GWh)"</span>: dict_to_multiline_string(ue_by_bus)</span>
<span id="cb49-1940"><a href="#cb49-1940" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb49-1941"><a href="#cb49-1941" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb49-1942"><a href="#cb49-1942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1943"><a href="#cb49-1943" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ── export solved network ─────────────────────────────────────</span></span>
<span id="cb49-1944"><a href="#cb49-1944" aria-hidden="true" tabindex="-1"></a>        n.export_to_netcdf(os.path.join(export_dir, <span class="ss">f"scenario_</span><span class="sc">{</span>scenario<span class="sc">}</span><span class="ss">.nc"</span>))</span>
<span id="cb49-1945"><a href="#cb49-1945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1946"><a href="#cb49-1946" aria-hidden="true" tabindex="-1"></a>    df_results <span class="op">=</span> pd.DataFrame(results)</span>
<span id="cb49-1947"><a href="#cb49-1947" aria-hidden="true" tabindex="-1"></a>    timestamp <span class="op">=</span> datetime.now().strftime(<span class="st">"%Y%m</span><span class="sc">%d</span><span class="st">_%H%M"</span>)</span>
<span id="cb49-1948"><a href="#cb49-1948" aria-hidden="true" tabindex="-1"></a>    df_results.to_csv(os.path.join(export_dir, <span class="ss">f"scenarios_summary_</span><span class="sc">{</span>timestamp<span class="sc">}</span><span class="ss">.csv"</span>), index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb49-1949"><a href="#cb49-1949" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-1950"><a href="#cb49-1950" aria-hidden="true" tabindex="-1"></a>    total_time <span class="op">=</span> <span class="bu">round</span>(perf_counter() <span class="op">-</span> timer_all, <span class="dv">1</span>)</span>
<span id="cb49-1951"><a href="#cb49-1951" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"All scenarios completed in </span><span class="sc">{</span>total_time<span class="sc">}</span><span class="ss"> seconds"</span>)</span>
<span id="cb49-1952"><a href="#cb49-1952" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-1953"><a href="#cb49-1953" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df_results</span>
<span id="cb49-1954"><a href="#cb49-1954" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-1955"><a href="#cb49-1955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1956"><a href="#cb49-1956" aria-hidden="true" tabindex="-1"></a>Run the above function and assign results to <span class="in">`df_results`</span> for further analysis.</span>
<span id="cb49-1957"><a href="#cb49-1957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1960"><a href="#cb49-1960" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb49-1961"><a href="#cb49-1961" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb49-1962"><a href="#cb49-1962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1963"><a href="#cb49-1963" aria-hidden="true" tabindex="-1"></a><span class="co"># Important: initialise baseline network first to avoid scaling up unwanted network (n)</span></span>
<span id="cb49-1964"><a href="#cb49-1964" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> pypsa.Network(<span class="st">"results/high-level_nem.nc"</span>)</span>
<span id="cb49-1965"><a href="#cb49-1965" aria-hidden="true" tabindex="-1"></a>df_results <span class="op">=</span> generate_scenarios(n, tech_assumptions_path<span class="op">=</span><span class="st">"data/inputs/tech_assumptions.csv"</span>)</span>
<span id="cb49-1966"><a href="#cb49-1966" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>